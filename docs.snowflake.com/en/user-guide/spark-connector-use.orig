<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Using the Spark Connector | Snowflake Documentation</title><link rel="canonical" href="https://docs.snowflake.com/en/user-guide/spark-connector-use"/><meta name="next-head-count" content="4"/><script src="/scripts/darkmode.js"></script><link rel="shortcut icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyBmaWxsPSJub25lIiBoZWlnaHQ9IjE1MCIgdmlld0JveD0iMCAwIDE1MCAxNTAiIHdpZHRoPSIxNTAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxjbGlwUGF0aCBpZD0iYSI+PHBhdGggZD0ibTAgMGgxNTB2MTUwaC0xNTB6Ii8+PC9jbGlwUGF0aD48ZyBjbGlwLXBhdGg9InVybCgjYSkiPjxwYXRoIGQ9Im0xNTAgMGgtMTUwdjE1MGgxNTB6IiBmaWxsPSIjMjliNWU4Ii8+PHBhdGggY2xpcC1ydWxlPSJldmVub2RkIiBkPSJtMTMwLjM3NSA2Ny4yNTMyLTE0LjA5NiA4LjEyMjEgMTQuMDk2IDguMDUzNmMuODQzLjQ4NzIgMS41ODEgMS4xMzU3IDIuMTc0IDEuOTA4NC41OTIuNzcyNyAxLjAyNiAxLjY1NDUgMS4yNzggMi41OTUxLjI1MS45NDA2LjMxNSAxLjkyMTUuMTg4IDIuODg2Ny0uMTI4Ljk2NTItLjQ0NCAxLjg5NTktLjkzMSAyLjczODgtLjQ4OC44NDMtMS4xMzYgMS41ODE3LTEuOTA5IDIuMTc0cy0xLjY1NCAxLjAyNjctMi41OTUgMS4yNzgyLTEuOTIxLjMxNTQtMi44ODcuMTg3OGMtLjk2NS0uMTI3NS0xLjg5Ni0uNDQ0LTIuNzM5LS45MzEybC0yNS4yNTU5LTE0LjU0OTZjLTEuMTU3NS0uNjY5Ni0yLjExMjgtMS42Mzk0LTIuNzY1LTIuODA2OC0uNjUyMy0xLjE2NzQtLjk3NzMtMi40ODkzLS45NDA4LTMuODI2LjAxOTgtLjU3OTIuMTA4OS0xLjE1MzguMjY1My0xLjcxMTcuNTE3LTEuODcxMSAxLjc0NTgtMy40NjU0IDMuNDIzNC00LjQ0MTlsMjUuMjU2LTE0LjQ5ODNjLjg0Ny0uNDg5MiAxLjc4Mi0uODA2NyAyLjc1MS0uOTM0My45Ny0uMTI3NSAxLjk1NS0uMDYyNyAyLjg5OS4xOTA5Ljk0NS4yNTM2IDEuODMuNjkwOSAyLjYwNSAxLjI4Ny43NzUuNTk2IDEuNDI1IDEuMzM5MSAxLjkxMyAyLjE4NjYuNDkuODQwMi44MDggMS43NjkzLjkzNSAyLjczMzQuMTI4Ljk2NC4wNjMgMS45NDM5LS4xOTEgMi44ODI2LS4yNTQuOTM4OC0uNjkyIDEuODE3Ny0xLjI4OCAyLjU4NTktLjU5Ny43NjgxLTEuMzQgMS40MTAxLTIuMTg2IDEuODg4N3ptLTEzLjM0MyAzOS4zNjk4LTI1LjI0NzgtMTQuNTI0M2MtMS4xMjk2LS42NDgzLTIuNDA5MS0uOTg5Ni0zLjcxMTUtLjk5MDJzLTIuNTgyMy4zMzk3LTMuNzEyNC45ODdjLTEuMTMwMS42NDcyLTIuMDcxMiAxLjU3OS0yLjcyOTcgMi43MDI2LS42NTg1IDEuMTIzNy0xLjAxMTUgMi40MDAxLTEuMDIzOSAzLjcwMjR2MjkuMDEzNWMuMDY1NCAxLjkyOC44NzcyIDMuNzU1IDIuMjY0IDUuMDk1IDEuMzg2OSAxLjM0MSAzLjI0MDMgMi4wOSA1LjE2OTEgMi4wOSAxLjkyODkgMCAzLjc4MjMtLjc0OSA1LjE2OTEtMi4wOSAxLjM4NjgtMS4zNCAyLjE5ODYtMy4xNjcgMi4yNjQtNS4wOTV2LTE2LjI2MWwxNC4xMzAxIDguMTIyYy44NDMuNDg4IDEuNzc0LjgwNSAyLjczOS45MzMuOTY2LjEyOCAxLjk0Ny4wNjQgMi44ODgtLjE4N3MxLjgyMy0uNjg1IDIuNTk2LTEuMjc3Yy43NzQtLjU5MiAxLjQyMy0xLjMzMSAxLjkxLTIuMTc0LjQ4OC0uODQzLjgwNS0xLjc3My45MzMtMi43MzkuMTI4LS45NjUuMDY1LTEuOTQ2LS4xODYtMi44ODdzLS42ODUtMS44MjQtMS4yNzctMi41OTctMS4zMzEtMS40MjItMi4xNzQtMS45MXptLTI5LjA5OTItMjguMzgwNi0xMC41MjcgMTAuMzk4NmMtLjM2MDEuMzM0OS0uODI2OS41MzE5LTEuMzE4LjU1NjNoLTMuMDg5N2MtLjQ5LS4wMjk0LS45NTUxLS4yMjU3LTEuMzE4LS41NTYzbC0xMC40NjcxLTEwLjQzMjljLS4zMjc0LS4zNTczLS41MjEtLjgxNy0uNTQ3OC0xLjMwMDl2LTMuMDgxYy4wMjgzLS40ODYxLjIyMTUtLjk0ODEuNTQ3OC0xLjMwOTVsMTAuNDY3MS0xMC40MzI5Yy4zNjM3LS4zMjgxLjgyOS0uNTIxNCAxLjMxOC0uNTQ3N2gzLjA4OTdjLjQ4OTkuMDIyOC45NTYyLjIxNjYgMS4zMTguNTQ3N2wxMC40OTI4IDEwLjQzMjljLjMyMzcuMzYyMy41MTQuODI0My41MzkyIDEuMzA5NXYzLjA4MWMtLjAyMzcuNDgzLS4yMTQzLjk0MjgtLjUzOTIgMS4zMDA5em0tOC4zODc0LTIuODkyOGMtLjA0MDQtLjQ5OS0uMjQ4NS0uOTY5Ni0uNTkwNS0xLjMzNTJsLTMuMDM4My0zLjAwNGMtLjM2NDEtLjMyNzUtLjgyOTEtLjUyMDctMS4zMTgtLjU0NzhoLS4xMTEzYy0uNDg2Ny4wMjU1LS45NDk1LjIxOTEtMS4zMDk0LjU0NzhsLTMuMDM4MyAzLjAwNGMtLjMyNjIuMzY3Ni0uNTE2NS44MzU4LS41MzkyIDEuMzI2NnYuMTExM2MuMDIxNS40ODM0LjIxMjQuOTQzOS41MzkyIDEuMzAwOWwzLjA1NTQgMi45OTU1Yy4zNjA3LjMyNzQuODIzLjUyMDggMS4zMDk0LjU0NzdoLjExMTNjLjQ4ODktLjAyNy45NTM5LS4yMjAzIDEuMzE4LS41NDc3bDMuMDM4My0zLjAyMTJjLjMyODItLjM1NzYuNTI0NC0uODE2Ni41NTYzLTEuMzAwOXptLTQ3LjQ5MTQtMzEuMjIxNyAyNS4yNTYzIDE0LjQ4MTFjMS4xMzA4LjY0OCAyLjQxMTUuOTg5IDMuNzE0OS45ODg5IDEuMzAzMyAwIDIuNTg0LS4zNDA5IDMuNzE0OC0uOTg5IDEuMTMwOS0uNjQ4IDIuMDcyNS0xLjU4MDYgMi43MzE0LTIuNzA1MS42NTktMS4xMjQ1IDEuMDEyMy0yLjQwMTggMS4wMjQ5LTMuNzA1MXYtMjguOTg3OWMtLjA2NTQtMS45Mjc3LS44NzcyLTMuNzU0Ni0yLjI2NC01LjA5NTJzLTMuMjQwMi0yLjA4OTktNS4xNjkxLTIuMDg5OWMtMS45Mjg4IDAtMy43ODIyLjc0OTMtNS4xNjkgMi4wODk5LTEuMzg2OSAxLjM0MDYtMi4xOTg3IDMuMTY3NS0yLjI2NDEgNS4wOTUydjE2LjI2MTNsLTE0LjE0NzMtOC4xMzA3Yy0uODQyOS0uNDg3Ny0xLjc3MzctLjgwNDctMi43MzkyLS45MzI4LS45NjU0LS4xMjgxLTEuOTQ2Ni0uMDY0Ny0yLjg4NzYuMTg2NHMtMS44MjMyLjY4NTItMi41OTY1IDEuMjc3M2MtLjc3MzIuNTkyMS0xLjQyMjIgMS4zMzA3LTEuOTEgMi4xNzM2LS40ODc4Ljg0My0uODA0OCAxLjc3MzgtLjkzMjkgMi43MzkyLS4xMjguOTY1NS0uMDY0NyAxLjk0NjcuMTg2NCAyLjg4NzYuMjUxMi45NDEuNjg1MiAxLjgyMzMgMS4yNzczIDIuNTk2NS41OTIxLjc3MzMgMS4zMzA3IDEuNDIyMyAyLjE3MzcgMS45MTAxem01NS40MjUyIDE1LjQ3MzljMS40OTE0LjExOCAyLjk4MzYtLjIxOTMgNC4yNzkzLS45NjcxbDI1LjI0NzUtMTQuNTQ5NmMuODQzLS40ODc3IDEuNTgyLTEuMTM2OCAyLjE3NC0xLjkxczEuMDI2LTEuNjU1NSAxLjI3Ny0yLjU5NjUuMzE1LTEuOTIyMi4xODctMi44ODc2Yy0uMTI4LS45NjU1LS40NDUtMS44OTYyLS45MzMtMi43MzkyLS40ODgtLjg0MjktMS4xMzctMS41ODE2LTEuOTEtMi4xNzM3LS43NzQtLjU5MjEtMS42NTYtMS4wMjYxLTIuNTk3LTEuMjc3Mi0xLjktLjUwNzItMy45MjQtLjIzODctNS42MjcuNzQ2NGwtMTQuMTI5OCA4LjE5OTF2LTE2LjI2MTNjLS4wNjU0LTEuOTI3Ny0uODc3Mi0zLjc1NDYtMi4yNjQtNS4wOTUyLTEuMzg2OC0xLjM0MDUtMy4yNDAyLTIuMDg5OS01LjE2OTEtMi4wODk5LTEuOTI4OCAwLTMuNzgyMi43NDk0LTUuMTY5IDIuMDg5OS0xLjM4NjkgMS4zNDA2LTIuMTk4NyAzLjE2NzUtMi4yNjQxIDUuMDk1MnYyOS4wMTM2Yy0uMDAyMyAxLjg3ODQuNzA4NiAzLjY4NzYgMS45ODkyIDUuMDYxOSAxLjI4MDUgMS4zNzQzIDMuMDM1MSAyLjIxMTEgNC45MDkgMi4zNDEyem0tMjUuODU1NCAzMS41Mjk4Yy0xLjQ5MTYtLjEyMTMtMi45ODQ3LjIxNjItNC4yNzkzLjk2NzFsLTI1LjI5MDUgMTQuNDg5M2MtMS43MDI0Ljk4NS0yLjk0MzggMi42MDctMy40NTEgNC41MDdzLS4yMzg3IDMuOTI0Ljc0NjUgNS42MjdjLjk4NTEgMS43MDIgMi42MDYxIDIuOTQzIDQuNTA2NSAzLjQ1MSAxLjkwMDQuNTA3IDMuOTI0NC4yMzggNS42MjY4LS43NDdsMTQuMTQ3My04LjEyMnYxNi4yNjFjLjA2NTQgMS45MjguODc3MiAzLjc1NSAyLjI2NDEgNS4wOTYgMS4zODY4IDEuMzQgMy4yNDAyIDIuMDkgNS4xNjkgMi4wOSAxLjkyODkgMCAzLjc4MjMtLjc1IDUuMTY5MS0yLjA5IDEuMzg2OC0xLjM0MSAyLjE5ODYtMy4xNjggMi4yNjQtNS4wOTZ2LTI5LjA2NDVjLS4wMDM4LTEuODY5LS43MTQ0LTMuNjY3My0xLjk4OTEtNS4wMzQxcy0zLjAxOTItMi4yMDA5LTQuODgzNC0yLjMzNDh6bS02Ljg0NjgtMTMuNTgyNWMuNDg3NS0xLjYwMzIuNDE0LTMuMzI0Ny0uMjA4My00Ljg4MDYtLjYyMjQtMS41NTU5LTEuNzU2NC0yLjg1MzItMy4yMTUyLTMuNjc3OWwtMjUuMjMwNi0xNC41NDFjLTEuNzA0LS45NzYtMy43MjQ4LTEuMjM4NS01LjYyMTYtLjczMDMtMS44OTY4LjUwODMtMy41MTU1IDEuNzQ2MS00LjUwMzIgMy40NDMzLS40ODg5Ljg0LS44MDY1IDEuNzY4Ni0uOTM0MyAyLjczMi0uMTI3OC45NjM1LS4wNjMyIDEuOTQyOC4xODk5IDIuODgxMS4yNTMxLjkzODQuNjg5NyAxLjgxNzMgMS4yODQ2IDIuNTg1OC41OTUuNzY4NiAxLjMzNjQgMS40MTE1IDIuMTgxNCAxLjg5MTdsMTQuMDk2IDguMTIyMS0xNC4wOTYgOC4wNTM2Yy0uODQyOS40ODYxLTEuNTgxOSAxLjEzMzQtMi4xNzQ2IDEuOTA1MS0uNTkyOC43NzE3LTEuMDI3NyAxLjY1MjYtMS4yODAxIDIuNTkyMy0uMjUyMy45Mzk4LS4zMTcgMS45MjAxLS4xOTA1IDIuODg0OXMuNDQxOCAxLjg5NTIuOTI3OSAyLjczODJjLjQ4NjEuODQyOSAxLjEzMzUgMS41ODE5IDEuOTA1MSAyLjE3NDYuNzcxNy41OTI4IDEuNjUyNiAxLjAyNzcgMi41OTI0IDEuMjgwMS45Mzk3LjI1MjMgMS45Mi4zMTcgMi44ODQ4LjE5MDVzMS44OTUyLS40NDE4IDIuNzM4Mi0uOTI3OWwyNS4yMzA2LTE0LjU0OTZjMS42MjQ4LS45MDcxIDIuODQ1MS0yLjM5NjUgMy40MTQ5LTQuMTY4eiIgZmlsbD0iI2ZmZiIgZmlsbC1ydWxlPSJldmVub2RkIi8+PC9nPjwvc3ZnPg=="/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="anonymous"/><link rel="preload" href="https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/1c3ff358e360dad7.css" as="style"/><link rel="stylesheet" href="/_next/static/css/1c3ff358e360dad7.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script defer="" src="/_next/static/chunks/304.8a0d80134255b6de.js"></script><script src="/_next/static/chunks/webpack-48a9d1c9a83eec21.js" defer=""></script><script src="/_next/static/chunks/framework-a87821de553db91d.js" defer=""></script><script src="/_next/static/chunks/main-fd514f7d9ee4d3f2.js" defer=""></script><script src="/_next/static/chunks/pages/_app-103500770c0400fb.js" defer=""></script><script src="/_next/static/chunks/314-3c486869a31a6ad8.js" defer=""></script><script src="/_next/static/chunks/141-52e6bd64aca8e746.js" defer=""></script><script src="/_next/static/chunks/144-6b784825890c7a2f.js" defer=""></script><script src="/_next/static/chunks/pages/%5B...path%5D-9731655fe727f940.js" defer=""></script><script src="/_next/static/ICZ5MtOK9ZoGg60IkLaJy/_buildManifest.js" defer=""></script><script src="/_next/static/ICZ5MtOK9ZoGg60IkLaJy/_ssgManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap&subset=latin">@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuGKYMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuFuYMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next"><div class="h-full relative overflow-y-hidden flex flex-col"><nav id="masthead" class="print:hidden flex flex-col"><div class="flex items-center justify-between w-full px-6 border-b py-2"><a href="https://docs.snowflake.com" class="flex flex-1 my-2 items-center "><svg xmlns="http://www.w3.org/2000/svg" width="102" height="24" viewBox="0 0 102 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M62.6792 7.50872L62.6761 7.50679C62.6761 7.50679 62.6747 7.50562 62.6729 7.50562C62.6038 7.47437 62.5284 7.45813 62.4562 7.45813C62.3386 7.45898 62.2259 7.49541 62.1277 7.55931C62.0276 7.62524 61.9428 7.72138 61.8943 7.84166V7.84463L59.6011 14.3663L57.8338 9.99498L57.8311 9.9931C57.7813 9.87089 57.6924 9.77644 57.5915 9.7107C57.4896 9.64477 57.372 9.60849 57.2482 9.60849C57.1279 9.60849 57.0157 9.64769 56.917 9.71155C56.8191 9.77733 56.7312 9.87089 56.6818 9.9931L56.6805 9.99498L54.9096 14.3691L52.6043 7.85032H52.6025C52.5625 7.7243 52.4804 7.62609 52.383 7.56119C52.2843 7.49541 52.1685 7.45898 52.0491 7.45813C51.9728 7.45813 51.8961 7.47437 51.8229 7.50562H51.8198L51.8171 7.50872C51.6021 7.61282 51.4707 7.83597 51.4702 8.07917C51.4702 8.15564 51.4846 8.23178 51.5128 8.30722L54.3477 16.22V16.2227C54.3697 16.2818 54.4011 16.3401 54.4469 16.3974C54.4801 16.4383 54.529 16.4728 54.5793 16.5015C54.5887 16.5108 54.6031 16.5241 54.6251 16.5384C54.6489 16.5538 54.6794 16.5645 54.7103 16.57C54.7611 16.5875 54.8279 16.6128 54.9177 16.6128C55.0326 16.6128 55.1389 16.57 55.2345 16.5061C55.3238 16.4442 55.4037 16.3515 55.4477 16.2314L55.4549 16.2257L57.2482 11.7711L59.0437 16.2075H59.0455C59.0868 16.3258 59.1595 16.4185 59.2439 16.4843C59.3332 16.5538 59.4328 16.5968 59.5387 16.6128H59.6141C59.6854 16.6128 59.7555 16.5987 59.8138 16.5748C59.8753 16.5502 59.9251 16.5175 59.9664 16.4853C60.0629 16.4088 60.1369 16.3039 60.1831 16.1874V16.1848L63.0005 8.30722C63.0284 8.23178 63.0427 8.15654 63.0427 8.08039C63.0418 7.83893 62.9049 7.609 62.6792 7.50872ZM49.7164 12.0261C49.7164 11.0969 49.3731 10.2553 48.8269 9.64769C48.2776 9.03889 47.534 8.66675 46.7262 8.66675C45.9184 8.66675 45.173 9.03889 44.6249 9.64769C44.0776 10.2553 43.7343 11.0969 43.7343 12.0261C43.7343 12.9544 44.0776 13.7881 44.6249 14.3919C45.173 14.9979 45.9184 15.3642 46.7262 15.3642C47.534 15.3642 48.2803 14.9979 48.8269 14.3919C49.3731 13.7881 49.7164 12.9544 49.7164 12.0261ZM49.7007 8.80035C50.4591 9.63611 50.92 10.7829 50.9218 12.0261C50.92 13.2692 50.4591 14.4148 49.7007 15.2507C48.9481 16.0853 47.8971 16.613 46.728 16.613C45.5684 16.613 44.5156 16.0853 43.7602 15.2507C43.0036 14.4148 42.5353 13.2692 42.5353 12.0261C42.5353 10.7829 43.0036 9.63611 43.7602 8.80035C44.5156 7.96646 45.5684 7.43898 46.728 7.43898C47.8971 7.43898 48.9481 7.96646 49.7007 8.80035ZM37.7615 7.45522C36.8213 7.45522 35.9631 7.83597 35.3223 8.44355V8.08039C35.3213 7.91333 35.2617 7.75762 35.1569 7.64317C35.0552 7.53065 34.9044 7.45522 34.7393 7.45522C34.5683 7.45522 34.4142 7.52665 34.3069 7.64213C34.2013 7.75573 34.138 7.91333 34.138 8.08039V16.1771L34.1627 16.2027L34.1637 16.2067C34.1702 16.2334 34.1865 16.2629 34.2039 16.2914C34.2857 16.4412 34.4197 16.5548 34.5858 16.6052L34.6097 16.613H34.7393C34.8257 16.613 34.9127 16.594 34.9954 16.5538C35.0643 16.5195 35.1285 16.4642 35.1799 16.3936L35.1818 16.3945C35.1881 16.3879 35.1901 16.3793 35.1974 16.3727C35.2002 16.3717 35.2029 16.3688 35.2047 16.3658C35.2367 16.323 35.2635 16.2792 35.2801 16.2381C35.2976 16.1894 35.3085 16.1435 35.3168 16.1083L35.3223 16.0853V11.2236C35.3397 10.5282 35.6151 9.89955 36.0568 9.44246C36.4955 8.98571 37.0967 8.70317 37.7615 8.70317C38.4373 8.70317 39.0403 8.98571 39.4773 9.44246C39.9161 9.8978 40.1824 10.5254 40.1824 11.2171V15.9911C40.1824 16.1654 40.2539 16.3268 40.3624 16.4375C40.4734 16.5479 40.6248 16.613 40.7828 16.613C40.9434 16.613 41.0941 16.5479 41.2042 16.4375C41.3162 16.3268 41.3841 16.1654 41.3841 15.9911V11.2171C41.3841 9.15644 39.7646 7.45813 37.7615 7.45522ZM96.9417 11.1406C96.6001 9.701 95.384 8.6754 93.9959 8.67832C92.5729 8.67832 91.3728 9.68204 91.0013 11.1406H96.9417ZM98.257 11.7304V11.7922C98.257 11.965 98.183 12.1205 98.0703 12.2227C97.9581 12.3256 97.8123 12.3791 97.6552 12.381H90.9178C91.0892 14.0894 92.4019 15.351 93.969 15.3642H94.3666C94.8849 15.3661 95.3903 15.18 95.8345 14.8719C96.2797 14.5667 96.6643 14.1402 96.9354 13.6707C96.991 13.5706 97.0714 13.4943 97.1584 13.4475C97.2473 13.397 97.3429 13.374 97.4394 13.374C97.5457 13.374 97.6512 13.4027 97.7441 13.4608L97.7504 13.4637L97.758 13.4694C97.9267 13.5982 98.0326 13.7948 98.0326 14.0106C98.0326 14.1202 98.0048 14.2318 97.9469 14.3328L97.9451 14.3368L97.9433 14.3385C97.5668 14.9608 97.0534 15.5283 96.444 15.9396C95.8336 16.3517 95.1259 16.613 94.3666 16.613H93.9627C92.7802 16.6043 91.7117 16.0853 90.9411 15.2554C90.1728 14.4283 89.6994 13.292 89.6994 12.0434C89.6994 10.7734 90.1769 9.62096 90.9514 8.78708C91.7265 7.95423 92.8031 7.43898 93.9959 7.43898C95.134 7.43898 96.1568 7.90933 96.9143 8.67936C97.6718 9.44919 98.1664 10.5185 98.2548 11.7216L98.257 11.7304ZM70.6211 3.67057C70.4569 3.67057 70.3065 3.74221 70.1984 3.85475C70.0898 3.96643 70.0211 4.12384 70.0211 4.29455V15.9911C70.0211 16.1618 70.0898 16.3182 70.1984 16.429C70.3065 16.5395 70.4569 16.613 70.6211 16.613C70.9618 16.613 71.2373 16.3344 71.2391 15.9911V4.29455C71.2373 3.9502 70.9618 3.67057 70.6211 3.67057ZM31.36 11.8027C30.8751 11.5652 30.3252 11.3897 29.7764 11.2008C29.2714 11.0234 28.759 10.8725 28.3936 10.6742C28.2101 10.572 28.0669 10.4643 27.9742 10.3431C27.8795 10.2221 27.8337 10.0989 27.8309 9.93093C27.8319 9.701 27.8961 9.51597 28.0044 9.35183C28.1687 9.10675 28.4441 8.91583 28.7452 8.79258C29.0427 8.669 29.365 8.61065 29.5954 8.61065C30.2765 8.61169 30.7072 8.84731 31.0378 9.09136C31.201 9.21461 31.3389 9.33941 31.4693 9.44246C31.5362 9.49597 31.5987 9.54463 31.6712 9.58072C31.7399 9.61611 31.8207 9.64477 31.909 9.64477C31.9649 9.64477 32.0211 9.63423 32.0722 9.61145C32.1263 9.58868 32.1734 9.55602 32.2184 9.51597C32.2624 9.47319 32.3001 9.42157 32.3267 9.36425C32.3506 9.30505 32.3615 9.24411 32.3615 9.18406C32.3615 9.07324 32.3275 8.96933 32.2788 8.87183C32.188 8.70025 32.0483 8.53625 31.8704 8.37211C31.606 8.12788 31.2572 7.89503 30.8816 7.71964C30.5051 7.54411 30.1013 7.42468 29.7166 7.42468C28.8251 7.42468 28.0807 7.63456 27.5398 8.02119C27.258 8.22331 27.0102 8.44458 26.8349 8.74995C26.6567 9.05616 26.5575 9.43399 26.5447 9.92524C26.5439 9.94717 26.5439 9.9691 26.5439 9.99103C26.5421 10.4681 26.6897 10.8613 26.922 11.1692C27.2746 11.6331 27.798 11.9106 28.3112 12.1072C28.8235 12.3036 29.3356 12.421 29.6588 12.5336C30.114 12.691 30.5979 12.8617 30.9504 13.0878C31.1259 13.2033 31.2681 13.3274 31.3646 13.4637C31.4583 13.6041 31.5113 13.7489 31.5133 13.9322V13.9457C31.5123 14.2108 31.4372 14.4188 31.3131 14.5971C31.1259 14.8624 30.8147 15.0569 30.484 15.18C30.1546 15.3003 29.8121 15.351 29.5917 15.351C28.8142 15.351 28.2938 15.1562 27.9164 14.9608C27.7272 14.8624 27.5739 14.7651 27.4352 14.6829C27.3664 14.6439 27.3022 14.6076 27.2342 14.579C27.1681 14.5505 27.0975 14.532 27.0177 14.532C26.969 14.532 26.9158 14.5408 26.867 14.5607C26.8175 14.5827 26.7725 14.6133 26.7347 14.6504C26.6825 14.7033 26.6366 14.7621 26.6046 14.8299C26.5733 14.8978 26.5575 14.9692 26.5575 15.0436C26.5575 15.1659 26.6015 15.2775 26.6642 15.3785C26.7623 15.5243 26.9065 15.6552 27.0864 15.7859C27.2717 15.9146 27.4932 16.0417 27.7483 16.1667C28.3139 16.4442 29.0391 16.5892 29.59 16.5987H29.5917C30.4484 16.5987 31.1882 16.3936 31.8116 15.9167V15.9155H31.8124C32.422 15.4386 32.8012 14.7297 32.8012 13.9293C32.8012 13.4895 32.7021 13.1164 32.5287 12.8113C32.267 12.3485 31.8418 12.0434 31.36 11.8027ZM79.6751 12.0261C79.6751 11.0881 79.3345 10.2477 78.7901 9.64115C78.2462 9.03616 77.5004 8.669 76.6841 8.66693C75.874 8.66693 75.1309 9.03616 74.5816 9.64115C74.0363 10.2477 73.6912 11.0881 73.6912 12.0261C73.6912 12.963 74.0363 13.7979 74.5816 14.3996C75.1277 15.0017 75.874 15.3642 76.6841 15.3642C77.5022 15.3642 78.2485 15.0017 78.7919 14.4017C79.3345 13.7979 79.6751 12.9639 79.6751 12.0261ZM80.6961 7.61282C80.8069 7.7243 80.8756 7.88571 80.8756 8.06002V15.9911C80.8756 16.1618 80.8056 16.3182 80.6997 16.429C80.5911 16.5395 80.4416 16.613 80.2765 16.613C80.1113 16.613 79.9597 16.5395 79.8533 16.429C79.7447 16.3182 79.6751 16.1618 79.6751 15.9911V15.2173C78.9194 16.0655 77.8581 16.613 76.6841 16.613C75.5155 16.613 74.4631 16.0912 73.7096 15.2554C72.953 14.4236 72.4903 13.2777 72.4903 12.0261C72.4903 10.7745 72.953 9.6275 73.7096 8.79484C74.4631 7.95992 75.5155 7.43898 76.6841 7.43898C77.8576 7.43898 78.9194 7.9706 79.6751 8.8147V8.06002C79.6751 7.88571 79.7438 7.7243 79.8551 7.61282C79.9659 7.50303 80.1158 7.43898 80.2765 7.43898C80.4354 7.43898 80.5866 7.50303 80.6961 7.61282ZM89.1725 8.417C89.2919 8.2939 89.3565 8.1306 89.3565 7.96853C89.3565 7.80924 89.2919 7.64976 89.1712 7.53428H89.1725C89.1712 7.53065 89.1685 7.53065 89.1685 7.53065C89.168 7.52769 89.1658 7.52665 89.1658 7.52665H89.164C89.0482 7.40844 88.8997 7.34355 88.7462 7.34355C88.5914 7.34355 88.4397 7.41065 88.3239 7.53065L83.6302 12.2846V4.29455C83.6302 3.9502 83.3528 3.67057 83.0122 3.67057C82.848 3.67057 82.6976 3.74221 82.5899 3.85475C82.4831 3.96643 82.4117 4.12384 82.4117 4.29455V15.9911C82.4117 16.1618 82.4831 16.3182 82.5899 16.429C82.6976 16.5395 82.848 16.613 83.0122 16.613C83.3528 16.613 83.6302 16.3344 83.6302 15.9911V14.061L85.1587 12.4745L88.2745 16.3812C88.3333 16.4709 88.4132 16.5327 88.4922 16.5653C88.5819 16.6007 88.6694 16.613 88.7471 16.613C88.8548 16.613 89.006 16.5892 89.1393 16.4804L89.1469 16.4758L89.1546 16.467C89.2793 16.3392 89.3502 16.1694 89.3502 15.9957C89.3502 15.8497 89.2982 15.7009 89.2017 15.5819V15.5799L86.0298 11.5728L89.1694 8.417H89.1725ZM68.1444 3.69837H68.0102C67.9927 3.69837 67.9756 3.70026 67.9572 3.70095C67.9406 3.70026 67.9231 3.69837 67.9056 3.69837C67.5596 3.69837 67.2235 3.73927 66.9093 3.84802C66.6001 3.95486 66.3147 4.13144 66.0935 4.3995L66.0926 4.39847L66.0917 4.3995V4.40037C65.8633 4.66463 65.7125 4.98049 65.6209 5.33936C65.5289 5.69992 65.4912 6.10628 65.4876 6.56802V7.46209H64.5389C64.2095 7.46402 63.9479 7.73776 63.9479 8.06882C63.9461 8.24712 64.013 8.41131 64.1216 8.52971C64.2306 8.64604 64.3801 8.72232 64.5465 8.73183H65.4876V16.0063L65.4863 16.0234C65.4863 16.1941 65.5554 16.3515 65.6667 16.4642C65.7766 16.5748 65.931 16.6406 66.0989 16.6406C66.4184 16.6389 66.6809 16.3679 66.6818 16.0234V8.73183H67.7019C67.8661 8.72232 68.0178 8.6507 68.126 8.53522C68.2373 8.41992 68.305 8.25785 68.305 8.08213V8.05846C68.3014 7.73103 68.038 7.46209 67.7082 7.46209H66.6818V6.57178C66.6885 6.1779 66.7276 5.88308 66.7846 5.66853C66.8398 5.45277 66.9152 5.31729 66.9829 5.23338C67.0494 5.15898 67.1355 5.09686 67.276 5.04712C67.4173 4.99969 67.6126 4.9691 67.8773 4.9691H67.9083C67.924 4.9691 67.9406 4.96618 67.9554 4.96618C67.9738 4.96618 67.9909 4.9691 68.0102 4.9691H68.0874H68.1444C68.4827 4.9691 68.756 4.68483 68.756 4.33357C68.756 3.98265 68.4827 3.69837 68.1444 3.69837ZM7.67882 12.439C7.72747 12.2796 7.74775 12.1155 7.74407 11.9534C7.73846 11.836 7.72383 11.7188 7.69174 11.6015C7.59526 11.2371 7.3667 10.9115 7.02419 10.7063L2.153 7.78336C1.46535 7.37202 0.588678 7.61658 0.194023 8.33018C-0.20445 9.0427 0.0305809 9.95268 0.718234 10.3651L3.44027 12.0011L0.718234 13.6325C0.0305809 14.0456 -0.20362 14.9558 0.194023 15.6713C0.588678 16.3829 1.46535 16.6263 2.153 16.215L7.02419 13.2901C7.35292 13.0935 7.576 12.7852 7.67882 12.439ZM9.00081 15.1781C8.72091 15.1532 8.42993 15.2143 8.16816 15.3728L3.29328 18.2938C2.60745 18.706 2.37325 19.6209 2.76907 20.3347C3.16671 21.0465 4.04255 21.2916 4.72737 20.8775L7.45856 19.2403V22.5117C7.45856 23.336 8.10021 24.0038 8.89432 24.0038C9.68461 24.0038 10.3283 23.336 10.3283 22.5117V16.6634C10.3283 15.8782 9.74259 15.2333 9.00081 15.1781ZM13.9931 8.82209C14.2721 8.84609 14.5623 8.78411 14.8241 8.62755L19.6979 5.70373C20.3848 5.29136 20.6178 4.38034 20.223 3.6647C19.8273 2.95235 18.9507 2.70793 18.2648 3.11995L15.5355 4.75903V1.48654C15.5355 0.664582 14.8938 -0.00341797 14.0997 -0.00341797C13.3056 -0.00341797 12.6656 0.664582 12.6656 1.48654V7.33489C12.6656 8.11922 13.2496 8.76515 13.9931 8.82209ZM3.29328 5.70373L8.16816 8.62755C8.42993 8.78411 8.72091 8.84609 9.00081 8.82209C9.74259 8.76515 10.3283 8.11922 10.3283 7.33489V1.48654C10.3283 0.664582 9.68461 -0.00341797 8.89432 -0.00341797C8.10021 -0.00341797 7.45856 0.664582 7.45856 1.48654V4.75903L4.72737 3.11995C4.04255 2.70793 3.16671 2.95235 2.76907 3.6647C2.37325 4.38034 2.60745 5.29136 3.29328 5.70373ZM12.4545 11.9888C12.4545 11.9039 12.405 11.7855 12.3472 11.7227L11.7605 11.1157C11.7027 11.0558 11.5888 11.0061 11.5069 11.0061H11.4841C11.4024 11.0061 11.2887 11.0558 11.2317 11.1157L10.645 11.7227C10.5862 11.7855 10.5412 11.9039 10.5412 11.9888V12.0126C10.5412 12.0965 10.5862 12.2139 10.645 12.275L11.2317 12.8836C11.2895 12.9437 11.4024 12.9932 11.4841 12.9932H11.5069C11.5888 12.9932 11.7027 12.9437 11.7605 12.8836L12.3472 12.275C12.405 12.2139 12.4545 12.0965 12.4545 12.0126V11.9888ZM14.074 12.5725L12.0479 14.6755C11.9899 14.7372 11.878 14.7878 11.7936 14.7878H11.6466H11.3473H11.1978C11.1159 14.7878 11.0021 14.7372 10.9433 14.6755L8.91824 12.5725C8.86026 12.5133 8.81345 12.3942 8.81345 12.3102V12.1547V11.8436V11.6902C8.81345 11.6042 8.86026 11.485 8.91824 11.4249L10.9433 9.32213C11.0021 9.2602 11.1159 9.2115 11.1978 9.2115H11.3473H11.6466H11.7936C11.8761 9.2115 11.9899 9.2602 12.0479 9.32213L14.074 11.4249C14.1318 11.485 14.1786 11.6042 14.1786 11.6902V11.8436V12.1547V12.3102C14.1786 12.3942 14.1318 12.5133 14.074 12.5725ZM19.6979 18.2938L14.8241 15.3728C14.5623 15.2143 14.2721 15.1532 13.9931 15.1781C13.2496 15.2333 12.6656 15.8782 12.6656 16.6634V22.5117C12.6656 23.336 13.3056 24.0038 14.0997 24.0038C14.8938 24.0038 15.5355 23.336 15.5355 22.5117V19.2403L18.2648 20.8775C18.9505 21.2916 19.8273 21.0465 20.223 20.3347C20.6178 19.6209 20.3848 18.706 19.6979 18.2938ZM22.275 10.3651L19.5528 12.0011L22.275 13.6325C22.9625 14.0456 23.1975 14.9558 22.8 15.6713C22.4034 16.3829 21.5259 16.6263 20.8409 16.215L15.966 13.2901C15.6409 13.0935 15.4153 12.7852 15.3151 12.439C15.2674 12.2796 15.2453 12.1155 15.2508 11.9534C15.2536 11.836 15.2701 11.7188 15.3013 11.6015C15.3988 11.2371 15.6273 10.9117 15.966 10.7063L20.8409 7.78336C21.5259 7.37202 22.4034 7.61658 22.8 8.33018C23.1975 9.0427 22.9625 9.95268 22.275 10.3651ZM101.327 7.44726C101.327 8.26731 100.799 8.95173 99.9166 8.95173C99.0401 8.95173 98.5182 8.26077 98.5182 7.44726C98.5182 6.62722 99.0401 5.94265 99.9166 5.94265C100.799 5.94265 101.327 6.62722 101.327 7.44726ZM101.047 7.44726C101.047 6.74995 100.6 6.2202 99.9166 6.2202C99.2452 6.2202 98.7978 6.72388 98.7978 7.44726C98.7978 8.13804 99.2452 8.67399 99.9166 8.67399C100.6 8.67399 101.047 8.14463 101.047 7.44726ZM99.3632 6.7691H99.966C100.295 6.7691 100.513 6.95635 100.513 7.24689C100.513 7.42778 100.426 7.56326 100.295 7.64731L100.531 8.00237V8.07348H100.19L99.9597 7.73122H99.6926V8.07348H99.3632V6.7691ZM99.9597 7.08566H99.6926V7.42778H99.9597C100.084 7.42778 100.165 7.36957 100.165 7.25997C100.165 7.14364 100.09 7.08566 99.9597 7.08566Z" fill="#29B5E8"></path></svg><span class="ml-[14px] text-[12px] font-extrabold tracking-[.72px] text-primary">DOCUMENTATION</span></a><div class="flex justify-end items-center md:max-w-[440px] flex-1 gap-6"><div class="flex items-center lg:hidden"><div class="mr-4"><button type="button" class="rounded-lg ui-icon flex align-center" aria-label="Search"><svg width="19" height="20" viewBox="0 0 19 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="scale-110 fill-black-10 dark:fill-gray-50 dark:stroke-gray-50 shrink-0"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.50157 7.50472C2.50157 4.74156 4.74156 2.50157 7.50472 2.50157C10.2679 2.50157 12.5079 4.74156 12.5079 7.50472C12.5079 10.2679 10.2679 12.5079 7.50472 12.5079C4.74156 12.5079 2.50157 10.2679 2.50157 7.50472ZM7.50472 0C3.35998 0 0 3.35998 0 7.50472C0 11.6495 3.35998 15.0094 7.50472 15.0094C9.02874 15.0094 10.4467 14.5552 11.6305 13.7746L16.5548 18.6989C17.0432 19.1874 17.8352 19.1874 18.3237 18.6989C18.8121 18.2105 18.8121 17.4185 18.3237 16.9301L13.4625 12.0689C14.4328 10.8043 15.0094 9.22184 15.0094 7.50472C15.0094 3.35998 11.6495 0 7.50472 0Z" fill="#5D6A85"></path></svg></button></div><div><button type="button" class="rounded-lg ui-icon flex align-center" aria-label="Search"><svg width="20" height="18" viewBox="0 0 20 18" fill="none" xmlns="http://www.w3.org/2000/svg" class="scale-110 fill-black-10 dark:fill-gray-50 dark:stroke-gray-50 shrink-0"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.25 0C0.559644 0 0 0.559644 0 1.25C0 1.94036 0.559644 2.5 1.25 2.5H18.75C19.4404 2.5 20 1.94036 20 1.25C20 0.559644 19.4404 0 18.75 0H1.25ZM1.25 5C0.559644 5 0 5.55964 0 6.25C0 6.94036 0.559644 7.5 1.25 7.5H18.75C19.4404 7.5 20 6.94036 20 6.25C20 5.55964 19.4404 5 18.75 5H1.25ZM0 11.25C0 10.5596 0.559644 10 1.25 10H18.75C19.4404 10 20 10.5596 20 11.25C20 11.9404 19.4404 12.5 18.75 12.5H1.25C0.559644 12.5 0 11.9404 0 11.25ZM1.25 15C0.559644 15 0 15.5596 0 16.25C0 16.9404 0.559644 17.5 1.25 17.5H10C10.6904 17.5 11.25 16.9404 11.25 16.25C11.25 15.5596 10.6904 15 10 15H1.25Z" fill="#5D6A85"></path></svg></button></div></div><div class="relative border h-full rounded-md items-center px-3 gap-2 w-full bg-gray-10 dark:bg-gray-85 hover:border-gray-50 hidden lg:flex" role="search"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" stroke="none" class="fill-black-10 dark:fill-gray-50 stroke-black-10 dark:stroke-gray-50 shrink-0 m-0 h-3 w-3"><circle cx="4.5" cy="4.5" r="4" fill="none"></circle><path d="M7.85355 7.14645C7.65829 6.95118 7.34171 6.95118 7.14645 7.14645C6.95118 7.34171 6.95118 7.65829 7.14645 7.85355L7.85355 7.14645ZM10.682 11.3891L11.0355 11.7426L11.7426 11.0355L11.3891 10.682L10.682 11.3891ZM7.14645 7.85355L10.682 11.3891L11.3891 10.682L7.85355 7.14645L7.14645 7.85355Z" stroke="none"></path></svg><input autoComplete="off" name="q" placeholder="Search" role="searchbox" class="outline-none w-full bg-gray-10 dark:bg-gray-85 placeholder:text-secondary pr-3 py-2 text-sm"/><span class="text-secondary text-xs font-normal font-mono leading-none px-1.5 py-1 bg-level-3 hidden sm:inline-flex rounded border border-slate-300 ">/</span></div><div class="w-12 shrink-0 hidden lg:block"></div></div></div><div class="hidden lg:flex border-b gap-3 pl-6"><div class="flex flex-col mt-2 gap-2 justify-between"><a href="/en/user-guide-getting-started" target="" rel="" class="flex items-center whitespace-nowrap p-2 hover:bg-level-3 rounded-md text-masthead-link">Getting Started<!-- --></a><div class="h-[3px] rounded-tl-[5px] rounded-tr-[5px] mx-2"></div></div><div class="flex flex-col mt-2 gap-2 justify-between"><a href="/en/guides" target="" rel="" class="flex items-center whitespace-nowrap p-2 hover:bg-level-3 rounded-md text-masthead-link">Guides<!-- --></a><div class="h-[3px] rounded-tl-[5px] rounded-tr-[5px] mx-2"></div></div><div class="flex flex-col mt-2 gap-2 justify-between"><a href="/en/developer" target="" rel="" class="flex items-center whitespace-nowrap p-2 hover:bg-level-3 rounded-md text-masthead-link text-link">Developer<!-- --></a><div class="h-[3px] rounded-tl-[5px] rounded-tr-[5px] mx-2 bg-blue-50 dark:bg-blue-30"></div></div><div class="flex flex-col mt-2 gap-2 justify-between"><a href="/en/reference" target="" rel="" class="flex items-center whitespace-nowrap p-2 hover:bg-level-3 rounded-md text-masthead-link">Reference<!-- --></a><div class="h-[3px] rounded-tl-[5px] rounded-tr-[5px] mx-2"></div></div><div class="flex flex-col mt-2 gap-2 justify-between"><a href="/en/release-notes/new-features" target="" rel="" class="flex items-center whitespace-nowrap p-2 hover:bg-level-3 rounded-md text-masthead-link">Releases<!-- --></a><div class="h-[3px] rounded-tl-[5px] rounded-tr-[5px] mx-2"></div></div><div class="flex flex-col mt-2 gap-2 justify-between"><a href="/en/tutorials" target="" rel="" class="flex items-center whitespace-nowrap p-2 hover:bg-level-3 rounded-md text-masthead-link">Tutorials<!-- --></a><div class="h-[3px] rounded-tl-[5px] rounded-tr-[5px] mx-2"></div></div><div class="flex flex-col mt-2 gap-2 justify-between"><a href="https://status.snowflake.com" target="_blank" rel="noreferrer" class="flex items-center whitespace-nowrap p-2 hover:bg-level-3 rounded-md text-masthead-link">Status<!-- --><span class="ml-[10px]"><span class=""><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="circle-question" class="svg-inline--fa fa-circle-question " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 400c-18 0-32-14-32-32s13.1-32 32-32c17.1 0 32 14 32 32S273.1 400 256 400zM325.1 258L280 286V288c0 13-11 24-24 24S232 301 232 288V272c0-8 4-16 12-21l57-34C308 213 312 206 312 198C312 186 301.1 176 289.1 176h-51.1C225.1 176 216 186 216 198c0 13-11 24-24 24s-24-11-24-24C168 159 199 128 237.1 128h51.1C329 128 360 159 360 198C360 222 347 245 325.1 258z"></path></svg></span></span></a><div class="h-[3px] rounded-tl-[5px] rounded-tr-[5px] mx-2"></div></div></div></nav><div class="grid h-full auto-rows-auto relative overflow-y-hidden"><main class="flex overflow-y-hidden"><aside class="flex-none hidden lg:block overflow-y-auto bg-lightgray border-r pb-8 scroll-bar w-80 scroll-bar-stable" data-testid="toc-wrapper"><div class="pt-6 pl-1"><nav id="toc"><ol><li class="font-normal"><div class="px-3 text-sm rounded-md hover:bg-level-3 mx-5 flex justify-between items-center"><a href="/en/developer" class="w-full py-2 text-ellipsis overflow-hidden text-sm leading-4" title="Overview"><span>Overview</span></a></div><ul></ul></li><li class="pt-3 px-3 py-1 mx-5"><span class="font-bold text-sm">Snowpark Library</span></li><li class="font-normal"><div class="px-3 text-sm rounded-md hover:bg-level-3 mx-5 flex justify-between items-center"><a href="/en/developer-guide/snowpark/index" class="w-full py-2 text-ellipsis overflow-hidden text-sm leading-4" title="Snowpark API"><span>Snowpark API</span></a><div class="w-5 h-5 cursor-pointer flex justify-center items-center select-none py-2" style="transform:rotate(0deg)"><svg width="6" height="8" viewBox="0 0 6 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 6.5L4.5 4L2 1.5" stroke="#8A96AD" stroke-width="2" stroke-linecap="square" stroke-linejoin="round"></path></svg></div></div><ul><ol class="overflow-hidden" style="height:0;opacity:0"><div></div></ol></ul></li><li class="font-normal"><div class="px-3 text-sm rounded-md hover:bg-level-3 mx-5 flex justify-between items-center"><a href="/en/developer-guide/snowpark-ml/index" class="w-full py-2 text-ellipsis overflow-hidden text-sm leading-4" title="Snowpark ML"><span>Snowpark ML</span></a><div class="w-5 h-5 cursor-pointer flex justify-center items-center select-none py-2" style="transform:rotate(0deg)"><svg width="6" height="8" viewBox="0 0 6 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 6.5L4.5 4L2 1.5" stroke="#8A96AD" stroke-width="2" stroke-linecap="square" stroke-linejoin="round"></path></svg></div></div><ul><ol class="overflow-hidden" style="height:0;opacity:0"><div></div></ol></ul></li><li class="pt-3 px-3 py-1 mx-5"><span class="font-bold text-sm">Snowpark Runtime</span></li><li class="font-normal"><div class="px-3 text-sm rounded-md hover:bg-level-3 mx-5 flex justify-between items-center"><a href="/en/developer-guide/snowpark-container-services/overview" class="w-full py-2 text-ellipsis overflow-hidden text-sm leading-4" title="Snowpark Container Services"><span>Snowpark Container Services</span></a><div class="w-5 h-5 cursor-pointer flex justify-center items-center select-none py-2" style="transform:rotate(0deg)"><svg width="6" height="8" viewBox="0 0 6 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 6.5L4.5 4L2 1.5" stroke="#8A96AD" stroke-width="2" stroke-linecap="square" stroke-linejoin="round"></path></svg></div></div><ul><ol class="overflow-hidden" style="height:0;opacity:0"><div></div></ol></ul></li><li class="font-normal"><div class="px-3 text-sm rounded-md hover:bg-level-3 mx-5 flex justify-between items-center"><a href="/en/developer-guide/extensibility" class="w-full py-2 text-ellipsis overflow-hidden text-sm leading-4" title="Functions and Procedures"><span>Functions and Procedures</span></a><div class="w-5 h-5 cursor-pointer flex justify-center items-center select-none py-2" style="transform:rotate(0deg)"><svg width="6" height="8" viewBox="0 0 6 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 6.5L4.5 4L2 1.5" stroke="#8A96AD" stroke-width="2" stroke-linecap="square" stroke-linejoin="round"></path></svg></div></div><ul><ol class="overflow-hidden" style="height:0;opacity:0"><div></div></ol></ul></li><li class="pt-3 px-3 py-1 mx-5"><span class="font-bold text-sm">Snowflake APIs</span></li><li class="font-normal"><div class="px-3 text-sm rounded-md hover:bg-level-3 mx-5 flex justify-between items-center"><a href="/en/developer-guide/snowflake-python-api/snowflake-python-overview" class="w-full py-2 text-ellipsis overflow-hidden text-sm leading-4" title="Snowflake Python API"><span>Snowflake Python API</span></a><div class="w-5 h-5 cursor-pointer flex justify-center items-center select-none py-2" style="transform:rotate(0deg)"><svg width="6" height="8" viewBox="0 0 6 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 6.5L4.5 4L2 1.5" stroke="#8A96AD" stroke-width="2" stroke-linecap="square" stroke-linejoin="round"></path></svg></div></div><ul><ol class="overflow-hidden" style="height:0;opacity:0"><div></div></ol></ul></li><li class="font-normal"><div class="px-3 text-sm rounded-md hover:bg-level-3 mx-5 flex justify-between items-center"><a href="/en/developer-guide/sql-api/index" class="w-full py-2 text-ellipsis overflow-hidden text-sm leading-4" title="SQL REST API"><span>SQL REST API</span></a><div class="w-5 h-5 cursor-pointer flex justify-center items-center select-none py-2" style="transform:rotate(0deg)"><svg width="6" height="8" viewBox="0 0 6 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 6.5L4.5 4L2 1.5" stroke="#8A96AD" stroke-width="2" stroke-linecap="square" stroke-linejoin="round"></path></svg></div></div><ul><ol class="overflow-hidden" style="height:0;opacity:0"><div></div></ol></ul></li><li class="pt-3 px-3 py-1 mx-5"><span class="font-bold text-sm">Apps</span></li><li class="font-normal"><div class="px-3 text-sm rounded-md hover:bg-level-3 mx-5 flex justify-between items-center"><a href="/en/developer-guide/streamlit/about-streamlit" class="w-full py-2 text-ellipsis overflow-hidden text-sm leading-4" title="Streamlit in Snowflake"><span>Streamlit in Snowflake</span></a><div class="w-5 h-5 cursor-pointer flex justify-center items-center select-none py-2" style="transform:rotate(0deg)"><svg width="6" height="8" viewBox="0 0 6 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 6.5L4.5 4L2 1.5" stroke="#8A96AD" stroke-width="2" stroke-linecap="square" stroke-linejoin="round"></path></svg></div></div><ul><ol class="overflow-hidden" style="height:0;opacity:0"><div></div></ol></ul></li><li class="font-normal"><div class="px-3 text-sm rounded-md hover:bg-level-3 mx-5 flex justify-between items-center"><a href="/en/developer-guide/native-apps/native-apps-about" class="w-full py-2 text-ellipsis overflow-hidden text-sm leading-4" title="Snowflake Native App Framework"><span>Snowflake Native App Framework</span></a><div class="w-5 h-5 cursor-pointer flex justify-center items-center select-none py-2" style="transform:rotate(0deg)"><svg width="6" height="8" viewBox="0 0 6 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 6.5L4.5 4L2 1.5" stroke="#8A96AD" stroke-width="2" stroke-linecap="square" stroke-linejoin="round"></path></svg></div></div><ul><ol class="overflow-hidden" style="height:0;opacity:0"><div></div></ol></ul></li><li class="pt-3 px-3 py-1 mx-5"><span class="font-bold text-sm">External System Integration</span></li><li class="font-normal"><div class="px-3 text-sm rounded-md hover:bg-level-3 mx-5 flex justify-between items-center"><a href="/en/sql-reference/external-functions" class="w-full py-2 text-ellipsis overflow-hidden text-sm leading-4" title="External Functions"><span>External Functions</span></a><div class="w-5 h-5 cursor-pointer flex justify-center items-center select-none py-2" style="transform:rotate(0deg)"><svg width="6" height="8" viewBox="0 0 6 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 6.5L4.5 4L2 1.5" stroke="#8A96AD" stroke-width="2" stroke-linecap="square" stroke-linejoin="round"></path></svg></div></div><ul><ol class="overflow-hidden" style="height:0;opacity:0"><div></div></ol></ul></li><li class="font-normal"><div class="px-3 text-sm rounded-md hover:bg-level-3 mx-5 flex justify-between items-center"><a href="/en/user-guide/connectors" class="w-full py-2 text-ellipsis overflow-hidden text-sm leading-4" title="Kafka and Spark Connectors"><span>Kafka and Spark Connectors</span></a><div class="w-5 h-5 cursor-pointer flex justify-center items-center select-none py-2" style="transform:rotate(90deg)"><svg width="6" height="8" viewBox="0 0 6 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 6.5L4.5 4L2 1.5" stroke="#8A96AD" stroke-width="2" stroke-linecap="square" stroke-linejoin="round"></path></svg></div></div><ul><ol class="overflow-hidden" style="height:auto;opacity:0"><div><li class="font-normal"><div class="px-3 text-sm rounded-md hover:bg-level-3 mx-5 flex justify-between items-center pl-5"><a href="/en/user-guide/kafka-connector" class="w-full py-2 text-ellipsis overflow-hidden text-sm leading-4" title="Kafka Connector"><span>Kafka Connector</span></a><div class="w-5 h-5 cursor-pointer flex justify-center items-center select-none py-2" style="transform:rotate(0deg)"><svg width="6" height="8" viewBox="0 0 6 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 6.5L4.5 4L2 1.5" stroke="#8A96AD" stroke-width="2" stroke-linecap="square" stroke-linejoin="round"></path></svg></div></div><ul><ol class="overflow-hidden" style="height:0;opacity:0"><div></div></ol></ul></li><li class="font-normal"><div class="px-3 text-sm rounded-md hover:bg-level-3 mx-5 flex justify-between items-center pl-5"><a href="/en/user-guide/spark-connector" class="w-full py-2 text-ellipsis overflow-hidden text-sm leading-4" title="Spark Connector"><span>Spark Connector</span></a><div class="w-5 h-5 cursor-pointer flex justify-center items-center select-none py-2" style="transform:rotate(90deg)"><svg width="6" height="8" viewBox="0 0 6 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 6.5L4.5 4L2 1.5" stroke="#8A96AD" stroke-width="2" stroke-linecap="square" stroke-linejoin="round"></path></svg></div></div><ul><ol class="overflow-hidden" style="height:auto;opacity:0"><div><li class="font-normal"><div class="px-3 text-sm rounded-md hover:bg-level-3 mx-5 flex justify-between items-center pl-7"><a href="/en/user-guide/spark-connector-overview" class="w-full py-2 text-ellipsis overflow-hidden text-sm leading-4" title="Overview"><span>Overview</span></a></div><ul></ul></li><li class="font-normal"><div class="px-3 text-sm rounded-md hover:bg-level-3 mx-5 flex justify-between items-center pl-7"><a href="/en/user-guide/spark-connector-install" class="w-full py-2 text-ellipsis overflow-hidden text-sm leading-4" title="Install"><span>Install</span></a></div><ul></ul></li><li class="font-normal"><div class="px-3 text-sm rounded-md hover:bg-level-3 mx-5 flex justify-between items-center pl-7"><a href="/en/user-guide/spark-connector-databricks" class="w-full py-2 text-ellipsis overflow-hidden text-sm leading-4" title="Configure"><span>Configure</span></a></div><ul></ul></li><li class="font-normal"><div class="px-3 text-sm rounded-md hover:bg-level-3 mx-5 flex justify-between items-center pl-7"><a href="/en/user-guide/spark-connector-qubole" class="w-full py-2 text-ellipsis overflow-hidden text-sm leading-4" title="Qubole"><span>Qubole</span></a></div><ul></ul></li><li class="font-normal"><div class="px-3 text-sm rounded-md hover:bg-level-3 mx-5 flex justify-between items-center bg-highlight text-blue-60 dark:text-blue-30 pl-7" id="selected-item"><a href="/en/user-guide/spark-connector-use" class="w-full py-2 text-ellipsis overflow-hidden text-sm leading-4" title="Usage"><span>Usage</span></a></div><ul></ul></li></div></ol></ul></li></div></ol></ul></li><li class="pt-3 px-3 py-1 mx-5"><span class="font-bold text-sm">Snowflake Scripting</span></li><li class="font-normal"><div class="px-3 text-sm rounded-md hover:bg-level-3 mx-5 flex justify-between items-center"><a href="/en/developer-guide/snowflake-scripting/index" class="w-full py-2 text-ellipsis overflow-hidden text-sm leading-4" title="Snowflake Scripting Developer Guide"><span>Snowflake Scripting Developer Guide</span></a><div class="w-5 h-5 cursor-pointer flex justify-center items-center select-none py-2" style="transform:rotate(0deg)"><svg width="6" height="8" viewBox="0 0 6 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 6.5L4.5 4L2 1.5" stroke="#8A96AD" stroke-width="2" stroke-linecap="square" stroke-linejoin="round"></path></svg></div></div><ul><ol class="overflow-hidden" style="height:0;opacity:0"><div></div></ol></ul></li><li class="pt-3 px-3 py-1 mx-5"><span class="font-bold text-sm">Tools</span></li><li class="font-normal"><div class="px-3 text-sm rounded-md hover:bg-level-3 mx-5 flex justify-between items-center"><a href="/en/developer-guide/snowflake-cli-v2/index" class="w-full py-2 text-ellipsis overflow-hidden text-sm leading-4" title="Snowflake CLI"><span>Snowflake CLI</span></a><div class="w-5 h-5 cursor-pointer flex justify-center items-center select-none py-2" style="transform:rotate(0deg)"><svg width="6" height="8" viewBox="0 0 6 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 6.5L4.5 4L2 1.5" stroke="#8A96AD" stroke-width="2" stroke-linecap="square" stroke-linejoin="round"></path></svg></div></div><ul><ol class="overflow-hidden" style="height:0;opacity:0"><div></div></ol></ul></li><li class="font-normal"><div class="px-3 text-sm rounded-md hover:bg-level-3 mx-5 flex justify-between items-center"><a href="/en/developer-guide/git/git-overview" class="w-full py-2 text-ellipsis overflow-hidden text-sm leading-4" title="Git"><span>Git</span></a><div class="w-5 h-5 cursor-pointer flex justify-center items-center select-none py-2" style="transform:rotate(0deg)"><svg width="6" height="8" viewBox="0 0 6 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 6.5L4.5 4L2 1.5" stroke="#8A96AD" stroke-width="2" stroke-linecap="square" stroke-linejoin="round"></path></svg></div></div><ul><ol class="overflow-hidden" style="height:0;opacity:0"><div></div></ol></ul></li><li class="pt-3 px-3 py-1 mx-5"><span class="font-bold text-sm">Drivers</span></li><li class="font-normal"><div class="px-3 text-sm rounded-md hover:bg-level-3 mx-5 flex justify-between items-center"><a href="/en/developer-guide/drivers" class="w-full py-2 text-ellipsis overflow-hidden text-sm leading-4" title="Overview"><span>Overview</span></a><div class="w-5 h-5 cursor-pointer flex justify-center items-center select-none py-2" style="transform:rotate(0deg)"><svg width="6" height="8" viewBox="0 0 6 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 6.5L4.5 4L2 1.5" stroke="#8A96AD" stroke-width="2" stroke-linecap="square" stroke-linejoin="round"></path></svg></div></div><ul><ol class="overflow-hidden" style="height:0;opacity:0"><div></div></ol></ul></li><li class="pt-3 px-3 py-1 mx-5"><span class="font-bold text-sm">Reference</span></li><li class="font-normal"><div class="px-3 text-sm rounded-md hover:bg-level-3 mx-5 flex justify-between items-center"><a href="/en/api-reference" class="w-full py-2 text-ellipsis overflow-hidden text-sm leading-4" title="API Reference"><span>API Reference</span></a></div><ul></ul></li></ol></nav></div></aside><div class="w-full overflow-y-auto" id="scrolltarget"><div class="flex flex-col-reverse xl:flex-row xl:justify-between mx-auto pt-8 px-8 mb-12 max-w-[1175px]"><div class="w-full xl:w-9/12"><nav class="mb-2 flex space-x-4 text-sm flex-wrap"><a href="/en/developer" class="text-link hover:underline">Developer</a><span class="ui-icon mb-2"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="chevron-right" class="svg-inline--fa fa-chevron-right " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M96 480c-8.188 0-16.38-3.125-22.62-9.375c-12.5-12.5-12.5-32.75 0-45.25L242.8 256L73.38 86.63c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0l192 192c12.5 12.5 12.5 32.75 0 45.25l-192 192C112.4 476.9 104.2 480 96 480z"></path></svg></span><a href="/en/user-guide/connectors" class="text-link hover:underline">Kafka and Spark Connectors</a><span class="ui-icon mb-2"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="chevron-right" class="svg-inline--fa fa-chevron-right " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M96 480c-8.188 0-16.38-3.125-22.62-9.375c-12.5-12.5-12.5-32.75 0-45.25L242.8 256L73.38 86.63c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0l192 192c12.5 12.5 12.5 32.75 0 45.25l-192 192C112.4 476.9 104.2 480 96 480z"></path></svg></span><a href="/en/user-guide/spark-connector" class="text-link hover:underline">Spark Connector</a><span class="ui-icon mb-2"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="chevron-right" class="svg-inline--fa fa-chevron-right " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M96 480c-8.188 0-16.38-3.125-22.62-9.375c-12.5-12.5-12.5-32.75 0-45.25L242.8 256L73.38 86.63c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0l192 192c12.5 12.5 12.5 32.75 0 45.25l-192 192C112.4 476.9 104.2 480 96 480z"></path></svg></span><span class="mb-2">Usage</span></nav><article>


  
  <section id="using-the-spark-connector">
<h1>Using the Spark Connector<a class="headerlink" href="#using-the-spark-connector" title="Link to this heading">¶</a></h1>

<p>The connector adheres to the standard Spark API, but with the addition of Snowflake-specific options, which are described in this topic.</p>
<p>In this topic, the term COPY refers to both:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../sql-reference/sql/copy-into-table"><span class="doc">COPY INTO &lt;table&gt;</span></a> (used to transfer data from an internal or external stage into a table).</p></li>
<li><p><a class="reference internal" href="../sql-reference/sql/copy-into-location"><span class="doc">COPY INTO &lt;location&gt;</span></a> (used to transfer data from a table into an internal or external stage).</p></li>
</ul>


<section id="verifying-the-network-connection-to-snowflake-with-snowcd">
<span id="label-snowcd-spark"></span><h2>Verifying the Network Connection to Snowflake with SnowCD<a class="headerlink" href="#verifying-the-network-connection-to-snowflake-with-snowcd" title="Link to this heading">¶</a></h2>
<p>After configuring your driver, you can evaluate and troubleshoot your network connectivity to Snowflake using <a class="reference internal" href="snowcd"><span class="doc">SnowCD</span></a>.</p>
<p>You can use SnowCD during the initial configuration process and on-demand at any time to evaluate and troubleshoot your network connection to Snowflake.</p>
</section>
<section id="pushdown">
<span id="label-spark-pushdown"></span><h2>Pushdown<a class="headerlink" href="#pushdown" title="Link to this heading">¶</a></h2>
<p>The Spark Connector applies predicate and query pushdown by capturing and analyzing the Spark logical plans for SQL operations. When the data source is Snowflake, the operations are translated into a SQL query and then executed in Snowflake to improve performance.</p>
<p>However, because this translation requires almost a one-to-one translation of Spark SQL operators to Snowflake expressions, not all of Spark SQL operators can be pushed down. When pushdown fails, the connector falls back to a less-optimized execution plan. The unsupported operations are instead performed in Spark.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you need pushdown for all operations, consider writing your code to use <a class="reference internal" href="../developer-guide/snowpark/index"><span class="doc">Snowpark API</span></a> instead.</p>
</div>
<p>Below is a list of supported operations for pushdown (all functions below use their Spark names). If a function is not in this list, a Spark plan that utilizes it might be executed on Spark rather than pushed down into Snowflake.</p>
<ul class="simple">
<li><p>Aggregation Functions</p>
<ul>
<li><p>Average</p></li>
<li><p>Corr</p></li>
<li><p>CovPopulation</p></li>
<li><p>CovSample</p></li>
<li><p>Count</p></li>
<li><p>Max</p></li>
<li><p>Min</p></li>
<li><p>StddevPop</p></li>
<li><p>StddevSamp</p></li>
<li><p>Sum</p></li>
<li><p>VariancePop</p></li>
<li><p>VarianceSamp</p></li>
</ul>
</li>
<li><p>Boolean Operators</p>
<ul>
<li><p>And</p></li>
<li><p>Between</p></li>
<li><p>Contains</p></li>
<li><p>EndsWith</p></li>
<li><p>EqualTo</p></li>
<li><p>GreaterThan</p></li>
<li><p>GreaterThanOrEqual</p></li>
<li><p>In</p></li>
<li><p>IsNull</p></li>
<li><p>IsNotNull</p></li>
<li><p>LessThan</p></li>
<li><p>LessThanOrEqual</p></li>
<li><p>Not</p></li>
<li><p>Or</p></li>
<li><p>StartsWith</p></li>
</ul>
</li>
<li><p>Date, Time, and Timestamp Functions</p>
<ul>
<li><p>DateAdd</p></li>
<li><p>DateSub</p></li>
<li><p>Month</p></li>
<li><p>Quarter</p></li>
<li><p>TruncDate</p></li>
<li><p>TruncTimestamp</p></li>
<li><p>Year</p></li>
</ul>
</li>
<li><p>Mathematical Functions</p>
<ul>
<li><p>Arithmetic operators ‘+’ (addition), ‘-’ (subtraction), ‘*’ (multiplication), ‘/’ (division), and ‘-’ (unary negation).</p></li>
<li><p>Abs</p></li>
<li><p>Acos</p></li>
<li><p>Asin</p></li>
<li><p>Atan</p></li>
<li><p>Ceil</p></li>
<li><p>CheckOverflow</p></li>
<li><p>Cos</p></li>
<li><p>Cosh</p></li>
<li><p>Exp</p></li>
<li><p>Floor</p></li>
<li><p>Greatest</p></li>
<li><p>Least</p></li>
<li><p>Log</p></li>
<li><p>Pi</p></li>
<li><p>Pow</p></li>
<li><p>PromotePrecision</p></li>
<li><p>Rand</p></li>
<li><p>Round</p></li>
<li><p>Sin</p></li>
<li><p>Sinh</p></li>
<li><p>Sqrt</p></li>
<li><p>Tan</p></li>
<li><p>Tanh</p></li>
</ul>
</li>
<li><p>Miscellaneous Operators</p>
<ul>
<li><p>Alias (AS expressions)</p></li>
<li><p>BitwiseAnd</p></li>
<li><p>BitwiseNot</p></li>
<li><p>BitwiseOr</p></li>
<li><p>BitwiseXor</p></li>
<li><p>CaseWhen</p></li>
<li><p>Cast(child, t, _)</p></li>
<li><p>Coalesce</p></li>
<li><p>If</p></li>
<li><p>MakeDecimal</p></li>
<li><p>ScalarSubquery</p></li>
<li><p>ShiftLeft</p></li>
<li><p>ShiftRight</p></li>
<li><p>SortOrder</p></li>
<li><p>UnscaledValue</p></li>
</ul>
</li>
<li><p>Relational Operators</p>
<ul>
<li><p>Aggregate functions and group-by clauses</p></li>
<li><p>Distinct</p></li>
<li><p>Filters</p></li>
<li><p>In</p></li>
<li><p>InSet</p></li>
<li><p>Joins</p></li>
<li><p>Limits</p></li>
<li><p>Projections</p></li>
<li><p>Sorts (ORDER BY)</p></li>
<li><p>Union and Union All</p></li>
<li><p>Window functions and windowing-clauses</p></li>
</ul>
</li>
<li><p>String Functions</p>
<ul>
<li><p>Ascii</p></li>
<li><p>Concat(children)</p></li>
<li><p>Length</p></li>
<li><p>Like</p></li>
<li><p>Lower</p></li>
<li><p>StringLPad</p></li>
<li><p>StringRPad</p></li>
<li><p>StringTranslate</p></li>
<li><p>StringTrim</p></li>
<li><p>StringTrimLeft</p></li>
<li><p>StringTrimRight</p></li>
<li><p>Substring</p></li>
<li><p>Upper</p></li>
</ul>
</li>
<li><p>Window Functions (note: these do not work with Spark 2.2)</p>
<ul>
<li><p>DenseRank</p></li>
<li><p>Rank</p></li>
<li><p>RowNumber</p></li>
</ul>
</li>
</ul>
</section>
<section id="using-the-connector-in-scala">
<h2>Using the Connector in Scala<a class="headerlink" href="#using-the-connector-in-scala" title="Link to this heading">¶</a></h2>
<section id="specifying-the-data-source-class-name">
<span id="label-spark-data-source"></span><h3>Specifying the Data Source Class Name<a class="headerlink" href="#specifying-the-data-source-class-name" title="Link to this heading">¶</a></h3>
<p>To use Snowflake as a data source in Spark, use the <code class="code docutils literal notranslate"><span class="pre">.format</span></code> option to provide the Snowflake connector class name that defines the data source.</p>
<blockquote>
<div><p><code class="code docutils literal notranslate"><span class="pre">net.snowflake.spark.snowflake</span></code></p>
</div></blockquote>
<p>To ensure a compile-time check of the class name, Snowflake highly recommends defining a variable for the class name. For example:</p>
<div class="relative group text-sm"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="nc">SNOWFLAKE_SOURCE_NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"net.snowflake.spark.snowflake"</span>
</pre></div>
</div><div data-codeblock-index="0" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
<p>Also, for convenience, the <code class="code docutils literal notranslate"><span class="pre">Utils</span></code> class provides the variable, which can be imported as follows:</p>
<div class="relative group text-sm"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">net</span><span class="p">.</span><span class="nn">snowflake</span><span class="p">.</span><span class="nn">spark</span><span class="p">.</span><span class="nn">snowflake</span><span class="p">.</span><span class="nc">Utils</span><span class="p">.</span><span class="nc">SNOWFLAKE_SOURCE_NAME</span>
</pre></div>
</div><div data-codeblock-index="1" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All examples in this topic use <code class="code docutils literal notranslate"><span class="pre">SNOWFLAKE_SOURCE_NAME</span></code> as the class definition.</p>
</div>
</section>
<section id="enabling-disabling-pushdown-in-a-session">
<h3>Enabling/Disabling Pushdown in a Session<a class="headerlink" href="#enabling-disabling-pushdown-in-a-session" title="Link to this heading">¶</a></h3>
<p>Version 2.1.0 (and higher) of the connector supports query pushdown, which can significantly improve performance by pushing query processing to Snowflake when Snowflake is the Spark data source.</p>
<p>By default, pushdown is enabled.</p>
<p>To disable pushdown within a Spark session for a given DataFrame:</p>
<ol class="arabic">
<li><p>After instantiating a <code class="code docutils literal notranslate"><span class="pre">SparkSession</span></code> object, call the <code class="code docutils literal notranslate"><span class="pre">SnowflakeConnectorUtils.disablePushdownSession</span></code> static
method, passing in the <code class="code docutils literal notranslate"><span class="pre">SparkSession</span></code> object. For example:</p>
<blockquote>
<div><div class="relative group text-sm"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="nc">SnowflakeConnectorUtils</span><span class="p">.</span><span class="n">disablePushdownSession</span><span class="p">(</span><span class="n">spark</span><span class="p">)</span>
</pre></div>
</div><div data-codeblock-index="2" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
</div></blockquote>
<p>Where <code class="code docutils literal notranslate"><span class="pre">spark</span></code> is your <code class="code docutils literal notranslate"><span class="pre">SparkSession</span></code> object.</p>
</li>
<li><p>Create a DataFrame with the <a class="reference internal" href="#label-spark-options-autopushdown"><span class="std std-ref">autopushdown</span></a> option set to <code class="code docutils literal notranslate"><span class="pre">off</span></code>. For example:</p>
<blockquote>
<div><div class="relative group text-sm"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sparkSession</span><span class="p">.</span><span class="n">read</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="nc">SNOWFLAKE_SOURCE_NAME</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="n">options</span><span class="p">(</span><span class="n">sfOptions</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">"query"</span><span class="p">,</span><span class="w"> </span><span class="n">query</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">"autopushdown"</span><span class="p">,</span><span class="w"> </span><span class="s">"off"</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="n">load</span><span class="p">()</span>
</pre></div>
</div><div data-codeblock-index="3" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
</div></blockquote>
<p>Note that you can also set the <code class="code docutils literal notranslate"><span class="pre">autopushdown</span></code> option in a <code class="code docutils literal notranslate"><span class="pre">Map</span></code> that you pass to the <code class="code docutils literal notranslate"><span class="pre">options</span></code> method (e.g.
in <code class="docutils literal notranslate"><span class="pre">sfOptions</span></code> in the example above).</p>
</li>
</ol>
<p>To enable pushdown again after disabling it, call the <code class="code docutils literal notranslate"><span class="pre">SnowflakeConnectorUtils.enablePushdownSession</span></code> static method
(passing in the <code class="code docutils literal notranslate"><span class="pre">SparkSession</span></code> object), and create a DataFrame with <code class="code docutils literal notranslate"><span class="pre">autopushdown</span></code> enabled.</p>
</section>
<section id="moving-data-from-snowflake-to-spark">
<h3>Moving Data from Snowflake to Spark<a class="headerlink" href="#moving-data-from-snowflake-to-spark" title="Link to this heading">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using DataFrames, the Snowflake connector supports SELECT queries only.</p>
</div>
<p>To read data from Snowflake into a Spark DataFrame:</p>
<ol class="arabic simple">
<li><p>Use the <code class="code docutils literal notranslate"><span class="pre">read()</span></code> method of the <code class="code docutils literal notranslate"><span class="pre">SqlContext</span></code> object to construct a <code class="code docutils literal notranslate"><span class="pre">DataFrameReader</span></code>.</p></li>
<li><p>Specify <code class="code docutils literal notranslate"><span class="pre">SNOWFLAKE_SOURCE_NAME</span></code> using the <code class="code docutils literal notranslate"><span class="pre">format()</span></code> method. For the definition, see <a class="reference internal" href="#label-spark-data-source"><span class="std std-ref">Specifying the Data Source Class Name</span></a> (in this topic).</p></li>
<li><p>Specify the connector options using either the <code class="code docutils literal notranslate"><span class="pre">option()</span></code> or <code class="code docutils literal notranslate"><span class="pre">options()</span></code> method. For more information, see <a class="reference internal" href="#label-spark-options"><span class="std std-ref">Setting Configuration Options for the Connector</span></a> (in this topic).</p></li>
<li><p>Specify one of the following options for the table data to be read:</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">dbtable</span></code>: The name of the table to be read. All columns and records are retrieved (i.e. it is equivalent to <code class="samp docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">*</span> <span class="pre">FROM</span> <em><span class="pre">db_table</span></em></code>).</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">query</span></code>: The exact query (SELECT statement) to run.</p></li>
</ul>
</li>
</ol>
<section id="usage-notes">
<h4>Usage Notes<a class="headerlink" href="#usage-notes" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>Currently, the connector does not support other types of queries (e.g. SHOW or DESC, or DML statements) when using DataFrames.</p></li>
<li><p>There is an upper limit to the size of an individual row. For more details, see <a class="reference internal" href="query-size-limits"><span class="doc">Limits on Query Text Size</span></a>.</p></li>
</ul>
</section>
<section id="performance-considerations">
<h4>Performance Considerations<a class="headerlink" href="#performance-considerations" title="Link to this heading">¶</a></h4>
<p>When transferring data between Snowflake and Spark, use the following methods to analyze/improve performance:</p>
<ul>
<li><p>Use the <code class="code docutils literal notranslate"><span class="pre">net.snowflake.spark.snowflake.Utils.getLastSelect()</span></code> method to see the actual query issued when moving data from Snowflake to Spark.</p></li>
<li><p>If you use the <code class="code docutils literal notranslate"><span class="pre">filter</span></code> or <code class="code docutils literal notranslate"><span class="pre">where</span></code> functionality of the Spark DataFrame, check that the respective filters are present in the issued SQL query. The Snowflake connector tries to translate all the
filters requested by Spark to SQL.</p>
<p>However, there are forms of filters that the Spark infrastructure today does not pass to the Snowflake connector. As a result, in some situations, a large number of unnecessary records are requested from
Snowflake.</p>
</li>
<li><p>If you need only a subset of columns, make sure the reflect the subset in the SQL query.</p></li>
<li><p>In general, if the SQL query issued does not match what you expect based on the DataFrame operations, use the <code class="code docutils literal notranslate"><span class="pre">query</span></code> option to provide the exact SQL syntax you want.</p></li>
</ul>
</section>
<section id="examples">
<h4>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h4>
<p>Read an entire table:</p>
<blockquote>
<div><div class="relative group text-sm"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="p">:</span><span class="w"> </span><span class="nc">DataFrame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqlContext</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="nc">SNOWFLAKE_SOURCE_NAME</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">options</span><span class="p">(</span><span class="n">sfOptions</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">"dbtable"</span><span class="p">,</span><span class="w"> </span><span class="s">"t1"</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">()</span>
</pre></div>
</div><div data-codeblock-index="4" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
</div></blockquote>
<p>Read the results of a query:</p>
<blockquote>
<div><div class="relative group text-sm"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="p">:</span><span class="w"> </span><span class="nc">DataFrame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqlContext</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="nc">SNOWFLAKE_SOURCE_NAME</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">options</span><span class="p">(</span><span class="n">sfOptions</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">"query"</span><span class="p">,</span><span class="w"> </span><span class="s">"SELECT DEPT, SUM(SALARY) AS SUM_SALARY FROM T1"</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">()</span>
</pre></div>
</div><div data-codeblock-index="5" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
</div></blockquote>
</section>
</section>
<section id="moving-data-from-spark-to-snowflake">
<h3>Moving Data from Spark to Snowflake<a class="headerlink" href="#moving-data-from-spark-to-snowflake" title="Link to this heading">¶</a></h3>
<p>The steps for saving the contents of a DataFrame to a Snowflake table are similar to writing from Snowflake to Spark:</p>
<ol class="arabic">
<li><p>Use the <code class="code docutils literal notranslate"><span class="pre">write()</span></code> method of the <code class="code docutils literal notranslate"><span class="pre">DataFrame</span></code> to construct a <code class="code docutils literal notranslate"><span class="pre">DataFrameWriter</span></code>.</p></li>
<li><p>Specify <code class="code docutils literal notranslate"><span class="pre">SNOWFLAKE_SOURCE_NAME</span></code> using the <code class="code docutils literal notranslate"><span class="pre">format()</span></code> method. For the definition, see <a class="reference internal" href="#label-spark-data-source"><span class="std std-ref">Specifying the Data Source Class Name</span></a> (in this topic).</p></li>
<li><p>Specify the connector options using either the <code class="code docutils literal notranslate"><span class="pre">option()</span></code> or <code class="code docutils literal notranslate"><span class="pre">options()</span></code> method. For more information, see <a class="reference internal" href="#label-spark-options"><span class="std std-ref">Setting Configuration Options for the Connector</span></a> (in this topic).</p></li>
<li><p>Use the <code class="code docutils literal notranslate"><span class="pre">dbtable</span></code> option to specify the table to which data is written.</p></li>
<li><p>Use the <code class="code docutils literal notranslate"><span class="pre">mode()</span></code> method to specify the save mode for the content.</p>
<p>For more information, see <a class="reference external" href="https://spark.apache.org/docs/1.6.0/api/java/org/apache/spark/sql/SaveMode.html">SaveMode</a> (Spark documentation).</p>
</li>
</ol>
<section id="id1">
<h4>Examples<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h4>
<blockquote>
<div><div class="relative group text-sm"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">write</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="nc">SNOWFLAKE_SOURCE_NAME</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">options</span><span class="p">(</span><span class="n">sfOptions</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">"dbtable"</span><span class="p">,</span><span class="w"> </span><span class="s">"t2"</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">mode</span><span class="p">(</span><span class="nc">SaveMode</span><span class="p">.</span><span class="nc">Overwrite</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div><div data-codeblock-index="6" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
</div></blockquote>
</section>
</section>
<section id="exporting-json-from-spark-to-snowflake">
<span id="label-spark-json"></span><h3>Exporting JSON from Spark to Snowflake<a class="headerlink" href="#exporting-json-from-spark-to-snowflake" title="Link to this heading">¶</a></h3>
<p>Spark DataFrames can contain JSON objects, serialized as strings. The following code provides an example of converting a regular DataFrame to a DataFrame containing JSON data:</p>
<blockquote>
<div><div class="relative group text-sm"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">rdd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">myDataFrame</span><span class="p">.</span><span class="n">toJSON</span>
<span class="kd">val</span><span class="w"> </span><span class="n">schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nc">StructType</span><span class="p">(</span><span class="nc">Array</span><span class="p">(</span><span class="nc">StructField</span><span class="p">(</span><span class="s">"JSON"</span><span class="p">,</span><span class="w"> </span><span class="nc">StringType</span><span class="p">)))</span>
<span class="kd">val</span><span class="w"> </span><span class="n">jsonDataFrame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqlContext</span><span class="p">.</span><span class="n">createDataFrame</span><span class="p">(</span>
<span class="w">            </span><span class="n">rdd</span><span class="p">.</span><span class="n">map</span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nc">Row</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span><span class="w"> </span><span class="n">schema</span><span class="p">)</span>
</pre></div>
</div><div data-codeblock-index="7" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
</div></blockquote>
<p>Note that the resulting <code class="code docutils literal notranslate"><span class="pre">jsonDataFrame</span></code> contains a single column of type <code class="code docutils literal notranslate"><span class="pre">StringType</span></code>. As a result, when this DataFrame is exported to Snowflake with the common <code class="code docutils literal notranslate"><span class="pre">SaveMode.Overwrite</span></code> mode, a new table in Snowflake is created with a single column of type <code class="code docutils literal notranslate"><span class="pre">VARCHAR</span></code>.</p>
<p>To load <code class="code docutils literal notranslate"><span class="pre">jsonDataFrame</span></code> into a <code class="code docutils literal notranslate"><span class="pre">VARIANT</span></code> column:</p>
<ol class="arabic">
<li><p>Create a Snowflake table (connecting to Snowflake in Java using the Snowflake JDBC Driver). For explanations of the
connection parameters used in the example, see <a class="reference internal" href="../developer-guide/jdbc/jdbc-parameters"><span class="doc">JDBC Driver connection parameter reference</span></a>.</p>
<blockquote>
<div><div class="relative group text-sm"><div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.Connection</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.DriverManager</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.ResultSet</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.ResultSetMetaData</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.SQLException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.Statement</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Properties</span><span class="p">;</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SnowflakeJDBCExample</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">jdbcUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"jdbc:snowflake://myorganization-myaccount.snowflakecomputing.com/"</span><span class="p">;</span>

<span class="w">    </span><span class="n">Properties</span><span class="w"> </span><span class="n">properties</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Properties</span><span class="p">();</span>
<span class="w">    </span><span class="n">properties</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">"user"</span><span class="p">,</span><span class="w"> </span><span class="s">"peter"</span><span class="p">);</span>
<span class="w">    </span><span class="n">properties</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">"password"</span><span class="p">,</span><span class="w"> </span><span class="s">"test"</span><span class="p">);</span>
<span class="w">    </span><span class="n">properties</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">"account"</span><span class="p">,</span><span class="w"> </span><span class="s">"myorganization-myaccount"</span><span class="p">);</span>
<span class="w">    </span><span class="n">properties</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">"warehouse"</span><span class="p">,</span><span class="w"> </span><span class="s">"mywh"</span><span class="p">);</span>
<span class="w">    </span><span class="n">properties</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">"db"</span><span class="p">,</span><span class="w"> </span><span class="s">"mydb"</span><span class="p">);</span>
<span class="w">    </span><span class="n">properties</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">"schema"</span><span class="p">,</span><span class="w"> </span><span class="s">"public"</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// get connection</span>
<span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Create JDBC connection"</span><span class="p">);</span>
<span class="w">    </span><span class="n">Connection</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DriverManager</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">jdbcUrl</span><span class="p">,</span><span class="w"> </span><span class="n">properties</span><span class="p">);</span>
<span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Done creating JDBC connection\n"</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// create statement</span>
<span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Create JDBC statement"</span><span class="p">);</span>
<span class="w">    </span><span class="n">Statement</span><span class="w"> </span><span class="n">statement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">connection</span><span class="p">.</span><span class="na">createStatement</span><span class="p">();</span>
<span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Done creating JDBC statement\n"</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// create a table</span>
<span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Create my_variant_table table"</span><span class="p">);</span>
<span class="w">    </span><span class="n">statement</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">(</span><span class="s">"create or replace table my_variant_table(json VARIANT)"</span><span class="p">);</span>
<span class="w">    </span><span class="n">statement</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
<span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Done creating demo table\n"</span><span class="p">);</span>

<span class="w">    </span><span class="n">connection</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
<span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"Close connection\n"</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div><div data-codeblock-index="8" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
</div></blockquote>
</li>
<li><p>Instead of using <code class="code docutils literal notranslate"><span class="pre">SaveMode.Overwrite</span></code>, use <code class="code docutils literal notranslate"><span class="pre">SaveMode.Append</span></code>, to reuse the existing table. When the string value representing JSON is loaded into Snowflake, because the target column is of type VARIANT, it is parsed as JSON. For example:</p>
<blockquote>
<div><div class="relative group text-sm"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">.</span><span class="n">write</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="nc">SNOWFLAKE_SOURCE_NAME</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">options</span><span class="p">(</span><span class="n">sfOptions</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">"dbtable"</span><span class="p">,</span><span class="w"> </span><span class="s">"my_variant_table"</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">mode</span><span class="p">(</span><span class="nc">SaveMode</span><span class="p">.</span><span class="nc">Append</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div><div data-codeblock-index="9" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
</div></blockquote>
</li>
</ol>
</section>
<section id="executing-ddl-dml-sql-statements">
<h3>Executing DDL/DML SQL Statements<a class="headerlink" href="#executing-ddl-dml-sql-statements" title="Link to this heading">¶</a></h3>
<p>Use the <code class="code docutils literal notranslate"><span class="pre">runQuery()</span></code> method of the <code class="code docutils literal notranslate"><span class="pre">Utils</span></code> object to execute DDL/DML SQL statements, in addition to queries, for example:</p>
<div class="relative group text-sm"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">sfOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Map</span><span class="p">(</span>
<span class="w">    </span><span class="s">"sfURL"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;account_identifier&gt;.snowflakecomputing.com"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"sfUser"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;user_name&gt;"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"sfPassword"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;password&gt;"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"sfDatabase"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;database&gt;"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"sfSchema"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;schema&gt;"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"sfWarehouse"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;warehouse&gt;"</span>
<span class="w">    </span><span class="p">)</span>
<span class="nc">Utils</span><span class="p">.</span><span class="n">runQuery</span><span class="p">(</span><span class="n">sfOptions</span><span class="p">,</span><span class="w"> </span><span class="s">"CREATE TABLE MY_TABLE(A INTEGER)"</span><span class="p">)</span>
</pre></div>
</div><div data-codeblock-index="10" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
<p>where <code class="code docutils literal notranslate"><span class="pre">sfOptions</span></code> is the parameters map used to read/write DataFrames.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">runQuery</span></code> method returns only TRUE or FALSE. It is intended for statements that do not return a result set,
for example DDL statements like <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span></code> and DML statements like <code class="docutils literal notranslate"><span class="pre">INSERT</span></code>, <code class="docutils literal notranslate"><span class="pre">UPDATE</span></code>, and <code class="docutils literal notranslate"><span class="pre">DELETE</span></code>.
It is not useful for statements that return a result set, such as <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> or <code class="docutils literal notranslate"><span class="pre">SHOW</span></code>.</p>
</section>
<section id="working-with-timestamps-and-time-zones">
<span id="label-spark-timestamps"></span><h3>Working with Timestamps and Time Zones<a class="headerlink" href="#working-with-timestamps-and-time-zones" title="Link to this heading">¶</a></h3>
<p>Spark provides only one type of timestamp, equivalent to the Scala/Java Timestamp type. It is almost identical in behavior to the TIMESTAMP_LTZ (local time zone) data type in Snowflake. As such, when transferring data between Spark and Snowflake, Snowflake recommends using the following approaches to preserve time correctly, relative to time zones:</p>
<ul>
<li><p>Use only the TIMESTAMP_LTZ data type in Snowflake.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The default timestamp data type mapping is TIMESTAMP_NTZ (no time zone), so you <span class="emph">must</span> explicitly set the <a class="reference internal" href="../sql-reference/parameters.html#label-timestamp-type-mapping"><span class="std std-ref">TIMESTAMP_TYPE_MAPPING</span></a> parameter to use TIMESTAMP_LTZ.</p>
</div>
</li>
<li><p>Set the Spark time zone to <code class="code docutils literal notranslate"><span class="pre">UTC</span></code> and use this time zone in Snowflake (i.e. don’t set the <code class="code docutils literal notranslate"><span class="pre">sfTimezone</span></code> option for the connector, and don’t explicitly set a time zone in Snowflake). In this scenario, TIMESTAMP_LTZ and TIMESTAMP_NTZ are effectively equivalent.</p>
<p>To set the time zone, add the following line to your Spark code:</p>
<div class="relative group text-sm"><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>java.util.TimeZone.setDefault<span class="o">(</span>java.util.TimeZone.getTimeZone<span class="o">(</span><span class="s2">"UTC"</span><span class="o">))</span>
</pre></div>
</div><div data-codeblock-index="11" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
</li>
</ul>
<p>If you don’t implement either of these approaches, undesired time modifications might occur. For example, consider the following scenario:</p>
<ul class="simple">
<li><p>The time zone in Spark is set to <code class="code docutils literal notranslate"><span class="pre">America/New_York</span></code>.</p></li>
<li><p>The time zone in Snowflake is set to <code class="code docutils literal notranslate"><span class="pre">Europe/Warsaw</span></code>, which can happen by either:</p>
<ul>
<li><p>Setting <code class="code docutils literal notranslate"><span class="pre">sfTimezone</span></code> to <code class="code docutils literal notranslate"><span class="pre">Europe/Warsaw</span></code> for the connector.</p></li>
<li><p>Setting <code class="code docutils literal notranslate"><span class="pre">sfTimezone</span></code> to <code class="code docutils literal notranslate"><span class="pre">snowflake</span></code> for the connector and setting the <a class="reference internal" href="../sql-reference/parameters.html#label-timezone"><span class="std std-ref">TIMEZONE</span></a> session
parameter in Snowflake to <code class="code docutils literal notranslate"><span class="pre">Europe/Warsaw</span></code>.</p></li>
</ul>
</li>
<li><p>Both TIMESTAMP_NTZ and TIMESTAMP_LTZ are in use in Snowflake.</p></li>
</ul>
<p>In this scenario:</p>
<ol class="arabic simple">
<li><p>If a value representing <code class="code docutils literal notranslate"><span class="pre">12:00:00</span></code> in a TIMESTAMP_NTZ column in Snowflake is sent to Spark, this value doesn’t carry any time zone information. Spark treats the value as <code class="code docutils literal notranslate"><span class="pre">12:00:00</span></code> in New York.</p></li>
<li><p>If Spark sends this value <code class="code docutils literal notranslate"><span class="pre">12:00:00</span></code> (in New York) back to Snowflake to be loaded into a TIMESTAMP_LTZ column, it is automatically converted and loaded as <code class="code docutils literal notranslate"><span class="pre">18:00:00</span></code> (for the Warsaw time zone).</p></li>
<li><p>If this value is then converted to TIMESTAMP_NTZ in Snowflake, the user sees <code class="code docutils literal notranslate"><span class="pre">18:00:00</span></code>, which is different from the original value, <code class="code docutils literal notranslate"><span class="pre">12:00:00</span></code>.</p></li>
</ol>
<p>To summarize, Snowflake recommends strictly following <span class="emph">at least</span> one of these rules:</p>
<ul class="simple">
<li><p>Use the <span class="emph">same</span> time zone, ideally <code class="code docutils literal notranslate"><span class="pre">UTC</span></code>, for both Spark and Snowflake.</p></li>
<li><p>Use <span class="emph">only</span> the TIMESTAMP_LTZ data type for transferring data between Spark and Snowflake.</p></li>
</ul>
</section>
<section id="sample-scala-program">
<span id="label-spark-sample"></span><h3>Sample Scala Program<a class="headerlink" href="#sample-scala-program" title="Link to this heading">¶</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This sample program assumes you are using version 2.2.0 (or higher) of the connector, which uses a Snowflake internal stage for storing temporary data and, therefore, does not require an S3 location for
storing temporary data. If you are using an earlier version, you must have an existing S3 location and include values for <code class="code docutils literal notranslate"><span class="pre">tempdir</span></code>, <code class="code docutils literal notranslate"><span class="pre">awsAccessKey</span></code>, <code class="code docutils literal notranslate"><span class="pre">awsSecretKey</span></code> for <code class="code docutils literal notranslate"><span class="pre">sfOptions</span></code>.
For more details, see <a class="reference internal" href="#label-s3-options"><span class="std std-ref">AWS Options for External Data Transfer</span></a> (in this topic).</p>
</div>
<p>The following Scala program provides a full use case for the Snowflake Connector for Spark. Before using the code, replace the following strings with the appropriate values, as described in
<a class="reference internal" href="#label-spark-options"><span class="std std-ref">Setting Configuration Options for the Connector</span></a> (in this topic):</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">&lt;account_identifier&gt;</span></code>: Your <a class="reference internal" href="admin-account-identifier"><span class="doc">account identifier</span></a>.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">&lt;user_name&gt;</span></code> , <code class="code docutils literal notranslate"><span class="pre">&lt;password&gt;</span></code>: Login credentials for the Snowflake user.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">&lt;database&gt;</span></code> , <code class="code docutils literal notranslate"><span class="pre">&lt;schema&gt;</span></code> , <code class="code docutils literal notranslate"><span class="pre">&lt;warehouse&gt;</span></code>: Defaults for the Snowflake session.</p></li>
</ul>
<p>The sample Scala program uses basic authentication (i.e. username and password). If you wish to authenticate with OAuth, see <a class="reference internal" href="#using-external-oauth">Using External OAuth</a> (in this topic).</p>
<div class="relative group text-sm"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">apache</span><span class="p">.</span><span class="nn">spark</span><span class="p">.</span><span class="nn">sql</span><span class="p">.</span><span class="n">_</span>

<span class="c1">//</span>
<span class="c1">// Configure your Snowflake environment</span>
<span class="c1">//</span>
<span class="kd">var</span><span class="w"> </span><span class="n">sfOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Map</span><span class="p">(</span>
<span class="w">    </span><span class="s">"sfURL"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;account_identifier&gt;.snowflakecomputing.com"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"sfUser"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;user_name&gt;"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"sfPassword"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;password&gt;"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"sfDatabase"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;database&gt;"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"sfSchema"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;schema&gt;"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"sfWarehouse"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;warehouse&gt;"</span>
<span class="p">)</span>

<span class="c1">//</span>
<span class="c1">// Create a DataFrame from a Snowflake table</span>
<span class="c1">//</span>
<span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="p">:</span><span class="w"> </span><span class="nc">DataFrame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqlContext</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="nc">SNOWFLAKE_SOURCE_NAME</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">options</span><span class="p">(</span><span class="n">sfOptions</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">"dbtable"</span><span class="p">,</span><span class="w"> </span><span class="s">"t1"</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">()</span>

<span class="c1">//</span>
<span class="c1">// DataFrames can also be populated via a SQL query</span>
<span class="c1">//</span>
<span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="p">:</span><span class="w"> </span><span class="nc">DataFrame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqlContext</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="nc">SNOWFLAKE_SOURCE_NAME</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">options</span><span class="p">(</span><span class="n">sfOptions</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">"query"</span><span class="p">,</span><span class="w"> </span><span class="s">"select c1, count(*) from t1 group by c1"</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">()</span>

<span class="c1">//</span>
<span class="c1">// Join, augment, aggregate, etc. the data in Spark and then use the</span>
<span class="c1">// Data Source API to write the data back to a table in Snowflake</span>
<span class="c1">//</span>
<span class="n">df</span><span class="p">.</span><span class="n">write</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="nc">SNOWFLAKE_SOURCE_NAME</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">options</span><span class="p">(</span><span class="n">sfOptions</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">"dbtable"</span><span class="p">,</span><span class="w"> </span><span class="s">"t2"</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">mode</span><span class="p">(</span><span class="nc">SaveMode</span><span class="p">.</span><span class="nc">Overwrite</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div><div data-codeblock-index="12" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
</section>
</section>
<section id="using-the-connector-with-python">
<h2>Using the Connector with Python<a class="headerlink" href="#using-the-connector-with-python" title="Link to this heading">¶</a></h2>
<p>Using the connector with Python is very similar to the Scala usage.</p>
<p>We recommend using the <code class="code docutils literal notranslate"><span class="pre">bin/pyspark</span></code> script included in the Spark distribution.</p>
<section id="configuring-the-pyspark-script">
<h3>Configuring the <code class="code docutils literal notranslate"><span class="pre">pyspark</span></code> Script<a class="headerlink" href="#configuring-the-pyspark-script" title="Link to this heading">¶</a></h3>
<p>The <code class="code docutils literal notranslate"><span class="pre">pyspark</span></code> script must be configured similarly to the <code class="code docutils literal notranslate"><span class="pre">spark-shell</span></code> script, using the <code class="code docutils literal notranslate"><span class="pre">--packages</span></code> or <code class="code docutils literal notranslate"><span class="pre">--jars</span></code> options. For example:</p>
<blockquote>
<div><div class="relative group text-sm"><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>bin/pyspark<span class="w"> </span>--packages<span class="w"> </span>net.snowflake:snowflake-jdbc:3.13.22,net.snowflake:spark-snowflake_2.12:2.11.0-spark_3.3
</pre></div>
</div><div data-codeblock-index="13" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
</div></blockquote>
<p>Don’t forget to include the Snowflake Spark Connector and JDBC Connector .jar
files in your CLASSPATH environment variable.</p>
<p>For more information about configuring the <code class="code docutils literal notranslate"><span class="pre">spark-shell</span></code> script, see <a class="reference internal" href="spark-connector-install.html#label-spark-cluster-setup"><span class="std std-ref">Step 4: Configure the Local Spark Cluster or Amazon EMR-hosted Spark Environment</span></a>.</p>
</section>
<section id="id2">
<h3>Enabling/Disabling Pushdown in a Session<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<p>Version 2.1.0 (and higher) of the connector supports query pushdown, which can significantly improve performance by pushing query processing to Snowflake when Snowflake is the Spark data source.</p>
<p>By default, pushdown is enabled.</p>
<p>To disable pushdown within a Spark session for a given DataFrame:</p>
<ol class="arabic">
<li><p>After instantiating a <code class="code docutils literal notranslate"><span class="pre">SparkSession</span></code> object, call the <code class="code docutils literal notranslate"><span class="pre">SnowflakeConnectorUtils.disablePushdownSession</span></code> static
method, passing in the <code class="code docutils literal notranslate"><span class="pre">SparkSession</span></code> object. For example:</p>
<blockquote>
<div><div class="relative group text-sm"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span><span class="o">.</span><span class="n">_jvm</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">snowflake</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">snowflake</span><span class="o">.</span><span class="n">SnowflakeConnectorUtils</span><span class="o">.</span><span class="n">disablePushdownSession</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">_jvm</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="p">()</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">())</span>
</pre></div>
</div><div data-codeblock-index="14" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
</div></blockquote>
</li>
<li><p>Create a DataFrame with the <a class="reference internal" href="#label-spark-options-autopushdown"><span class="std std-ref">autopushdown</span></a> option set to <code class="code docutils literal notranslate"><span class="pre">off</span></code>. For example:</p>
<blockquote>
<div><div class="relative group text-sm"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">SNOWFLAKE_SOURCE_NAME</span><span class="p">)</span> \
  <span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">sfOptions</span><span class="p">)</span> \
  <span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"query"</span><span class="p">,</span>  <span class="n">query</span><span class="p">)</span> \
  <span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"autopushdown"</span><span class="p">,</span> <span class="s2">"off"</span><span class="p">)</span> \
  <span class="o">.</span><span class="n">load</span><span class="p">()</span>
</pre></div>
</div><div data-codeblock-index="15" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
</div></blockquote>
<p>Note that you can also set the <code class="code docutils literal notranslate"><span class="pre">autopushdown</span></code> option in a <code class="code docutils literal notranslate"><span class="pre">Dictionary</span></code> that you pass to the <code class="code docutils literal notranslate"><span class="pre">options</span></code> method
(e.g.  in <code class="docutils literal notranslate"><span class="pre">sfOptions</span></code> in the example above).</p>
</li>
</ol>
<p>To enable pushdown again after disabling it, call the <code class="code docutils literal notranslate"><span class="pre">SnowflakeConnectorUtils.enablePushdownSession</span></code> static method
(passing in the <code class="code docutils literal notranslate"><span class="pre">SparkSession</span></code> object), and create a DataFrame with <code class="code docutils literal notranslate"><span class="pre">autopushdown</span></code> enabled.</p>
</section>
<section id="sample-python-script">
<h3>Sample Python Script<a class="headerlink" href="#sample-python-script" title="Link to this heading">¶</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This sample script assumes you are using version 2.2.0 (or higher) of the connector, which uses a Snowflake internal stage for storing temporary data and, therefore, does not require an S3 location for
storing this data. If you are using an earlier version, you must have an existing S3 location and include values for <code class="code docutils literal notranslate"><span class="pre">tempdir</span></code>, <code class="code docutils literal notranslate"><span class="pre">awsAccessKey</span></code>, <code class="code docutils literal notranslate"><span class="pre">awsSecretKey</span></code> for <code class="code docutils literal notranslate"><span class="pre">sfOptions</span></code>. For more
details, see <a class="reference internal" href="#label-s3-options"><span class="std std-ref">AWS Options for External Data Transfer</span></a> (in this topic).</p>
</div>
<p>Once the <code class="code docutils literal notranslate"><span class="pre">pyspark</span></code> script has been configured, you can perform SQL queries and other operations. Here’s an example Python script that performs a simple SQL query. This script illustrates basic connector
usage. Most of the Scala examples in this document can be adapted with minimal effort/changes for use with Python.</p>
<p>The sample Python script uses basic authentication (i.e. username and password). If you wish to authenticate with OAuth, see <a class="reference internal" href="#using-external-oauth">Using External OAuth</a> (in this topic).</p>
<div class="relative group text-sm"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark</span> <span class="kn">import</span> <span class="n">SparkConf</span><span class="p">,</span> <span class="n">SparkContext</span>
<span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">SQLContext</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.types</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pyspark</span> <span class="kn">import</span> <span class="n">SparkConf</span><span class="p">,</span> <span class="n">SparkContext</span>

<span class="n">sc</span> <span class="o">=</span> <span class="n">SparkContext</span><span class="p">(</span><span class="s2">"local"</span><span class="p">,</span> <span class="s2">"Simple App"</span><span class="p">)</span>
<span class="n">spark</span> <span class="o">=</span> <span class="n">SQLContext</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
<span class="n">spark_conf</span> <span class="o">=</span> <span class="n">SparkConf</span><span class="p">()</span><span class="o">.</span><span class="n">setMaster</span><span class="p">(</span><span class="s1">'local'</span><span class="p">)</span><span class="o">.</span><span class="n">setAppName</span><span class="p">(</span><span class="s1">'&lt;APP_NAME&gt;'</span><span class="p">)</span>

<span class="c1"># You might need to set these</span>
<span class="n">sc</span><span class="o">.</span><span class="n">_jsc</span><span class="o">.</span><span class="n">hadoopConfiguration</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">"fs.s3n.awsAccessKeyId"</span><span class="p">,</span> <span class="s2">"&lt;AWS_KEY&gt;"</span><span class="p">)</span>
<span class="n">sc</span><span class="o">.</span><span class="n">_jsc</span><span class="o">.</span><span class="n">hadoopConfiguration</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">"fs.s3n.awsSecretAccessKey"</span><span class="p">,</span> <span class="s2">"&lt;AWS_SECRET&gt;"</span><span class="p">)</span>

<span class="c1"># Set options below</span>
<span class="n">sfOptions</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">"sfURL"</span> <span class="p">:</span> <span class="s2">"&lt;account_identifier&gt;.snowflakecomputing.com"</span><span class="p">,</span>
  <span class="s2">"sfUser"</span> <span class="p">:</span> <span class="s2">"&lt;user_name&gt;"</span><span class="p">,</span>
  <span class="s2">"sfPassword"</span> <span class="p">:</span> <span class="s2">"&lt;password&gt;"</span><span class="p">,</span>
  <span class="s2">"sfDatabase"</span> <span class="p">:</span> <span class="s2">"&lt;database&gt;"</span><span class="p">,</span>
  <span class="s2">"sfSchema"</span> <span class="p">:</span> <span class="s2">"&lt;schema&gt;"</span><span class="p">,</span>
  <span class="s2">"sfWarehouse"</span> <span class="p">:</span> <span class="s2">"&lt;warehouse&gt;"</span>
<span class="p">}</span>

<span class="n">SNOWFLAKE_SOURCE_NAME</span> <span class="o">=</span> <span class="s2">"net.snowflake.spark.snowflake"</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">SNOWFLAKE_SOURCE_NAME</span><span class="p">)</span> \
  <span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">sfOptions</span><span class="p">)</span> \
  <span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"query"</span><span class="p">,</span>  <span class="s2">"select 1 as my_num union all select 2 as my_num"</span><span class="p">)</span> \
  <span class="o">.</span><span class="n">load</span><span class="p">()</span>

<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div><div data-codeblock-index="16" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Note the usage of <code class="code docutils literal notranslate"><span class="pre">sfOptions</span></code> and <code class="code docutils literal notranslate"><span class="pre">SNOWFLAKE_SOURCE_NAME</span></code>. This simplifies the code and reduces the chance of errors.</p>
<p>For details about the supported options for <code class="code docutils literal notranslate"><span class="pre">sfOptions</span></code>, see <a class="reference internal" href="#label-spark-options"><span class="std std-ref">Setting Configuration Options for the Connector</span></a> (in this topic).</p>
</div>
</section>
</section>
<section id="data-type-mappings">
<span id="label-spark-data-type-mappings"></span><h2>Data Type Mappings<a class="headerlink" href="#data-type-mappings" title="Link to this heading">¶</a></h2>
<p>The Spark Connector supports converting between many common data types.</p>
<section id="from-spark-sql-to-snowflake">
<h3>From Spark SQL to Snowflake<a class="headerlink" href="#from-spark-sql-to-snowflake" title="Link to this heading">¶</a></h3>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 30.0%">
<col style="width: 70.0%">
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Spark&nbsp;Data&nbsp;Type</p></th>
<th class="head"><p>Snowflake&nbsp;Data&nbsp;Type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">ArrayType</span></code></p></td>
<td><p>VARIANT</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">BinaryType</span></code></p></td>
<td><p>Not supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">BooleanType</span></code></p></td>
<td><p>BOOLEAN</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">ByteType</span></code></p></td>
<td><p>INTEGER. Snowflake does not support the BYTE type.</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">DateType</span></code></p></td>
<td><p>DATE</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">DecimalType</span></code></p></td>
<td><p>DECIMAL</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">DoubleType</span></code></p></td>
<td><p>DOUBLE</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">FloatType</span></code></p></td>
<td><p>FLOAT</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">IntegerType</span></code></p></td>
<td><p>INTEGER</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">LongType</span></code></p></td>
<td><p>INTEGER</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">MapType</span></code></p></td>
<td><p>VARIANT</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">ShortType</span></code></p></td>
<td><p>INTEGER</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">StringType</span></code></p></td>
<td><p>If length is specified, VARCHAR(N); otherwise, VARCHAR</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">StructType</span></code></p></td>
<td><p>VARIANT</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">TimestampType</span></code></p></td>
<td><p>TIMESTAMP</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</section>
<section id="from-snowflake-to-spark-sql">
<h3>From Snowflake to Spark SQL<a class="headerlink" href="#from-snowflake-to-spark-sql" title="Link to this heading">¶</a></h3>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 30.0%">
<col style="width: 70.0%">
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Snowflake&nbsp;Data&nbsp;Type</p></th>
<th class="head"><p>Spark&nbsp;Data&nbsp;Type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ARRAY</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">StringType</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>BIGINT</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">DecimalType(38,</span> <span class="pre">0)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>BINARY</p></td>
<td><p>Not supported</p></td>
</tr>
<tr class="row-odd"><td><p>BLOB</p></td>
<td><p>Not supported</p></td>
</tr>
<tr class="row-even"><td><p>BOOLEAN</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">BooleanType</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>CHAR</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">StringType</span></code></p></td>
</tr>
<tr class="row-even"><td><p>CLOB</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">StringType</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>DATE</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">DateType</span></code></p></td>
</tr>
<tr class="row-even"><td><p>DECIMAL</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">DecimalType</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>DOUBLE</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">DoubleType</span></code></p></td>
</tr>
<tr class="row-even"><td><p>FLOAT</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">DoubleType</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>INTEGER</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">DecimalType(38,</span> <span class="pre">0)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>OBJECT</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">StringType</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>TIMESTAMP</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">TimestampType</span></code></p></td>
</tr>
<tr class="row-even"><td><p>TIME</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">StringType</span></code> (Spark Connector Version 2.4.14 or later)</p></td>
</tr>
<tr class="row-odd"><td><p>VARIANT</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">StringType</span></code></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</section>
</section>
<section id="calling-the-dataframe-show-method">
<span id="label-spark-dataframe-show"></span><h2>Calling the DataFrame.show Method<a class="headerlink" href="#calling-the-dataframe-show-method" title="Link to this heading">¶</a></h2>
<p>If you are calling the <code class="code docutils literal notranslate"><span class="pre">DataFrame.show</span></code> method and passing in a number that is less than the number of rows in the
DataFrame, construct a DataFrame that just contains the rows to show in a sorted order.</p>
<p>To do this:</p>
<ol class="arabic simple">
<li><p>Call the <code class="code docutils literal notranslate"><span class="pre">sort</span></code> method first to return a DataFrame that contains sorted rows.</p></li>
<li><p>Call the <code class="code docutils literal notranslate"><span class="pre">limit</span></code> method on that DataFrame to return a DataFrame that just contains the rows that you want to show.</p></li>
<li><p>Call the <code class="code docutils literal notranslate"><span class="pre">show</span></code> method on the returned DataFrame.</p></li>
</ol>
<p>For example, if you want to show 5 rows and want the results sorted by the column <code class="docutils literal notranslate"><span class="pre">my_col</span></code>:</p>
<blockquote>
<div><div class="relative group text-sm"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">dfWithRowsToShow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">originalDf</span><span class="p">.</span><span class="n">sort</span><span class="p">(</span><span class="s">"my_col"</span><span class="p">).</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">dfWithRowsToShow</span><span class="p">.</span><span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div><div data-codeblock-index="17" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
</div></blockquote>
<p>Otherwise, if you call <code class="code docutils literal notranslate"><span class="pre">show</span></code> to display a subset of rows in the DataFrame, different executions of the code might result in
different rows being shown.</p>
</section>
<section id="setting-configuration-options-for-the-connector">
<span id="label-spark-options"></span><h2>Setting Configuration Options for the Connector<a class="headerlink" href="#setting-configuration-options-for-the-connector" title="Link to this heading">¶</a></h2>
<p>The following sections list the options that you set to configure the behavior of the connector:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#label-spark-options-required-section"><span class="std std-ref">Required Connection Options</span></a></p></li>
<li><p><a class="reference internal" href="#label-spark-options-required-context-section"><span class="std std-ref">Required Context Options</span></a></p></li>
<li><p><a class="reference internal" href="#label-spark-options-additional-context-section"><span class="std std-ref">Additional Context Options</span></a></p></li>
<li><p><a class="reference internal" href="#label-spark-options-proxy-section"><span class="std std-ref">Proxy Options</span></a></p></li>
<li><p><a class="reference internal" href="#label-spark-options-additional-section"><span class="std std-ref">Additional Options</span></a></p></li>
</ul>
<p>To set these options, call the <code class="code docutils literal notranslate"><span class="pre">.option(&lt;key&gt;,</span> <span class="pre">&lt;value&gt;)</span></code> or <code class="code docutils literal notranslate"><span class="pre">.options(&lt;map&gt;)</span></code> method of the
<a class="reference external" href="https://spark.apache.org/docs/1.6.0/api/java/org/apache/spark/sql/DataFrameReader.html">Spark DataframeReader</a> class.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To facilitate using the options, Snowflake recommends specifying the options in a single <code class="code docutils literal notranslate"><span class="pre">Map</span></code> object and calling
<code class="code docutils literal notranslate"><span class="pre">.options(&lt;map&gt;)</span></code> to set the options.</p>
</div>
<section id="required-connection-options">
<span id="label-spark-options-required-section"></span><h3>Required Connection Options<a class="headerlink" href="#required-connection-options" title="Link to this heading">¶</a></h3>
<p>The following options are required for connecting to Snowflake:</p>
<dl>
<dt><code class="code docutils literal notranslate"><span class="pre">sfUrl</span></code></dt><dd><p>Specifies the <em>hostname</em> for your account in the following format:</p>
<p><code class="samp docutils literal notranslate"><em><span class="pre">account_identifier</span></em><span class="pre">.snowflakecomputing.com</span></code></p>
<p><code class="samp docutils literal notranslate"><em><span class="pre">account_identifier</span></em></code> is your <a class="reference internal" href="admin-account-identifier"><span class="doc">account identifier</span></a>.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">sfUser</span></code></dt><dd><p>Login name for the Snowflake user.</p>
</dd>
</dl>
<p>You must also use one of the following options to authenticate:</p>
<ul>
<li><p><code class="code docutils literal notranslate"><span class="pre">sfPassword</span></code></p>
<p>Password for the Snowflake user.</p>
</li>
<li><p><code class="code docutils literal notranslate"><span class="pre">pem_private_key</span></code></p>
<p>Private key (in PEM format) for key pair authentication. For instructions, see <a class="reference internal" href="key-pair-auth"><span class="doc">Key-pair authentication and key-pair rotation</span></a>.</p>
</li>
<li><p><code class="code docutils literal notranslate"><span class="pre">sfAuthenticator</span></code></p>
<p>Specifies using <a class="reference internal" href="oauth-ext-overview"><span class="doc">External OAuth</span></a> to authenticate to Snowflake. Set the value to <code class="code docutils literal notranslate"><span class="pre">oauth</span></code>.</p>
<p>Using External OAuth requires setting the <code class="code docutils literal notranslate"><span class="pre">sfToken</span></code> parameter.</p>
</li>
</ul>
<dl>
<dt><code class="code docutils literal notranslate"><span class="pre">sfToken</span></code></dt><dd><p>(Required if using External OAuth) Set the value to your External OAuth access token.</p>
<p>This connection parameter requires setting the <code class="code docutils literal notranslate"><span class="pre">sfAuthenticator</span></code> parameter value to <code class="code docutils literal notranslate"><span class="pre">oauth</span></code>.</p>
<p>Default is none.</p>
</dd>
</dl>
</section>
<section id="required-context-options">
<span id="label-spark-options-required-context-section"></span><h3>Required Context Options<a class="headerlink" href="#required-context-options" title="Link to this heading">¶</a></h3>
<p>The following options are required for setting the database and schema context for the session:</p>
<dl class="simple">
<dt><code class="code docutils literal notranslate"><span class="pre">sfDatabase</span></code></dt><dd><p>The database to use for the session after connecting.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">sfSchema</span></code></dt><dd><p>The schema to use for the session after connecting.</p>
</dd>
</dl>
</section>
<section id="additional-context-options">
<span id="label-spark-options-additional-context-section"></span><h3>Additional Context Options<a class="headerlink" href="#additional-context-options" title="Link to this heading">¶</a></h3>
<p>The options listed in this section are not required.</p>
<dl class="simple">
<dt><code class="code docutils literal notranslate"><span class="pre">sfAccount</span></code></dt><dd><p>Account identifier (e.g. <code class="code docutils literal notranslate"><span class="pre">myorganization-myaccount</span></code>). This option is no longer required because the account identifier is specified in <code class="code docutils literal notranslate"><span class="pre">sfUrl</span></code>. It is documented here only for backward compatibility.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">sfWarehouse</span></code></dt><dd><p>The default virtual warehouse to use for the session after connecting.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">sfRole</span></code></dt><dd><p>The default security role to use for the session after connecting.</p>
</dd>
</dl>
</section>
<section id="proxy-options">
<span id="label-spark-options-proxy-section"></span><h3>Proxy Options<a class="headerlink" href="#proxy-options" title="Link to this heading">¶</a></h3>
<p>The options listed in this section are not required.</p>
<dl>
<dt><code class="code docutils literal notranslate"><span class="pre">use_proxy</span></code></dt><dd><p>Specifies whether the connector should use a proxy:</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">true</span></code> specifies that the connector should use a proxy.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">false</span></code> specifies that the connector should not use a proxy.</p></li>
</ul>
<p>The default value is <code class="code docutils literal notranslate"><span class="pre">false</span></code>.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">proxy_host</span></code></dt><dd><p>(Required if <code class="code docutils literal notranslate"><span class="pre">use_proxy</span></code> is <code class="code docutils literal notranslate"><span class="pre">true</span></code>) Specifies the hostname of the proxy server to use.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">proxy_port</span></code></dt><dd><p>(Required if <code class="code docutils literal notranslate"><span class="pre">use_proxy</span></code> is <code class="code docutils literal notranslate"><span class="pre">true</span></code>) Specifies the port number of the proxy server to use.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">proxy_protocol</span></code></dt><dd><p>Specifies the protocol used to connect to the proxy server. You can specify one of the following values:</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">http</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">https</span></code></p></li>
</ul>
<p>The default value is <code class="code docutils literal notranslate"><span class="pre">http</span></code>.</p>
<p>This is only supported for Snowflake on AWS.</p>
<p>This option was added in version 2.11.1 of the Spark Connector.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">proxy_user</span></code></dt><dd><p>Specifies the user name for authenticating to the proxy server. Set this if the proxy server requires authentication.</p>
<p>This is only supported for Snowflake on AWS.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">proxy_password</span></code></dt><dd><p>Specifies the password of <code class="code docutils literal notranslate"><span class="pre">proxy_user</span></code> for authenticating to the proxy server. Set this if the proxy server requires
authentication.</p>
<p>This is only supported for Snowflake on AWS.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">non_proxy_hosts</span></code></dt><dd><p>Specifies the list of hosts that the connector should connect to directly, bypassing the proxy server.</p>
<p>Separate the hostnames with a URL-escaped pipe symbol (<code class="docutils literal notranslate"><span class="pre">%7C</span></code>). You can also use an asterisk (<code class="docutils literal notranslate"><span class="pre">*</span></code>) as a wildcard</p>
<p>This is only supported for Snowflake on AWS.</p>
</dd>
</dl>
</section>
<section id="additional-options">
<span id="label-spark-options-additional-section"></span><h3>Additional Options<a class="headerlink" href="#additional-options" title="Link to this heading">¶</a></h3>
<p>The options listed in this section are not required.</p>
<dl>
<dt><code class="code docutils literal notranslate"><span class="pre">sfTimezone</span></code></dt><dd><p>The time zone to be used by Snowflake when working with Spark. Note that the parameter only sets the time zone in Snowflake; the Spark environment remains unmodified. The supported values are:</p>
<ul>
<li><p><code class="code docutils literal notranslate"><span class="pre">spark</span></code>: Use the time zone from Spark (default).</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">snowflake</span></code>: Use the current time zone for Snowflake.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">sf_default</span></code>: Use the default time zone for the Snowflake user who is connecting.</p></li>
<li><p><code class="samp docutils literal notranslate"><em><span class="pre">time_zone</span></em></code>: Use a specific time zone (e.g. <code class="code docutils literal notranslate"><span class="pre">America/New_York</span></code>), if valid.</p>
<p>For more information about the impact of setting this option, see <a class="reference internal" href="#label-spark-timestamps"><span class="std std-ref">Working with Timestamps and Time Zones</span></a> (in this topic).</p>
</li>
</ul>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">sfCompress</span></code></dt><dd><p>If set to <code class="code docutils literal notranslate"><span class="pre">on</span></code> (default), the data passed between Snowflake and Spark is compressed.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">s3MaxFileSize</span></code></dt><dd><p>The size of the file used when moving data from Snowflake to Spark. The default is 10MB.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">preactions</span></code></dt><dd><p>A semicolon-separated list of SQL commands that are executed before data is transferred between Spark and Snowflake.</p>
<p>If a SQL command contains <code class="code docutils literal notranslate"><span class="pre">%s</span></code>, the <code class="code docutils literal notranslate"><span class="pre">%s</span></code> is replaced with the table name referenced for the operation.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">postactions</span></code></dt><dd><p>A semicolon-separated list of SQL commands that are executed after data is transferred between Spark and Snowflake.</p>
<p>If a SQL command contains <code class="code docutils literal notranslate"><span class="pre">%s</span></code>, it is replaced with the table name referenced for the operation.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">truncate_columns</span></code></dt><dd><p>If set to <code class="code docutils literal notranslate"><span class="pre">on</span></code> (default), a COPY command automatically truncates text strings that exceed the target column length. If set to <code class="code docutils literal notranslate"><span class="pre">off</span></code>, the command produces an error if a loaded string exceeds the target column length.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">truncate_table</span></code></dt><dd><p>This parameter controls whether Snowflake retains the schema of a Snowflake
target table when overwriting that table.</p>
<p>By default, when a target table in Snowflake is overwritten, the schema of
that target table is also overwritten; the new schema is based on the schema
of the source table (the Spark dataframe).</p>
<p>However, sometimes the schema of the source is not ideal. For example,
a user might want a Snowflake target table to be able to store FLOAT
values in the future even though the data type of the initial source column
is INTEGER. In that case, the Snowflake table’s schema should not be
overwritten; the Snowflake table should merely be truncated and then
reused with its current schema.</p>
<p>The possible values of this parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">on</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">off</span></code></p></li>
</ul>
<p>If this parameter is <code class="docutils literal notranslate"><span class="pre">on</span></code>, the original schema of the target table is kept.
If this parameter is <code class="docutils literal notranslate"><span class="pre">off</span></code>, then the old schema of the table is ignored,
and a new schema is generated based on the schema of the source.</p>
<p>This parameter is optional.</p>
<p>The default value of this parameter is <code class="docutils literal notranslate"><span class="pre">off</span></code> (i.e. by default
the original table schema is overwritten).</p>
<p>For details about mapping Spark data types to Snowflake data types (and
vice versa), see: <a class="reference internal" href="#label-spark-data-type-mappings"><span class="std std-ref">Data Type Mappings</span></a> (in this topic).</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">continue_on_error</span></code></dt><dd><p>This variable controls whether the COPY command aborts if the user enters
invalid data (for example, invalid JSON format for a variant data type column).</p>
<p>The possible values are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">on</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">off</span></code></p></li>
</ul>
<p>The value <code class="docutils literal notranslate"><span class="pre">on</span></code> means continue even if an error occurs. The value <code class="docutils literal notranslate"><span class="pre">off</span></code>
means abort if an error is hit.</p>
<p>This parameter is optional.</p>
<p>The default value of this parameter is <code class="docutils literal notranslate"><span class="pre">off</span></code>.</p>
<p>Turning this option on is not recommended. If any errors are reported
while COPYing into Snowflake with the Spark connector, then this is likely
to result in missing data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If rows are rejected or missing, and those rows are not clearly faulty
in the input source, please report it to Snowflake.</p>
</div>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">usestagingtable</span></code></dt><dd><p>This parameter controls whether data loading uses a staging table.</p>
<p>A staging table is a normal table (with a temporary name) that is created
by the connector; if the data loading operation is successful, the original
target table is dropped and the staging table is renamed to the original
target table’s name. If the data loading operation fails, the staging table
is dropped and the target table is left with the data that it had
immediately prior to the operation. Thus the staging table allows the original
target table data to be retained if the operation fails. For safety, Snowflake
strongly recommends using a staging table in most circumstances.</p>
<p>In order for the connector to create a staging table, the user executing the
COPY via the Spark connector must have sufficient privileges to
create a table. Direct loading (i.e. loading without using a staging table)
is useful if the user does not have permission to create a table.</p>
<p>The possible values of this parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">on</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">off</span></code></p></li>
</ul>
<p>If the parameter is <code class="docutils literal notranslate"><span class="pre">on</span></code>, a staging table is used. If this parameter
is <code class="docutils literal notranslate"><span class="pre">off</span></code>, then the data is loaded directly into the target table.</p>
<p>This parameter is optional.</p>
<p>The default value of this parameter is <code class="docutils literal notranslate"><span class="pre">on</span></code> (i.e. use a staging table).</p>
</dd>
</dl>
<dl id="label-spark-options-autopushdown">
<dt><code class="code docutils literal notranslate"><span class="pre">autopushdown</span></code></dt><dd><p>This parameter controls whether automatic query pushdown is enabled.</p>
<p>If pushdown is enabled, then when a query is run on Spark, if part of the
query can be “pushed down” to the Snowflake server, it is pushed down.
This improves performance of some queries.</p>
<p>This parameter is optional.</p>
<p>The default value is <code class="docutils literal notranslate"><span class="pre">on</span></code> if the connector is plugged into a compatible
version of Spark. Otherwise, the default value is <code class="docutils literal notranslate"><span class="pre">off</span></code>.</p>
<p>If the connector is plugged into a different version of Spark than the
connector is intended for (e.g. if version 3.2 of the connector is
plugged into version 3.3 of Spark), then auto-pushdown is disabled
even if this parameter is set to <code class="docutils literal notranslate"><span class="pre">on</span></code>.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">purge</span></code></dt><dd><p>If this is set to <code class="docutils literal notranslate"><span class="pre">on</span></code>, then the connector deletes temporary files created
when transferring from Spark to Snowflake via external data transfer.
If this parameter is set to <code class="docutils literal notranslate"><span class="pre">off</span></code>, then those files are not automatically
deleted by the connector.</p>
<p>Purging works only for transfers from Spark to Snowflake, not for transfers
from Snowflake to Spark.</p>
<p>The possible values are</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">on</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">off</span></code></p></li>
</ul>
<p>The default value is <code class="docutils literal notranslate"><span class="pre">off</span></code>.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">columnmap</span></code></dt><dd><p>This parameter is useful when writing data from Spark to Snowflake
and the column names in the Snowflake table do not match the column names
in the Spark table. You can create a map that indicates which Spark
source column corresponds to each Snowflake destination column.</p>
<p>The parameter is a single string literal, in the form of:</p>
<blockquote>
<div><p><code class="code docutils literal notranslate"><span class="pre">"Map(col_2</span> <span class="pre">-&gt;</span> <span class="pre">col_b,</span> <span class="pre">col_3</span> <span class="pre">-&gt;</span> <span class="pre">col_a)"</span></code></p>
</div></blockquote>
<p>For example, consider the following scenario:</p>
<ul>
<li><p>A Dataframe named <code class="docutils literal notranslate"><span class="pre">df</span></code> in Spark has three columns:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">col_1</span></code> , <code class="docutils literal notranslate"><span class="pre">col_2</span></code> , <code class="docutils literal notranslate"><span class="pre">col_3</span></code></p>
</div></blockquote>
</li>
<li><p>A table named <code class="docutils literal notranslate"><span class="pre">tb</span></code> in Snowflake has two columns:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">col_a</span></code> , <code class="docutils literal notranslate"><span class="pre">col_b</span></code></p>
</div></blockquote>
</li>
<li><p>You wish to copy the following values:</p>
<ul class="simple">
<li><p>From <code class="docutils literal notranslate"><span class="pre">df.col_2</span></code> to <code class="docutils literal notranslate"><span class="pre">tb.col_b</span></code>.</p></li>
<li><p>From <code class="docutils literal notranslate"><span class="pre">df.col_3</span></code> to <code class="docutils literal notranslate"><span class="pre">tb.col_a</span></code>.</p></li>
</ul>
</li>
</ul>
<p>The value of the <code class="code docutils literal notranslate"><span class="pre">columnmap</span></code> parameter would be:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">Map(col_2</span> <span class="pre">-&gt;</span> <span class="pre">col_b,</span> <span class="pre">col_3</span> <span class="pre">-&gt;</span> <span class="pre">col_a)</span></code></p>
</div></blockquote>
<p>You can generate this value by executing the following Scala code:</p>
<blockquote>
<div><p><code class="code docutils literal notranslate"><span class="pre">Map("col_2"-&gt;"col_b","col_3"-&gt;"col_a").toString()</span></code></p>
</div></blockquote>
<p>The default value of this parameter is null. In other words, by default,
column names in the source and destination tables should match.</p>
<p>This parameter is used only when writing from Spark to Snowflake;
it does not apply when writing from Snowflake to Spark.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">keep_column_case</span></code></dt><dd><p>When writing a table from Spark to Snowflake, the Spark connector defaults
to shifting the letters in column names to uppercase, unless the column
names are in double quotes.</p>
<p>When writing a table from Snowflake to Spark, the Spark connector defaults
to adding double quotes around any column name that contains any characters
except uppercase letters, underscores, and digits.</p>
<p>If you set keep_column_case to <code class="docutils literal notranslate"><span class="pre">on</span></code>, then the Spark connector will not
make these changes.</p>
<p>The possible values are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">on</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">off</span></code></p></li>
</ul>
<p>The default value is <code class="docutils literal notranslate"><span class="pre">off</span></code>.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">column_mapping</span></code></dt><dd><p>The connector must map columns from the Spark data frame to the Snowflake table. This can be done based on column
names (regardless of order), or based on column order (i.e. the first column in the data frame is mapped to the first
column in the table, regardless of column name).</p>
<p>By default, the mapping is done based on order. You can override that by setting this parameter to <code class="docutils literal notranslate"><span class="pre">name</span></code>,
which tells the connector to map columns based on column names. (The name mapping is case-insensitive.)</p>
<p>The possible values of this parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">order</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code></p></li>
</ul>
<p>The default value is <code class="docutils literal notranslate"><span class="pre">order</span></code>.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">column_mismatch_behavior</span></code></dt><dd><p>This parameter applies only when the <code class="docutils literal notranslate"><span class="pre">column_mapping</span></code> parameter is set to <code class="docutils literal notranslate"><span class="pre">name</span></code>.</p>
<p>If the column names in the Spark data frame and the Snowflake table do not match, then:</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">column_mismatch_behavior</span></code> is <code class="docutils literal notranslate"><span class="pre">error</span></code>, then the Spark Connector reports an error.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">column_mismatch_behavior</span></code> is <code class="docutils literal notranslate"><span class="pre">ignore</span></code>, then the Spark Connector ignores the error.</p>
<ul>
<li><p>The driver discards any column in the Spark data frame that does not have a corresponding column in the
Snowflake table.</p></li>
<li><p>The driver inserts NULLs into any column in the Snowflake table that does not have a corresponding column
in the Spark data frame.</p></li>
</ul>
</li>
</ul>
<p>Potential errors include:</p>
<ul class="simple">
<li><p>The Spark data frame could contain columns that are identical except for case (uppercase/lowercase). Because
column name mapping is case-insensitive, it is not possible to determine the correct mapping from the data frame
to the table.</p></li>
<li><p>The Snowflake table could contain columns that are identical except for case (uppercase/lowercase). Because
column name mapping is case-insensitive, it is not possible to determine the correct mapping from the data frame
to the table.</p></li>
<li><p>The Spark data frame and the Snowflake table might have no column names in common. In theory, the Spark Connector
could insert NULLs into every column of every row, but this is usually pointless, so the connector throws an
error even if the <code class="docutils literal notranslate"><span class="pre">column_mismatch_behavior</span></code> is set to <code class="docutils literal notranslate"><span class="pre">ignore</span></code>.</p></li>
</ul>
<p>The possible values of this parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">error</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ignore</span></code></p></li>
</ul>
<p>The default value is <code class="docutils literal notranslate"><span class="pre">error</span></code>.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">time_output_format</span></code></dt><dd><p>This parameter allows the user to specify the format for <code class="docutils literal notranslate"><span class="pre">TIME</span></code> data returned.</p>
<p>The possible values of this parameter are the possible values for time formats specified at <a class="reference internal" href="../sql-reference/date-time-input-output.html#label-time-formats"><span class="std std-ref">Time Formats</span></a>.</p>
<p>This parameter affects only output, not input.</p>
</dd>
</dl>
<dl id="label-spark-options-timestamp-output-format">
<dt><code class="code docutils literal notranslate"><span class="pre">timestamp_ntz_output_format</span></code>, <span class="newline">.</span> <code class="code docutils literal notranslate"><span class="pre">timestamp_ltz_output_format</span></code>, <span class="newline">.</span> <code class="code docutils literal notranslate"><span class="pre">timestamp_tz_output_format</span></code></dt><dd><p>These options specify the output format for timestamp values. The default values of these options are:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50.0%">
<col style="width: 50.0%">
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Configuration Option</p></th>
<th class="head"><p>Default Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">timestamp_ntz_output_format</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">"YYYY-MM-DD</span> <span class="pre">HH24:MI:SS.FF3"</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">timestamp_ltz_output_format</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">"TZHTZM</span> <span class="pre">YYYY-MM-DD</span> <span class="pre">HH24:MI:SS.FF3"</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">timestamp_tz_output_format</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">"TZHTZM</span> <span class="pre">YYYY-MM-DD</span> <span class="pre">HH24:MI:SS.FF3"</span></code></p></td>
</tr>
</tbody>
</table>
<p>If these options are set to <code class="docutils literal notranslate"><span class="pre">"sf_current"</span></code>, the connector uses the formats specified for the session.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">partition_size_in_mb</span></code></dt><dd><p>This parameter is used when the query result set is very large and needs to be split into multiple DataFrame
partitions. This parameter specifies the recommended uncompressed size for each DataFrame partition. To reduce the
number of partitions, make this size larger.</p>
<p>This size is used as a recommended size; the actual size of partitions could be smaller or larger.</p>
<p>This option applies only when the <a class="reference internal" href="#label-use-copy-unload"><span class="std std-ref">use_copy_unload</span></a> parameter is FALSE.</p>
<p>This parameter is optional.</p>
<p>The default value is <code class="docutils literal notranslate"><span class="pre">100</span></code> (MB).</p>
</dd>
</dl>
<dl id="label-use-copy-unload">
<dt><code class="code docutils literal notranslate"><span class="pre">use_copy_unload</span></code></dt><dd><p>If this is <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>, Snowflake uses the Arrow data format when SELECTing data. If this is set to <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>,
then Snowflake reverts to the old behavior of using the <code class="docutils literal notranslate"><span class="pre">COPY</span> <span class="pre">UNLOAD</span></code> command to transmit selected data.</p>
<p>This parameter is optional.</p>
<p>The default value is <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">treat_decimal_as_long</span></code></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>, configures the Spark Connector to return <code class="code docutils literal notranslate"><span class="pre">Long</span></code> values (rather than <code class="code docutils literal notranslate"><span class="pre">BigDecimal</span></code> values) for queries
that return the type <code class="samp docutils literal notranslate"><span class="pre">Decimal(</span><em><span class="pre">precision</span></em><span class="pre">,</span> <span class="pre">0)</span></code>.</p>
<p>The default value is <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>.</p>
<p>This option was added in version 2.11.1 of the Spark Connector.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">s3_stage_vpce_dns_name</span></code></dt><dd><p>Specifies the DNS name of your VPC Endpoint for access to internal stages.</p>
<p>This option was added in version 2.11.1 of the Spark Connector.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">support_share_connection</span></code></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>, configures the Spark Connector to create a new JDBC connection for each job or action that uses the same Spark
Connector options to access Snowflake.</p>
<p>The default value is <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>, which means that the different jobs and actions share the same JDBC connection if they use the
same Spark Connector options to access Snowflake.</p>
<p>If you need to enable or disable this setting programmatically, use the following global static functions:</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">SparkConnectorContext.disableSharedConnection()</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">SparkConnectorContext.enableSharingJDBCConnection()</span></code></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the following special cases, the Spark Connector does not use a shared JDBC connection:</p>
<ul class="simple">
<li><p>If preactions or postactions are set, and those preactions or postactions are not CREATE TABLE, DROP TABLE, or MERGE INTO,
the Spark Connector does not use the shared connection.</p></li>
<li><p>Utility functions in Utils such as <code class="code docutils literal notranslate"><span class="pre">Utils.runQuery()</span></code> and <code class="code docutils literal notranslate"><span class="pre">Utils.getJDBCConnection()</span></code> do not use the shared
connection.</p></li>
</ul>
</div>
<p>This option was added in version 2.11.2 of the Spark Connector.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">force_skip_pre_post_action_check_for_shared_session</span></code></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>, configures the Spark Connector to disable the validation of preactions and postactions for session sharing.</p>
<p>The default value is <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Before setting this option, make sure that the queries in preactions and postactions don’t affect the session settings.
Otherwise, you may encounter issues with results.</p>
</div>
<p>This option was added in version 2.11.3 of the Spark Connector.</p>
</dd>
</dl>
</section>
<section id="using-key-pair-authentication-key-pair-rotation">
<span id="label-spark-key-pair-authn-rotation"></span><h3>Using Key Pair Authentication &amp; Key Pair Rotation<a class="headerlink" href="#using-key-pair-authentication-key-pair-rotation" title="Link to this heading">¶</a></h3>
<p>The Spark connector supports key pair authentication and key rotation.</p>
<ol class="arabic simple">
<li><p>To start, complete the initial configuration for key pair authentication as shown in <a class="reference internal" href="key-pair-auth"><span class="doc">Key-pair authentication and key-pair rotation</span></a>.</p></li>
<li><p>Send an <span class="emph">unencrypted</span> copy of the private key using the <code class="code docutils literal notranslate"><span class="pre">pem_private_key</span></code> connection option.</p></li>
</ol>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>For security reasons, rather than hard-coding the <code class="code docutils literal notranslate"><span class="pre">pem_private_key</span></code> in your application, you should set the parameter dynamically after reading the key from a secure source. If the key is encrypted, then decrypt it and send the decrypted version.</p>
</div>
<p>In the Python example, note that the <code class="code docutils literal notranslate"><span class="pre">pem_private_key</span></code> file, <code class="file docutils literal notranslate"><span class="pre">rsa_key.p8</span></code>, is:</p>
<ul class="simple">
<li><p>Being read directly from a password-protected file, using the environment variable <code class="code docutils literal notranslate"><span class="pre">PRIVATE_KEY_PASSPHRASE</span></code>.</p></li>
<li><p>Using the expression <code class="code docutils literal notranslate"><span class="pre">pkb</span></code> in the <code class="code docutils literal notranslate"><span class="pre">sfOptions</span></code> string.</p></li>
</ul>
<p>To connect, you can save the Python example to a file (i.e. <code class="file docutils literal notranslate"><span class="pre">&lt;file.py&gt;</span></code>) and then execute the following command:</p>
<div class="relative group text-sm"><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>spark-submit<span class="w"> </span>--packages<span class="w"> </span>net.snowflake:snowflake-jdbc:3.13.22,net.snowflake:spark-snowflake_2.12:2.11.0-spark_3.3<span class="w"> </span>&lt;file.py&gt;
</pre></div>
</div><div data-codeblock-index="18" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
<p><strong>Python</strong></p>
<div class="relative group text-sm"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">SQLContext</span>
<span class="kn">from</span> <span class="nn">pyspark</span> <span class="kn">import</span> <span class="n">SparkConf</span><span class="p">,</span> <span class="n">SparkContext</span>
<span class="kn">from</span> <span class="nn">cryptography.hazmat.backends</span> <span class="kn">import</span> <span class="n">default_backend</span>
<span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives</span> <span class="kn">import</span> <span class="n">serialization</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"&lt;path&gt;/rsa_key.p8"</span><span class="p">,</span> <span class="s2">"rb"</span><span class="p">)</span> <span class="k">as</span> <span class="n">key_file</span><span class="p">:</span>
  <span class="n">p_key</span> <span class="o">=</span> <span class="n">serialization</span><span class="o">.</span><span class="n">load_pem_private_key</span><span class="p">(</span>
    <span class="n">key_file</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">'PRIVATE_KEY_PASSPHRASE'</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span>
    <span class="n">backend</span> <span class="o">=</span> <span class="n">default_backend</span><span class="p">()</span>
    <span class="p">)</span>

<span class="n">pkb</span> <span class="o">=</span> <span class="n">p_key</span><span class="o">.</span><span class="n">private_bytes</span><span class="p">(</span>
  <span class="n">encoding</span> <span class="o">=</span> <span class="n">serialization</span><span class="o">.</span><span class="n">Encoding</span><span class="o">.</span><span class="n">PEM</span><span class="p">,</span>
  <span class="nb">format</span> <span class="o">=</span> <span class="n">serialization</span><span class="o">.</span><span class="n">PrivateFormat</span><span class="o">.</span><span class="n">PKCS8</span><span class="p">,</span>
  <span class="n">encryption_algorithm</span> <span class="o">=</span> <span class="n">serialization</span><span class="o">.</span><span class="n">NoEncryption</span><span class="p">()</span>
  <span class="p">)</span>

<span class="n">pkb</span> <span class="o">=</span> <span class="n">pkb</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">"UTF-8"</span><span class="p">)</span>
<span class="n">pkb</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">"-*(BEGIN|END) PRIVATE KEY-*</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span><span class="s2">""</span><span class="p">,</span><span class="n">pkb</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span><span class="s2">""</span><span class="p">)</span>

<span class="n">sc</span> <span class="o">=</span> <span class="n">SparkContext</span><span class="p">(</span><span class="s2">"local"</span><span class="p">,</span> <span class="s2">"Simple App"</span><span class="p">)</span>
<span class="n">spark</span> <span class="o">=</span> <span class="n">SQLContext</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
<span class="n">spark_conf</span> <span class="o">=</span> <span class="n">SparkConf</span><span class="p">()</span><span class="o">.</span><span class="n">setMaster</span><span class="p">(</span><span class="s1">'local'</span><span class="p">)</span><span class="o">.</span><span class="n">setAppName</span><span class="p">(</span><span class="s1">'Simple App'</span><span class="p">)</span>

<span class="n">sfOptions</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">"sfURL"</span> <span class="p">:</span> <span class="s2">"&lt;account_identifier&gt;.snowflakecomputing.com"</span><span class="p">,</span>
  <span class="s2">"sfUser"</span> <span class="p">:</span> <span class="s2">"&lt;user_name&gt;"</span><span class="p">,</span>
  <span class="s2">"pem_private_key"</span> <span class="p">:</span> <span class="n">pkb</span><span class="p">,</span>
  <span class="s2">"sfDatabase"</span> <span class="p">:</span> <span class="s2">"&lt;database&gt;"</span><span class="p">,</span>
  <span class="s2">"sfSchema"</span> <span class="p">:</span> <span class="s2">"schema"</span><span class="p">,</span>
  <span class="s2">"sfWarehouse"</span> <span class="p">:</span> <span class="s2">"&lt;warehouse&gt;"</span>
<span class="p">}</span>

<span class="n">SNOWFLAKE_SOURCE_NAME</span> <span class="o">=</span> <span class="s2">"net.snowflake.spark.snowflake"</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">SNOWFLAKE_SOURCE_NAME</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">sfOptions</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"query"</span><span class="p">,</span> <span class="s2">"COLORS"</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">load</span><span class="p">()</span>

<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div><div data-codeblock-index="19" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
</section>
<section id="using-external-oauth">
<span id="label-spark-ext-oauth"></span><h3>Using External OAuth<a class="headerlink" href="#using-external-oauth" title="Link to this heading">¶</a></h3>
<p>Starting with Spark Connector version 2.7.0, you can use <a class="reference internal" href="oauth-ext-overview"><span class="doc">External OAuth</span></a> to authenticate to Snowflake using either the sample Scala program or the sample Python script.</p>
<p>Before using External OAuth and the Spark Connector to authenticate to Snowflake, configure an External OAuth security integration for one of the supported External OAuth authorization servers or an External OAuth <a class="reference internal" href="oauth-ext-custom"><span class="doc">custom client</span></a>.</p>
<p>In the Scala and Python examples, note the replacement of the <code class="code docutils literal notranslate"><span class="pre">sfPassword</span></code> parameter with the <code class="code docutils literal notranslate"><span class="pre">sfAuthenticator</span></code> and <code class="code docutils literal notranslate"><span class="pre">sfToken</span></code> parameters.</p>
<p><strong>Scala:</strong></p>
<blockquote>
<div><div class="relative group text-sm"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="c1">// spark connector version</span>

<span class="kd">val</span><span class="w"> </span><span class="nc">SNOWFLAKE_SOURCE_NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"net.snowflake.spark.snowflake"</span>
<span class="k">import</span><span class="w"> </span><span class="nn">net</span><span class="p">.</span><span class="nn">snowflake</span><span class="p">.</span><span class="nn">spark</span><span class="p">.</span><span class="nn">snowflake2</span><span class="p">.</span><span class="nc">Utils</span><span class="p">.</span><span class="nc">SNOWFLAKE_SOURCE_NAME</span>
<span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">apache</span><span class="p">.</span><span class="nn">spark</span><span class="p">.</span><span class="nn">sql</span><span class="p">.</span><span class="nc">DataFrame</span>

<span class="kd">var</span><span class="w"> </span><span class="n">sfOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Map</span><span class="p">(</span>
<span class="w">    </span><span class="s">"sfURL"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;account_identifier&gt;.snowflakecomputing.com"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"sfUser"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;username&gt;"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"sfAuthenticator"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"oauth"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"sfToken"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;external_oauth_access_token&gt;"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"sfDatabase"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;database&gt;"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"sfSchema"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;schema&gt;"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"sfWarehouse"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;warehouse&gt;"</span>
<span class="p">)</span>

<span class="c1">//</span>
<span class="c1">// Create a DataFrame from a Snowflake table</span>
<span class="c1">//</span>
<span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="p">:</span><span class="w"> </span><span class="nc">DataFrame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqlContext</span><span class="p">.</span><span class="n">read</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="nc">SNOWFLAKE_SOURCE_NAME</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">options</span><span class="p">(</span><span class="n">sfOptions</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">"dbtable"</span><span class="p">,</span><span class="w"> </span><span class="s">"region"</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">load</span><span class="p">()</span>

<span class="c1">//</span>
<span class="c1">// Join, augment, aggregate, etc. the data in Spark and then use the</span>
<span class="c1">// Data Source API to write the data back to a table in Snowflake</span>
<span class="c1">//</span>
<span class="n">df</span><span class="p">.</span><span class="n">write</span>
<span class="w">    </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="nc">SNOWFLAKE_SOURCE_NAME</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">options</span><span class="p">(</span><span class="n">sfOptions</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">"dbtable"</span><span class="p">,</span><span class="w"> </span><span class="s">"t2"</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">mode</span><span class="p">(</span><span class="nc">SaveMode</span><span class="p">.</span><span class="nc">Overwrite</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div><div data-codeblock-index="20" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
</div></blockquote>
<p><strong>Python:</strong></p>
<blockquote>
<div><div class="relative group text-sm"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark</span> <span class="kn">import</span> <span class="n">SparkConf</span><span class="p">,</span> <span class="n">SparkContext</span>
<span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">SQLContext</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.types</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">sc</span> <span class="o">=</span> <span class="n">SparkContext</span><span class="p">(</span><span class="s2">"local"</span><span class="p">,</span> <span class="s2">"Simple App"</span><span class="p">)</span>
<span class="n">spark</span> <span class="o">=</span> <span class="n">SQLContext</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
<span class="n">spark_conf</span> <span class="o">=</span> <span class="n">SparkConf</span><span class="p">()</span><span class="o">.</span><span class="n">setMaster</span><span class="p">(</span><span class="s1">'local'</span><span class="p">)</span><span class="o">.</span><span class="n">setAppName</span><span class="p">(</span><span class="s1">'&lt;APP_NAME&gt;'</span><span class="p">)</span>

<span class="c1"># You might need to set these</span>
<span class="n">sc</span><span class="o">.</span><span class="n">_jsc</span><span class="o">.</span><span class="n">hadoopConfiguration</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">"fs.s3n.awsAccessKeyId"</span><span class="p">,</span> <span class="s2">"&lt;AWS_KEY&gt;"</span><span class="p">)</span>
<span class="n">sc</span><span class="o">.</span><span class="n">_jsc</span><span class="o">.</span><span class="n">hadoopConfiguration</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">"fs.s3n.awsSecretAccessKey"</span><span class="p">,</span> <span class="s2">"&lt;AWS_SECRET&gt;"</span><span class="p">)</span>

<span class="c1"># Set options below</span>
<span class="n">sfOptions</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">"sfURL"</span> <span class="p">:</span> <span class="s2">"&lt;account_identifier&gt;.snowflakecomputing.com"</span><span class="p">,</span>
  <span class="s2">"sfUser"</span> <span class="p">:</span> <span class="s2">"&lt;user_name&gt;"</span><span class="p">,</span>
  <span class="s2">"sfAuthenticator"</span> <span class="p">:</span> <span class="s2">"oauth"</span><span class="p">,</span>
  <span class="s2">"sfToken"</span> <span class="p">:</span> <span class="s2">"&lt;external_oauth_access_token&gt;"</span><span class="p">,</span>
  <span class="s2">"sfDatabase"</span> <span class="p">:</span> <span class="s2">"&lt;database&gt;"</span><span class="p">,</span>
  <span class="s2">"sfSchema"</span> <span class="p">:</span> <span class="s2">"&lt;schema&gt;"</span><span class="p">,</span>
  <span class="s2">"sfWarehouse"</span> <span class="p">:</span> <span class="s2">"&lt;warehouse&gt;"</span>
<span class="p">}</span>

<span class="n">SNOWFLAKE_SOURCE_NAME</span> <span class="o">=</span> <span class="s2">"net.snowflake.spark.snowflake"</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">SNOWFLAKE_SOURCE_NAME</span><span class="p">)</span> \
  <span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">sfOptions</span><span class="p">)</span> \
  <span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"query"</span><span class="p">,</span>  <span class="s2">"select 1 as my_num union all select 2 as my_num"</span><span class="p">)</span> \
  <span class="o">.</span><span class="n">load</span><span class="p">()</span>

<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div><div data-codeblock-index="21" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
</div></blockquote>
</section>
<section id="aws-options-for-external-data-transfer">
<span id="label-s3-options"></span><h3>AWS Options for External Data Transfer<a class="headerlink" href="#aws-options-for-external-data-transfer" title="Link to this heading">¶</a></h3>
<p>These options are used to specify the Amazon S3 location where temporary data is stored and provide authentication details for accessing the location. They are required <span class="emph">only</span> if you are doing an external data transfer. External data transfers are required if either of the following is true:</p>
<ul class="simple">
<li><p>You are using version 2.1.x or lower of the Spark Connector (which
does not support internal transfers), or</p></li>
<li><p>Your transfer is likely to take 36 hours or more (internal transfers
use temporary credentials that expire after 36 hours).</p></li>
</ul>
<dl>
<dt><code class="code docutils literal notranslate"><span class="pre">tempDir</span></code></dt><dd><p>The S3 location where intermediate data is stored (e.g. <code class="docutils literal notranslate"><span class="pre">s3n://xy12345-bucket/spark-snowflake-tmp/</span></code>).</p>
<p>If <code class="code docutils literal notranslate"><span class="pre">tempDir</span></code> is specified, you must also specify either:</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">awsAccessKey</span></code> , <code class="code docutils literal notranslate"><span class="pre">awsSecretKey</span></code> <span class="newline">.</span> or</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">temporary_aws_access_key_id</span></code> , <code class="code docutils literal notranslate"><span class="pre">temporary_aws_secret_access_key</span></code>, <code class="code docutils literal notranslate"><span class="pre">temporary_aws_session_token</span></code></p></li>
</ul>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">awsAccessKey</span></code> , <code class="code docutils literal notranslate"><span class="pre">awsSecretKey</span></code></dt><dd><p>These are standard AWS credentials that allow access to the location
specified in <code class="code docutils literal notranslate"><span class="pre">tempDir</span></code>. Note that both of these options must be set
together.</p>
<p>If they are set, they can be retrieved from the existing <code class="code docutils literal notranslate"><span class="pre">SparkContext</span></code> object.</p>
<p>If you specify these variables, you must also specify <code class="code docutils literal notranslate"><span class="pre">tempDir</span></code>.</p>
<p>These credentials should also be set for the Hadoop cluster.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">temporary_aws_access_key_id</span></code> , <code class="code docutils literal notranslate"><span class="pre">temporary_aws_secret_access_key</span></code>, <code class="code docutils literal notranslate"><span class="pre">temporary_aws_session_token</span></code></dt><dd><p>These are temporary AWS credentials that allow access to the location
specified in <code class="code docutils literal notranslate"><span class="pre">tempDir</span></code>. Note that all three of these options must be
set together.</p>
<p>Also, if these options are set, they take precedence over the <code class="code docutils literal notranslate"><span class="pre">awsAccessKey</span></code> and <code class="code docutils literal notranslate"><span class="pre">awsSecretKey</span></code> options.</p>
<p>If you specify <code class="code docutils literal notranslate"><span class="pre">temporary_aws_access_key_id</span></code> , <code class="code docutils literal notranslate"><span class="pre">temporary_aws_secret_access_key</span></code>, and <code class="code docutils literal notranslate"><span class="pre">temporary_aws_session_token</span></code> , you must also specify <code class="code docutils literal notranslate"><span class="pre">tempDir</span></code>. Otherwise, these parameters are ignored.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">check_bucket_configuration</span></code></dt><dd><p>If set to <code class="code docutils literal notranslate"><span class="pre">on</span></code> (default), the connector checks if the bucket used for data transfer has a lifecycle policy configured (see <a class="reference internal" href="spark-connector-install.html#label-spark-s3-setup"><span class="std std-ref">Preparing an AWS External S3 Bucket</span></a> for more information). If there is no lifecycle
policy present, a warning is logged.</p>
<p>Disabling this option (by setting to <code class="code docutils literal notranslate"><span class="pre">off</span></code>) skips this check. This can be useful if a user can access the bucket data operations, but not the bucket lifecycle policies. Disabling the option can also
speed up query execution times slightly.</p>
</dd>
</dl>
<p>For details, see <a class="reference internal" href="#label-spark-auth"><span class="std std-ref">Authenticating S3 for Data Exchange</span></a> (in this topic).</p>
</section>
<section id="azure-options-for-external-data-transfer">
<span id="label-azure-options"></span><h3>Azure Options for External Data Transfer<a class="headerlink" href="#azure-options-for-external-data-transfer" title="Link to this heading">¶</a></h3>
<p>This section describes the parameters that apply to Azure Blob storage when
doing external data transfers. External data transfers are required if either
of the following is true:</p>
<ul class="simple">
<li><p>You are using version 2.1.x or lower of the Spark Connector (which
does not support internal transfers), or</p></li>
<li><p>Your transfer is likely to take 36 hours or more (internal transfers
use temporary credentials that expire after 36 hours).</p></li>
</ul>
<p>When using an external transfer with Azure Blob storage, you specify the location of the
Azure container and the SAS (shared-access signature) for that container using
the parameters described below.</p>
<dl>
<dt><code class="code docutils literal notranslate"><span class="pre">tempDir</span></code></dt><dd><p>The Azure Blob storage container where intermediate data is stored.
This is in the form of a URL, for example:</p>
<blockquote>
<div><p><code class="code docutils literal notranslate"><span class="pre">wasb://&lt;azure_container&gt;@&lt;azure_account&gt;.&lt;azure_endpoint&gt;/</span></code></p>
</div></blockquote>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">temporary_azure_sas_token</span></code></dt><dd><p>Specify the SAS token for Azure Blob storage.</p>
</dd>
</dl>
<p>For details, see <a class="reference internal" href="#label-spark-azure-auth"><span class="std std-ref">Authenticating Azure for Data Exchange</span></a> (in this topic).</p>
<section id="specifying-azure-information-for-temporary-storage-in-spark">
<h4>Specifying Azure Information for Temporary Storage in Spark<a class="headerlink" href="#specifying-azure-information-for-temporary-storage-in-spark" title="Link to this heading">¶</a></h4>
<p>When using Azure Blob storage to provide temporary storage to transfer data
between Spark and Snowflake, you must provide Spark, as well as the Snowflake Spark Connector,
with the location and credentials for the temporary storage.</p>
<p>To provide Spark with the temporary storage location, execute commands similar to the following
on your Spark cluster:</p>
<blockquote>
<div><div class="relative group text-sm"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span><span class="p">.</span><span class="n">hadoopConfiguration</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">"fs.azure"</span><span class="p">,</span><span class="w"> </span><span class="s">"org.apache.hadoop.fs.azure.NativeAzureFileSystem"</span><span class="p">)</span>
<span class="n">sc</span><span class="p">.</span><span class="n">hadoopConfiguration</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">"fs.AbstractFileSystem.wasb.impl"</span><span class="p">,</span><span class="w"> </span><span class="s">"org.apache.hadoop.fs.azure.Wasb"</span><span class="p">)</span>
<span class="n">sc</span><span class="p">.</span><span class="n">hadoopConfiguration</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">"fs.azure.sas.&lt;container&gt;.&lt;account&gt;.&lt;azure_endpoint&gt;"</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="n">azure_sas</span><span class="o">&gt;</span><span class="p">)</span>
</pre></div>
</div><div data-codeblock-index="22" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
</div></blockquote>
<p>Note that the last command contains the following variables:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;container&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;account&gt;</span></code>: These are the container and account name for your Azure deployment.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;azure_endpoint&gt;</span></code>: This is the endpoint for your Azure deployment location. For example, if you are using an Azure US deployment, the endpoint is likely to be <code class="docutils literal notranslate"><span class="pre">blob.core.windows.net</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;azure_sas&gt;</span></code>: This is the Shared Access Signature security token.</p></li>
</ul>
<p>Replace each of these variables with the proper information for your Azure Blob Storage account.</p>
</section>
</section>
</section>
<section id="passing-snowflake-session-parameters-as-options-for-the-connector">
<h2>Passing Snowflake Session Parameters as Options for the Connector<a class="headerlink" href="#passing-snowflake-session-parameters-as-options-for-the-connector" title="Link to this heading">¶</a></h2>
<p>The Snowflake Connector for Spark supports sending arbitrary session-level parameters to Snowflake (see <a class="reference internal" href="../sql-reference/parameters.html#label-session-parameters"><span class="std std-ref">Session Parameters</span></a> for more info). This can be achieved by adding a
<code class="code docutils literal notranslate"><span class="pre">("&lt;key&gt;"</span> <span class="pre">-&gt;</span> <span class="pre">"&lt;value&gt;")</span></code> pair to the <code class="code docutils literal notranslate"><span class="pre">options</span></code> object, where <code class="code docutils literal notranslate"><span class="pre">&lt;key&gt;</span></code> is the session parameter name and <code class="code docutils literal notranslate"><span class="pre">&lt;value&gt;</span></code> is the value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="code docutils literal notranslate"><span class="pre">&lt;value&gt;</span></code> should be a string enclosed in double quotes, even for parameters that accept numbers or Boolean values (e.g. <code class="code docutils literal notranslate"><span class="pre">"1"</span></code> or <code class="code docutils literal notranslate"><span class="pre">"true"</span></code>).</p>
</div>
<p>For example, the following code sample passes the <a class="reference internal" href="../sql-reference/parameters.html#label-use-cached-result"><span class="std std-ref">USE_CACHED_RESULT</span></a> session parameter with a value of <code class="code docutils literal notranslate"><span class="pre">"false"</span></code>, which disables using the results of previously-executed queries:</p>
<div class="relative group text-sm"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="c1">// ... assuming sfOptions contains Snowflake connector options</span>

<span class="c1">// Add to the options request to keep connection alive</span>
<span class="n">sfOptions</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="s">"USE_CACHED_RESULT"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"false"</span><span class="p">)</span>

<span class="c1">// ... now use sfOptions with the .options() method</span>
</pre></div>
</div><div data-codeblock-index="23" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
</section>
<section id="security-considerations">
<h2>Security Considerations<a class="headerlink" href="#security-considerations" title="Link to this heading">¶</a></h2>
<p>Customers should ensure that in a multi-node Spark system, communications between the nodes are secure. The Spark
master sends Snowflake credentials to Spark workers so that those workers can access Snowflake stages. If
communications between the Spark master and Spark workers are not secure, the credentials could be read by an
unauthorized third party.</p>
</section>
<section id="authenticating-s3-for-data-exchange">
<span id="label-spark-auth"></span><h2>Authenticating S3 for Data Exchange<a class="headerlink" href="#authenticating-s3-for-data-exchange" title="Link to this heading">¶</a></h2>
<p>This section describes how to authenticate when using S3 for data exchange.</p>
<p>This task is required <span class="emph">only</span> in either of the following circumstances:</p>
<ul class="simple">
<li><p>The Snowflake Connector for Spark version is 2.1.x (or lower). Starting with v2.2.0, the connector uses a Snowflake internal temporary stage for data exchange. If you are not currently using version 2.2.0 (or higher) of the connector, Snowflake strongly recommends upgrading to the latest version.</p></li>
<li><p>The Snowflake Connector for Spark version is 2.2.0 (or higher), but your jobs regularly exceed 36 hours in length. This is the maximum duration for the AWS token used by the connector to access the internal stage for data exchange.</p></li>
</ul>
<p>If you are using an older version of the connector, you need to prepare an S3 location that the connector can use to exchange data between Snowflake and Spark.</p>
<p>To allow access to the S3 bucket/directory used to exchange data between Spark and Snowflake (as specified for <code class="code docutils literal notranslate"><span class="pre">tempDir</span></code>), two authentication methods are supported:</p>
<ul class="simple">
<li><p>Permanent AWS credentials (also used to configure Hadoop/Spark authentication for accessing S3)</p></li>
<li><p>Temporary AWS credentials</p></li>
</ul>
<section id="using-permanent-aws-credentials">
<h3>Using Permanent AWS Credentials<a class="headerlink" href="#using-permanent-aws-credentials" title="Link to this heading">¶</a></h3>
<p>This is the standard AWS authentication method. It requires a pair of <code class="code docutils literal notranslate"><span class="pre">awsAccessKey</span></code> and <code class="code docutils literal notranslate"><span class="pre">awsSecretKey</span></code> values.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These values should also be used to configure Hadoop/Spark for accessing S3. For more information, including examples, see <a class="reference internal" href="#label-spark-s3a-s3n"><span class="std std-ref">Authenticating Hadoop/Spark Using S3A or S3N</span></a> (in this topic).</p>
</div>
<p>For example:</p>
<blockquote>
<div><div class="relative group text-sm"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span><span class="p">.</span><span class="n">hadoopConfiguration</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">"fs.s3n.awsAccessKeyId"</span><span class="p">,</span><span class="w"> </span><span class="s">"&lt;access_key&gt;"</span><span class="p">)</span>
<span class="n">sc</span><span class="p">.</span><span class="n">hadoopConfiguration</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">"fs.s3n.awsSecretAccessKey"</span><span class="p">,</span><span class="w"> </span><span class="s">"&lt;secret_key&gt;"</span><span class="p">)</span>

<span class="c1">// Then, configure your Snowflake environment</span>
<span class="c1">//</span>
<span class="kd">var</span><span class="w"> </span><span class="n">sfOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Map</span><span class="p">(</span>
<span class="w">    </span><span class="s">"sfURL"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;account_identifier&gt;.snowflakecomputing.com"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"sfUser"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;user_name&gt;"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"sfPassword"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;password&gt;"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"sfDatabase"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;database&gt;"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"sfSchema"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;schema&gt;"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"sfWarehouse"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;warehouse&gt;"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"awsAccessKey"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">sc</span><span class="p">.</span><span class="n">hadoopConfiguration</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"fs.s3n.awsAccessKeyId"</span><span class="p">),</span>
<span class="w">    </span><span class="s">"awsSecretKey"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">sc</span><span class="p">.</span><span class="n">hadoopConfiguration</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"fs.s3n.awsSecretAccessKey"</span><span class="p">),</span>
<span class="w">    </span><span class="s">"tempdir"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"s3n://&lt;temp-bucket-name&gt;"</span>
<span class="p">)</span>
</pre></div>
</div><div data-codeblock-index="24" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
</div></blockquote>
<p>For details about the options supported by <code class="code docutils literal notranslate"><span class="pre">sfOptions</span></code>, see <a class="reference internal" href="#label-s3-options"><span class="std std-ref">AWS Options for External Data Transfer</span></a> (in this topic).</p>
<section id="authenticating-hadoop-spark-using-s3a-or-s3n">
<span id="label-spark-s3a-s3n"></span><h4>Authenticating Hadoop/Spark Using S3A or S3N<a class="headerlink" href="#authenticating-hadoop-spark-using-s3a-or-s3n" title="Link to this heading">¶</a></h4>
<p>Hadoop/Spark ecosystems support 2 URI schemes for <a class="reference external" href="https://wiki.apache.org/hadoop/AmazonS3/">accessing S3</a>:</p>
<dl>
<dt><code class="code docutils literal notranslate"><span class="pre">s3a://</span></code></dt><dd><p><strong>New, recommended method (for Hadoop 2.7 and higher)</strong></p>
<p>To use this method, modify the Scala examples in this topic to add the following Hadoop configuration options:</p>
<blockquote>
<div><div class="relative group text-sm"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">hadoopConf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sc</span><span class="p">.</span><span class="n">hadoopConfiguration</span>
<span class="n">hadoopConf</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">"fs.s3a.access.key"</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="n">accessKey</span><span class="o">&gt;</span><span class="p">)</span>
<span class="n">hadoopConf</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">"fs.s3a.secret.key"</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="n">secretKey</span><span class="o">&gt;</span><span class="p">)</span>
</pre></div>
</div><div data-codeblock-index="25" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
</div></blockquote>
<p>Make sure the <code class="code docutils literal notranslate"><span class="pre">tempdir</span></code> option uses <code class="code docutils literal notranslate"><span class="pre">s3a://</span></code> as well.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">s3n://</span></code></dt><dd><p><strong>Older method (for Hadoop 2.6 and lower)</strong></p>
<p>In some systems, it is necessary to specify it explicitly as shown in the following Scala example:</p>
<blockquote>
<div><div class="relative group text-sm"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">hadoopConf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sc</span><span class="p">.</span><span class="n">hadoopConfiguration</span>
<span class="n">hadoopConf</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">"fs.s3.impl"</span><span class="p">,</span><span class="w"> </span><span class="s">"org.apache.hadoop.fs.s3native.NativeS3FileSystem"</span><span class="p">)</span>
<span class="n">hadoopConf</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">"fs.s3.awsAccessKeyId"</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="n">accessKey</span><span class="o">&gt;</span><span class="p">)</span>
<span class="n">hadoopConf</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">"fs.s3.awsSecretAccessKey"</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="n">secretKey</span><span class="o">&gt;</span><span class="p">)</span>
</pre></div>
</div><div data-codeblock-index="26" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
</div></blockquote>
</dd>
</dl>
</section>
</section>
<section id="using-temporary-aws-credentials">
<h3>Using Temporary AWS Credentials<a class="headerlink" href="#using-temporary-aws-credentials" title="Link to this heading">¶</a></h3>
<p>This method uses the <code class="code docutils literal notranslate"><span class="pre">temporary_aws_access_key_id</span></code>, <code class="code docutils literal notranslate"><span class="pre">temporary_aws_secret_access_key</span></code>, and <code class="code docutils literal notranslate"><span class="pre">temporary_aws_session_token</span></code> configuration options for the connector.</p>
<p>This method allows additional security by providing Snowflake with only temporary access to the S3 bucket/directory used for data exchange.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Temporary credentials can only be used to configure the S3 authentication for the connector; they cannot be used to configure Hadoop/Spark authentication.</p>
<p>Also, if you provide temporary credentials, they take precedence over any permanent credentials that have been provided.</p>
</div>
<p>The following Scala code sample provides an example of authenticating using temporary credentials:</p>
<blockquote>
<div><div class="relative group text-sm"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">amazonaws</span><span class="p">.</span><span class="nn">services</span><span class="p">.</span><span class="nn">securitytoken</span><span class="p">.</span><span class="nc">AWSSecurityTokenServiceClient</span>
<span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">amazonaws</span><span class="p">.</span><span class="nn">services</span><span class="p">.</span><span class="nn">securitytoken</span><span class="p">.</span><span class="nn">model</span><span class="p">.</span><span class="nc">GetSessionTokenRequest</span>

<span class="k">import</span><span class="w"> </span><span class="nn">net</span><span class="p">.</span><span class="nn">snowflake</span><span class="p">.</span><span class="nn">spark</span><span class="p">.</span><span class="nn">snowflake</span><span class="p">.</span><span class="nc">Parameters</span>

<span class="c1">// ...</span>

<span class="kd">val</span><span class="w"> </span><span class="n">sts_client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nc">AWSSecurityTokenServiceClient</span><span class="p">()</span>
<span class="kd">val</span><span class="w"> </span><span class="n">session_token_request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nc">GetSessionTokenRequest</span><span class="p">()</span>

<span class="c1">// Set the token duration to 2 hours.</span>

<span class="n">session_token_request</span><span class="p">.</span><span class="n">setDurationSeconds</span><span class="p">(</span><span class="mi">7200</span><span class="p">)</span>
<span class="kd">val</span><span class="w"> </span><span class="n">session_token_result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sts_client</span><span class="p">.</span><span class="n">getSessionToken</span><span class="p">(</span><span class="n">session_token_request</span><span class="p">)</span>
<span class="kd">val</span><span class="w"> </span><span class="n">session_creds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">session_token_result</span><span class="p">.</span><span class="n">getCredentials</span><span class="p">()</span>

<span class="c1">// Create a new set of Snowflake connector options, based on the existing</span>
<span class="c1">// sfOptions definition, with additional temporary credential options that override</span>
<span class="c1">// the credential options in sfOptions.</span>
<span class="c1">// Note that constants from Parameters are used to guarantee correct</span>
<span class="c1">// key names, but literal values, such as temporary_aws_access_key_id are, of course,</span>
<span class="c1">// also allowed.</span>

<span class="kd">var</span><span class="w"> </span><span class="n">sfOptions2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">collection</span><span class="p">.</span><span class="n">mutable</span><span class="p">.</span><span class="nc">Map</span><span class="p">[</span><span class="nc">String</span><span class="p">,</span><span class="w"> </span><span class="nc">String</span><span class="p">]()</span><span class="w"> </span><span class="o">++=</span><span class="w"> </span><span class="n">sfOptions</span>
<span class="n">sfOptions2</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="nc">Parameters</span><span class="p">.</span><span class="nc">PARAM_TEMP_KEY_ID</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">session_creds</span><span class="p">.</span><span class="n">getAccessKeyId</span><span class="p">())</span>
<span class="n">sfOptions2</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="nc">Parameters</span><span class="p">.</span><span class="nc">PARAM_TEMP_KEY_SECRET</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">session_creds</span><span class="p">.</span><span class="n">getSecretAccessKey</span><span class="p">())</span>
<span class="n">sfOptions2</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="nc">Parameters</span><span class="p">.</span><span class="nc">PARAM_TEMP_SESSION_TOKEN</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">session_creds</span><span class="p">.</span><span class="n">getSessionToken</span><span class="p">())</span>
</pre></div>
</div><div data-codeblock-index="27" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
</div></blockquote>
<p><code class="code docutils literal notranslate"><span class="pre">sfOptions2</span></code> can now be used with the <code class="code docutils literal notranslate"><span class="pre">options()</span></code> DataFrame method.</p>
</section>
</section>
<section id="authenticating-azure-for-data-exchange">
<span id="label-spark-azure-auth"></span><h2>Authenticating Azure for Data Exchange<a class="headerlink" href="#authenticating-azure-for-data-exchange" title="Link to this heading">¶</a></h2>
<p>This section describes how to authenticate when using Azure Blob storage for data exchange.</p>
<p>Authenticating this way is required <span class="emph">only</span> in either of the following circumstances:</p>
<ul class="simple">
<li><p>The Snowflake Connector for Spark version is 2.1.x (or lower). Starting with
v2.2.0, the connector uses a Snowflake internal temporary stage for data
exchange. If you are not currently using version 2.2.0 (or higher) of the
connector, Snowflake strongly recommends upgrading to the latest version.</p></li>
<li><p>The Snowflake Connector for Spark version is 2.2.0 (or higher), but your
jobs regularly exceed 36 hours in length. This is the maximum duration for
the Azure token used by the connector to access the internal stage for
data exchange.</p></li>
</ul>
<p>You need to prepare an Azure Blob storage container that the connector can use to
exchange data between Snowflake and Spark.</p>
<section id="using-azure-credentials">
<h3>Using Azure Credentials<a class="headerlink" href="#using-azure-credentials" title="Link to this heading">¶</a></h3>
<p>This is the standard Azure Blob storage authentication method. It requires a pair of
values: <code class="code docutils literal notranslate"><span class="pre">tempDir</span></code> (a URL) and <code class="code docutils literal notranslate"><span class="pre">temporary_azure_sas_token</span></code> values.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These values should also be used to configure Hadoop/Spark for accessing Azure Blob storage. For more information, including examples, see <a class="reference internal" href="#label-spark-azure"><span class="std std-ref">Authenticating Hadoop/Spark Using Azure</span></a> (in this topic).</p>
</div>
<p>For example:</p>
<blockquote>
<div><div class="relative group text-sm"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span><span class="p">.</span><span class="n">hadoopConfiguration</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">"fs.azure"</span><span class="p">,</span><span class="w"> </span><span class="s">"org.apache.hadoop.fs.azure.NativeAzureFileSystem"</span><span class="p">)</span>
<span class="n">sc</span><span class="p">.</span><span class="n">hadoopConfiguration</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">"fs.AbstractFileSystem.wasb.impl"</span><span class="p">,</span><span class="w"> </span><span class="s">"org.apache.hadoop.fs.azure.Wasb"</span><span class="p">)</span>
<span class="n">sc</span><span class="p">.</span><span class="n">hadoopConfiguration</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">"fs.azure.sas.&lt;container&gt;.&lt;account&gt;.&lt;azure_endpoint&gt;"</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="n">azure_sas</span><span class="o">&gt;</span><span class="p">)</span>

<span class="c1">// Then, configure your Snowflake environment</span>
<span class="c1">//</span>
<span class="kd">val</span><span class="w"> </span><span class="n">sfOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Map</span><span class="p">(</span>
<span class="w">  </span><span class="s">"sfURL"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;account_identifier&gt;.snowflakecomputing.com"</span><span class="p">,</span>
<span class="w">  </span><span class="s">"sfUser"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;user_name&gt;"</span><span class="p">,</span>
<span class="w">  </span><span class="s">"sfPassword"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;password&gt;"</span><span class="p">,</span>
<span class="w">  </span><span class="s">"sfDatabase"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;database_name&gt;"</span><span class="p">,</span>
<span class="w">  </span><span class="s">"sfSchema"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;schema_name&gt;"</span><span class="p">,</span>
<span class="w">  </span><span class="s">"sfWarehouse"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;warehouse_name&gt;"</span><span class="p">,</span>
<span class="w">  </span><span class="s">"sfCompress"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"on"</span><span class="p">,</span>
<span class="w">  </span><span class="s">"sfSSL"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"on"</span><span class="p">,</span>
<span class="w">  </span><span class="s">"tempdir"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"wasb://&lt;azure_container&gt;@&lt;azure_account&gt;.&lt;Azure_endpoint&gt;/"</span><span class="p">,</span>
<span class="w">  </span><span class="s">"temporary_azure_sas_token"</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">"&lt;azure_sas&gt;"</span>
<span class="p">)</span>
</pre></div>
</div><div data-codeblock-index="28" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
</div></blockquote>
<p>For details about the options supported by <code class="code docutils literal notranslate"><span class="pre">sfOptions</span></code>, see <a class="reference internal" href="#label-azure-options"><span class="std std-ref">Azure Options for External Data Transfer</span></a> (in this topic).</p>
<section id="authenticating-hadoop-spark-using-azure">
<span id="label-spark-azure"></span><h4>Authenticating Hadoop/Spark Using Azure<a class="headerlink" href="#authenticating-hadoop-spark-using-azure" title="Link to this heading">¶</a></h4>
<p>To use this method, modify the Scala examples in this topic to add the following Hadoop configuration options:</p>
<blockquote>
<div><div class="relative group text-sm"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">hadoopConf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sc</span><span class="p">.</span><span class="n">hadoopConfiguration</span>
<span class="n">sc</span><span class="p">.</span><span class="n">hadoopConfiguration</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">"fs.azure"</span><span class="p">,</span><span class="w"> </span><span class="s">"org.apache.hadoop.fs.azure.NativeAzureFileSystem"</span><span class="p">)</span>
<span class="n">sc</span><span class="p">.</span><span class="n">hadoopConfiguration</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">"fs.AbstractFileSystem.wasb.impl"</span><span class="p">,</span><span class="w"> </span><span class="s">"org.apache.hadoop.fs.azure.Wasb"</span><span class="p">)</span>
<span class="n">sc</span><span class="p">.</span><span class="n">hadoopConfiguration</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">"fs.azure.sas.&lt;container&gt;.&lt;account&gt;.&lt;azure_endpoint&gt;"</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="n">azure_sas</span><span class="o">&gt;</span><span class="p">)</span>
</pre></div>
</div><div data-codeblock-index="29" class="copybutton"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 384 512" class="copybutton-icon icon-copy"><path d="M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="copybutton-icon icon-copied hidden"><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg><span>Copy</span></div></div>
</div></blockquote>
<p>Make sure the <code class="code docutils literal notranslate"><span class="pre">tempdir</span></code> option uses <code class="code docutils literal notranslate"><span class="pre">wasb://</span></code> as well.</p>
</section>
</section>
</section>
<section id="authenticating-through-a-browser-is-not-supported">
<h2>Authenticating Through a Browser is Not Supported<a class="headerlink" href="#authenticating-through-a-browser-is-not-supported" title="Link to this heading">¶</a></h2>
<p>When using the Spark Connector, it is impractical to use any form of authentication that would open a browser
window to ask the user for credentials. The window would not necessarily appear on the client machine. Therefore, the
Spark Connector does not support any type of authentication, including MFA (Multi-Factor Authentication) or SSO
(Single Sign-On), that would invoke a browser window.</p>
</section>
</section>


</article><footer class="mt-24 mb-12 print:hidden"><div class="mb-8"><div class="flex"><p class="mr-4 text-primary">Was this page helpful?</p><button class="button-primary-bg rounded-md button-primary-text py-1 px-3 text-sm mr-2"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="thumbs-up" class="svg-inline--fa fa-thumbs-up pr-2" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M128 447.1V223.1c0-17.67-14.33-31.1-32-31.1H32c-17.67 0-32 14.33-32 31.1v223.1c0 17.67 14.33 31.1 32 31.1h64C113.7 479.1 128 465.6 128 447.1zM512 224.1c0-26.5-21.48-47.98-48-47.98h-146.5c22.77-37.91 34.52-80.88 34.52-96.02C352 56.52 333.5 32 302.5 32c-63.13 0-26.36 76.15-108.2 141.6L178 186.6C166.2 196.1 160.2 210 160.1 224c-.0234 .0234 0 0 0 0L160 384c0 15.1 7.113 29.33 19.2 38.39l34.14 25.59C241 468.8 274.7 480 309.3 480H368c26.52 0 48-21.47 48-47.98c0-3.635-.4805-7.143-1.246-10.55C434 415.2 448 397.4 448 376c0-9.148-2.697-17.61-7.139-24.88C463.1 347 480 327.5 480 304.1c0-12.5-4.893-23.78-12.72-32.32C492.2 270.1 512 249.5 512 224.1z"></path></svg>Yes<!-- --></button><button class="button-primary-bg rounded-md button-primary-text py-1 px-3 text-sm"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="thumbs-down" class="svg-inline--fa fa-thumbs-down pr-2" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M96 32.04H32c-17.67 0-32 14.32-32 31.1v223.1c0 17.67 14.33 31.1 32 31.1h64c17.67 0 32-14.33 32-31.1V64.03C128 46.36 113.7 32.04 96 32.04zM467.3 240.2C475.1 231.7 480 220.4 480 207.9c0-23.47-16.87-42.92-39.14-47.09C445.3 153.6 448 145.1 448 135.1c0-21.32-14-39.18-33.25-45.43C415.5 87.12 416 83.61 416 79.98C416 53.47 394.5 32 368 32h-58.69c-34.61 0-68.28 11.22-95.97 31.98L179.2 89.57C167.1 98.63 160 112.9 160 127.1l.1074 160c0 0-.0234-.0234 0 0c.0703 13.99 6.123 27.94 17.91 37.36l16.3 13.03C276.2 403.9 239.4 480 302.5 480c30.96 0 49.47-24.52 49.47-48.11c0-15.15-11.76-58.12-34.52-96.02H464c26.52 0 48-21.47 48-47.98C512 262.5 492.2 241.9 467.3 240.2z"></path></svg>No<!-- --></button></div></div><div class="grid md:grid-cols-2 xl:grid-cols-3 grid-auto justify-items-start items-start gap-x-6 gap-y-4 border-t border-b py-8"><div class="flex items-center w-full text-card-description gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 19 19" fill="none" class="fill-gray-70 dark:fill-gray-55"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.08044 9.85246C6.11896 9.72629 6.13502 9.59631 6.13211 9.46798C6.12767 9.37501 6.11608 9.28222 6.09067 9.18929C6.01427 8.90076 5.83329 8.64297 5.56208 8.48046L1.70485 6.16593C1.16033 5.84021 0.466142 6.03386 0.153636 6.59893C-0.161893 7.16313 0.0242153 7.88369 0.568731 8.21023L2.72417 9.50569L0.568731 10.7976C0.0242153 11.1247 -0.161236 11.8454 0.153636 12.4119C0.466142 12.9754 1.16033 13.1682 1.70485 12.8425L5.56208 10.5264C5.82238 10.3707 5.99903 10.1266 6.08044 9.85246ZM7.12726 12.0214C6.90562 12.0017 6.6752 12.0501 6.46792 12.1756L2.60777 14.4886C2.0647 14.815 1.87925 15.5394 2.19267 16.1046C2.50755 16.6683 3.20108 16.8624 3.74335 16.5344L5.90603 15.2381V17.8285C5.90603 18.4812 6.41412 19.01 7.04293 19.01C7.66872 19.01 8.17841 18.4812 8.17841 17.8285V13.1976C8.17841 12.5758 7.71463 12.0652 7.12726 12.0214ZM11.0804 6.98844C11.3013 7.00744 11.5311 6.95837 11.7384 6.83439L15.5977 4.51919C16.1416 4.19265 16.3261 3.47126 16.0135 2.90459C15.7002 2.34051 15.006 2.14697 14.4629 2.47323L12.3017 3.77112V1.17982C12.3017 0.528953 11.7936 0 11.1648 0C10.536 0 10.0292 0.528953 10.0292 1.17982V5.81081C10.0292 6.43187 10.4917 6.94335 11.0804 6.98844ZM2.60777 4.51919L6.46792 6.83439C6.6752 6.95837 6.90562 7.00744 7.12726 6.98844C7.71463 6.94335 8.17841 6.43187 8.17841 5.81081V1.17982C8.17841 0.528953 7.66872 0 7.04293 0C6.41412 0 5.90603 0.528953 5.90603 1.17982V3.77112L3.74335 2.47323C3.20108 2.14697 2.50755 2.34051 2.19267 2.90459C1.87925 3.47126 2.0647 4.19265 2.60777 4.51919ZM9.86206 9.49596C9.86206 9.42874 9.82287 9.33499 9.7771 9.28524L9.31254 8.80465C9.26677 8.75722 9.17654 8.71787 9.11169 8.71787H9.09367C9.02896 8.71787 8.93888 8.75722 8.89375 8.80465L8.42922 9.28524C8.38267 9.33499 8.34703 9.42874 8.34703 9.49596V9.51486C8.34703 9.58126 8.38267 9.67419 8.42922 9.7226L8.89375 10.2045C8.93952 10.2521 9.02896 10.2913 9.09367 10.2913H9.11169C9.17654 10.2913 9.26677 10.2521 9.31254 10.2045L9.7771 9.7226C9.82287 9.67419 9.86206 9.58126 9.86206 9.51486V9.49596ZM11.1444 9.95821L9.54007 11.6234C9.49416 11.6723 9.40553 11.7124 9.33873 11.7124H9.22231H8.98529H8.86692C8.8021 11.7124 8.71198 11.6723 8.66543 11.6234L7.06187 9.95821C7.01596 9.91134 6.97889 9.81703 6.97889 9.75047V9.62732V9.38104V9.25953C6.97889 9.19145 7.01596 9.09702 7.06187 9.04944L8.66543 7.3844C8.71198 7.33536 8.8021 7.29679 8.86692 7.29679H8.98529H9.22231H9.33873C9.40408 7.29679 9.49416 7.33536 9.54007 7.3844L11.1444 9.04944C11.1902 9.09702 11.2273 9.19145 11.2273 9.25953V9.38104V9.62732V9.75047C11.2273 9.81703 11.1902 9.91134 11.1444 9.95821ZM15.5977 14.4886L11.7384 12.1756C11.5311 12.0501 11.3013 12.0017 11.0804 12.0214C10.4917 12.0652 10.0292 12.5758 10.0292 13.1976V17.8285C10.0292 18.4812 10.536 19.01 11.1648 19.01C11.7936 19.01 12.3017 18.4812 12.3017 17.8285V15.2381L14.4629 16.5344C15.0059 16.8624 15.7002 16.6683 16.0135 16.1046C16.3261 15.5394 16.1416 14.815 15.5977 14.4886ZM17.6383 8.21023L15.4828 9.50569L17.6383 10.7976C18.1828 11.1247 18.3689 11.8454 18.0541 12.4119C17.74 12.9754 17.0452 13.1682 16.5028 12.8425L12.6426 10.5264C12.3852 10.3707 12.2065 10.1266 12.1272 9.85246C12.0894 9.72629 12.0719 9.59631 12.0763 9.46798C12.0785 9.37501 12.0915 9.28222 12.1162 9.18929C12.1935 8.90076 12.3745 8.64308 12.6426 8.48046L16.5028 6.16593C17.0452 5.84021 17.74 6.03386 18.0541 6.59893C18.3689 7.16313 18.1828 7.88369 17.6383 8.21023Z"></path></svg><a href="https://www.snowflake.com" class="mx-1 hover:underline hover:text-primary" target="_blank" rel="noreferrer">Visit Snowflake</a></div><div class="flex items-center w-full text-card-description gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="17" height="16" viewBox="0 0 17 16" fill="none" class="stroke-gray-70 dark:stroke-gray-55"><g clip-path="url(#clip0_2319_2428)"><path d="M8.66666 7.96667H12.4867" stroke-width="1.5" stroke-miterlimit="10"></path><path d="M10.5733 6.06006V9.88006" stroke-width="1.5" stroke-miterlimit="10"></path><path d="M15.6667 6.69999V13.7L13.76 11.7867H8.03332C7.46874 11.7882 6.91974 11.6016 6.47305 11.2563C6.02635 10.911 5.70743 10.4267 5.56666 9.87999C5.51029 9.66234 5.48339 9.43812 5.48666 9.21332V6.69999C5.48666 6.02457 5.75497 5.37681 6.23256 4.89922C6.71015 4.42163 7.35791 4.15332 8.03332 4.15332H13.12C13.7954 4.15332 14.4432 4.42163 14.9208 4.89922C15.3983 5.37681 15.6667 6.02457 15.6667 6.69999Z" stroke-width="1.5" stroke-miterlimit="10"></path><path d="M11.8467 3.51334V4.18001H8.03332C7.35791 4.18001 6.71015 4.44832 6.23256 4.92591C5.75497 5.4035 5.48666 6.05126 5.48666 6.72668V8.63334H3.57332L1.66666 10.5133V3.51334C1.66666 2.83792 1.93497 2.19017 2.41256 1.71258C2.89015 1.23498 3.53791 0.966675 4.21332 0.966675H9.33332C10.0029 0.97544 10.6422 1.24761 11.1126 1.72426C11.583 2.20091 11.8467 2.84366 11.8467 3.51334Z" stroke-width="1.5" stroke-miterlimit="10"></path></g><defs><clipPath id="clip0_2319_2428"><rect width="16" height="16" fill="white" transform="translate(0.666656)"></rect></clipPath></defs></svg><a href="https://community.snowflake.com/s/" class="mx-1 hover:underline hover:text-primary" target="_blank" rel="noreferrer">Join the conversation</a></div><div class="flex items-center w-full text-card-description gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="17" height="16" viewBox="0 0 17 16" fill="none" class="stroke-gray-70 dark:stroke-gray-55"><path d="M6.4267 10.5467L4.51337 8.64002L6.4267 6.72668" stroke-width="1.5" stroke-miterlimit="10"></path><path d="M10.2401 10.5467L12.1534 8.64002L10.2401 6.72668" stroke-width="1.5" stroke-miterlimit="10"></path><path d="M8.96671 6.72668L7.70004 10.5467" stroke-width="1.5" stroke-miterlimit="10"></path><path d="M14.0601 4.18V15H2.60672V1H10.8801L14.0601 4.18Z" stroke-width="1.5" stroke-miterlimit="10"></path><path d="M14.0601 4.18V4.82H10.2401V1H10.8801L14.0601 4.18Z" stroke-width="1.5" stroke-miterlimit="10"></path></svg><a href="https://developers.snowflake.com" class="mx-1 hover:underline hover:text-primary" target="_blank" rel="noreferrer">Develop with Snowflake</a></div><div class="flex items-center w-full text-card-description gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" class="stroke-gray-70 dark:stroke-gray-55"><path d="M7.99999 6.09338L8.39332 6.92672L9.27332 7.06672L8.63999 7.71338L8.78665 8.64005L7.99999 8.20005L7.21332 8.64005L7.35999 7.71338L6.72665 7.06672L7.60665 6.92672L7.99999 6.09338Z" fill="#5D6A85"></path><path d="M11.82 6.09338L12.2133 6.92672L13.0933 7.06672L12.4533 7.71338L12.6067 8.64005L11.82 8.20005L11.0333 8.64005L11.18 7.71338L10.5467 7.06672L11.4267 6.92672L11.82 6.09338Z" fill="#5D6A85"></path><path d="M4.18001 6.09338L4.57334 6.92672L5.45334 7.06672L4.82001 7.71338L4.96668 8.64005L4.18001 8.20005L3.39334 8.64005L3.54668 7.71338L2.90668 7.06672L3.78668 6.92672L4.18001 6.09338Z" fill="#5D6A85"></path><path d="M1 5.45339V9.27339C1 9.6111 1.13415 9.93497 1.37295 10.1738C1.61175 10.4126 1.93562 10.5467 2.27333 10.5467H6.72667L8 11.8201L9.27333 10.5467H13.7267C14.0644 10.5467 14.3883 10.4126 14.6271 10.1738C14.8658 9.93497 15 9.6111 15 9.27339V5.45339C15 5.11568 14.8658 4.7918 14.6271 4.553C14.3883 4.31421 14.0644 4.18005 13.7267 4.18005H2.27333C1.93562 4.18005 1.61175 4.31421 1.37295 4.553C1.13415 4.7918 1 5.11568 1 5.45339Z" stroke-width="1.5" stroke-miterlimit="10"></path></svg><a href="/feedback" class="mx-1 hover:underline hover:text-primary">Share your feedback</a></div><div class="flex items-center w-full text-card-description gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="17" height="16" viewBox="0 0 17 16" fill="none" class="stroke-gray-70 dark:stroke-gray-55"><g clip-path="url(#clip0_2319_2368)"><path d="M4.15999 7.3866H13.1067" stroke-width="1.5" stroke-miterlimit="10"></path><path d="M4.15999 12.5066H13.1067" stroke-width="1.5" stroke-miterlimit="10"></path><path d="M4.15999 9.94666H13.1067" stroke-width="1.5" stroke-miterlimit="10"></path><path d="M15.6667 0.993286H1.59999V15.06H15.6667V0.993286Z" stroke-width="1.5" stroke-miterlimit="10"></path><path d="M15.6667 4.83329H11.4867H10.2067H1.59999V0.993286H15.6667V4.83329Z" stroke-width="1.5" stroke-miterlimit="10"></path><path d="M3.51999 2.91333H4.79999" stroke-width="1.5" stroke-miterlimit="10"></path><path d="M6.07332 2.91333H7.35332" stroke-width="1.5" stroke-miterlimit="10"></path><path d="M8.63332 2.91333H9.91332" stroke-width="1.5" stroke-miterlimit="10"></path></g><defs><clipPath id="clip0_2319_2368"><rect width="16" height="16" fill="white" transform="translate(0.666656)"></rect></clipPath></defs></svg><a href="https://www.snowflake.com/blog/" class="mx-1 hover:underline hover:text-primary" target="_blank" rel="noreferrer">Read the latest on our blog</a></div><div class="flex items-center w-full text-card-description gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="17" height="16" viewBox="0 0 17 16" fill="none" class="stroke-gray-70 dark:stroke-gray-55"><g clip-path="url(#clip0_2319_1117)"><path d="M15.3334 0.986694H1.33337V11.1667H15.3334V0.986694Z" stroke-width="1.5" stroke-miterlimit="10"></path><path d="M11.5134 11.1667C12.5664 11.1667 13.4201 10.3131 13.4201 9.26006C13.4201 8.20704 12.5664 7.35339 11.5134 7.35339C10.4604 7.35339 9.60672 8.20704 9.60672 9.26006C9.60672 10.3131 10.4604 11.1667 11.5134 11.1667Z" stroke-width="1.5" stroke-miterlimit="10"></path><path d="M10.2401 11.1666H12.7867V14.3466L11.5134 13.7133L10.2401 14.3466V11.1666Z" stroke-width="1.5" stroke-miterlimit="10"></path><path d="M3.88004 4.16663H12.7867" stroke-width="1.5" stroke-miterlimit="10"></path><path d="M3.88004 7.34668H8.33337" stroke-width="1.5" stroke-miterlimit="10"></path></g><defs><clipPath id="clip0_2319_1117"><rect width="16" height="16" fill="white" transform="translate(0.333374)"></rect></clipPath></defs></svg><a href="https://learn.snowflake.com" class="mx-1 hover:underline hover:text-primary" target="_blank" rel="noreferrer">Get your own certification</a></div></div><div class="pt-8 md:flex justify-between"><div class="flex space-x-4 text-xs mb-4 md:mb-0 text-secondary"><a href="https://www.snowflake.com/privacy-policy/" class="hover:text-primary hover:underline">Privacy Notice</a><a href="https://www.snowflake.com/legal/snowflake-site-terms/" class="hover:text-primary hover:underline">Site Terms</a><span>© <!-- -->2024<!-- --> Snowflake, Inc. <!-- -->All Rights Reserved<!-- -->.<!-- --></span></div></div></footer></div><aside class="w-full xl:w-64 text-sm xl:sticky xl:top-8 xl:pb-16 block xl:pl-8 max-h-[calc(100vh-107px)] overflow-y-auto mb-4 md:mb-0 print:hidden"><div class="mb-4 md:mb-8 onthispage border md:border-0 rounded-md px-3 py-2 md:p-0" role="complementary"><label for="on-this-page-checkbox"><div class="flex items-center"><div class="block md:hidden mr-2"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="caret-right" class="svg-inline--fa fa-caret-right " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><path fill="currentColor" d="M118.6 105.4l128 127.1C252.9 239.6 256 247.8 256 255.1s-3.125 16.38-9.375 22.63l-128 127.1c-9.156 9.156-22.91 11.9-34.88 6.943S64 396.9 64 383.1V128c0-12.94 7.781-24.62 19.75-29.58S109.5 96.23 118.6 105.4z"></path></svg></div><p class="font-semibold text-header">On this page</p></div></label><input type="checkbox" id="on-this-page-checkbox" class="peer hidden"/><ol class="hidden peer-checked:block md:block"><li class="my-3 break-words hover:underline "><a href="#verifying-the-network-connection-to-snowflake-with-snowcd">Verifying the Network Connection to Snowflake with SnowCD</a></li><li class="my-3 break-words hover:underline "><a href="#pushdown">Pushdown</a></li><li class="my-3 break-words hover:underline "><a href="#using-the-connector-in-scala">Using the Connector in Scala</a></li><li class="my-3 break-words hover:underline "><a href="#using-the-connector-with-python">Using the Connector with Python</a></li><li class="my-3 break-words hover:underline "><a href="#data-type-mappings">Data Type Mappings</a></li><li class="my-3 break-words hover:underline "><a href="#calling-the-dataframe-show-method">Calling the DataFrame.show Method</a></li><li class="my-3 break-words hover:underline "><a href="#setting-configuration-options-for-the-connector">Setting Configuration Options for the Connector</a></li><li class="my-3 break-words hover:underline "><a href="#passing-snowflake-session-parameters-as-options-for-the-connector">Passing Snowflake Session Parameters as Options for the Connector</a></li><li class="my-3 break-words hover:underline "><a href="#security-considerations">Security Considerations</a></li><li class="my-3 break-words hover:underline "><a href="#authenticating-s3-for-data-exchange">Authenticating S3 for Data Exchange</a></li><li class="my-3 break-words hover:underline "><a href="#authenticating-azure-for-data-exchange">Authenticating Azure for Data Exchange</a></li><li class="my-3 break-words hover:underline "><a href="#authenticating-through-a-browser-is-not-supported">Authenticating Through a Browser is Not Supported</a></li></ol></div><div class="text-sm bg-level-2 rounded-lg p-4 related-info"><p class="font-semibold mb-2 text-header">Related info</p><div>


<ul class="simple">
<li><p><a class="reference external" href="https://www.snowflake.com/snowflake-and-spark-part-1-why-spark/">Why Spark?</a> (Snowflake Blog)</p></li>
<li><p><a class="reference external" href="https://www.snowflake.com/snowflake-spark-part-2-pushing-query-processing/">Pushing Spark Query Processing to Snowflake</a> (Snowflake Blog)</p></li>
</ul>
</div></div></aside></div></div></main><div id="overlay-root" class="lg:hidden"></div></div><div id="popup-root"></div></div><div class="bottom-10 right-10 z-90 fixed print:hidden" id="language-picker"><div class="text-xs relative group"><div class="cursor-pointer bg-level-3 px-4 py-3 rounded-md">Language<!-- -->: <!-- --><strong>English</strong></div><ul class="list-group"><div class="z-50 px-4 py-1 w-28 rounded-lg bg-level-2 drop-shadow-xl group-hover:flex hidden flex flex-wrap-reverse absolute right-0 bottom-10 animate-fade-in-up"><li class="my-2 w-full text-right text-link"><a href="/en/user-guide/spark-connector-use" class="hover:text-link">English</a></li><li class="my-2 w-full text-right "><a href="/fr/user-guide/spark-connector-use" class="hover:text-link">Français</a></li><li class="my-2 w-full text-right "><a href="/de/user-guide/spark-connector-use" class="hover:text-link">Deutsch</a></li><li class="my-2 w-full text-right "><a href="/ja/user-guide/spark-connector-use" class="hover:text-link">日本語</a></li><li class="my-2 w-full text-right "><a href="/ko/user-guide/spark-connector-use" class="hover:text-link">한국어</a></li><li class="my-2 w-full text-right "><a href="/pt/user-guide/spark-connector-use" class="hover:text-link">Português</a></li></div></ul></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"content":"\n\n\n  \n  \u003csection id=\"using-the-spark-connector\"\u003e\n\u003ch1\u003eUsing the Spark Connector\u003ca class=\"headerlink\" href=\"#using-the-spark-connector\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h1\u003e\n\n\u003cp\u003eThe connector adheres to the standard Spark API, but with the addition of Snowflake-specific options, which are described in this topic.\u003c/p\u003e\n\u003cp\u003eIn this topic, the term COPY refers to both:\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003e\u003ca class=\"reference internal\" href=\"../sql-reference/sql/copy-into-table\"\u003e\u003cspan class=\"doc\"\u003eCOPY INTO \u0026lt;table\u0026gt;\u003c/span\u003e\u003c/a\u003e (used to transfer data from an internal or external stage into a table).\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ca class=\"reference internal\" href=\"../sql-reference/sql/copy-into-location\"\u003e\u003cspan class=\"doc\"\u003eCOPY INTO \u0026lt;location\u0026gt;\u003c/span\u003e\u003c/a\u003e (used to transfer data from a table into an internal or external stage).\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003csection id=\"verifying-the-network-connection-to-snowflake-with-snowcd\"\u003e\n\u003cspan id=\"label-snowcd-spark\"\u003e\u003c/span\u003e\u003ch2\u003eVerifying the Network Connection to Snowflake with SnowCD\u003ca class=\"headerlink\" href=\"#verifying-the-network-connection-to-snowflake-with-snowcd\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eAfter configuring your driver, you can evaluate and troubleshoot your network connectivity to Snowflake using \u003ca class=\"reference internal\" href=\"snowcd\"\u003e\u003cspan class=\"doc\"\u003eSnowCD\u003c/span\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eYou can use SnowCD during the initial configuration process and on-demand at any time to evaluate and troubleshoot your network connection to Snowflake.\u003c/p\u003e\n\u003c/section\u003e\n\u003csection id=\"pushdown\"\u003e\n\u003cspan id=\"label-spark-pushdown\"\u003e\u003c/span\u003e\u003ch2\u003ePushdown\u003ca class=\"headerlink\" href=\"#pushdown\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eThe Spark Connector applies predicate and query pushdown by capturing and analyzing the Spark logical plans for SQL operations. When the data source is Snowflake, the operations are translated into a SQL query and then executed in Snowflake to improve performance.\u003c/p\u003e\n\u003cp\u003eHowever, because this translation requires almost a one-to-one translation of Spark SQL operators to Snowflake expressions, not all of Spark SQL operators can be pushed down. When pushdown fails, the connector falls back to a less-optimized execution plan. The unsupported operations are instead performed in Spark.\u003c/p\u003e\n\u003cdiv class=\"admonition note\"\u003e\n\u003cp class=\"admonition-title\"\u003eNote\u003c/p\u003e\n\u003cp\u003eIf you need pushdown for all operations, consider writing your code to use \u003ca class=\"reference internal\" href=\"../developer-guide/snowpark/index\"\u003e\u003cspan class=\"doc\"\u003eSnowpark API\u003c/span\u003e\u003c/a\u003e instead.\u003c/p\u003e\n\u003c/div\u003e\n\u003cp\u003eBelow is a list of supported operations for pushdown (all functions below use their Spark names). If a function is not in this list, a Spark plan that utilizes it might be executed on Spark rather than pushed down into Snowflake.\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003eAggregation Functions\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003eAverage\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eCorr\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eCovPopulation\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eCovSample\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eCount\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eMax\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eMin\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eStddevPop\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eStddevSamp\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eSum\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eVariancePop\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eVarianceSamp\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eBoolean Operators\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003eAnd\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eBetween\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eContains\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eEndsWith\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eEqualTo\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eGreaterThan\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eGreaterThanOrEqual\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eIn\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eIsNull\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eIsNotNull\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eLessThan\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eLessThanOrEqual\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eNot\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eOr\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eStartsWith\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eDate, Time, and Timestamp Functions\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003eDateAdd\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eDateSub\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eMonth\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eQuarter\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eTruncDate\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eTruncTimestamp\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eYear\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eMathematical Functions\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003eArithmetic operators ‘+’ (addition), ‘-’ (subtraction), ‘*’ (multiplication), ‘/’ (division), and ‘-’ (unary negation).\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eAbs\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eAcos\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eAsin\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eAtan\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eCeil\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eCheckOverflow\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eCos\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eCosh\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eExp\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eFloor\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eGreatest\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eLeast\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eLog\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003ePi\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003ePow\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003ePromotePrecision\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eRand\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eRound\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eSin\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eSinh\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eSqrt\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eTan\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eTanh\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eMiscellaneous Operators\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003eAlias (AS expressions)\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eBitwiseAnd\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eBitwiseNot\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eBitwiseOr\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eBitwiseXor\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eCaseWhen\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eCast(child, t, _)\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eCoalesce\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eIf\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eMakeDecimal\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eScalarSubquery\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eShiftLeft\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eShiftRight\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eSortOrder\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eUnscaledValue\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eRelational Operators\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003eAggregate functions and group-by clauses\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eDistinct\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eFilters\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eIn\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eInSet\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eJoins\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eLimits\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eProjections\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eSorts (ORDER BY)\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eUnion and Union All\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eWindow functions and windowing-clauses\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eString Functions\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003eAscii\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eConcat(children)\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eLength\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eLike\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eLower\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eStringLPad\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eStringRPad\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eStringTranslate\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eStringTrim\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eStringTrimLeft\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eStringTrimRight\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eSubstring\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eUpper\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eWindow Functions (note: these do not work with Spark 2.2)\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003eDenseRank\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eRank\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eRowNumber\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/section\u003e\n\u003csection id=\"using-the-connector-in-scala\"\u003e\n\u003ch2\u003eUsing the Connector in Scala\u003ca class=\"headerlink\" href=\"#using-the-connector-in-scala\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h2\u003e\n\u003csection id=\"specifying-the-data-source-class-name\"\u003e\n\u003cspan id=\"label-spark-data-source\"\u003e\u003c/span\u003e\u003ch3\u003eSpecifying the Data Source Class Name\u003ca class=\"headerlink\" href=\"#specifying-the-data-source-class-name\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eTo use Snowflake as a data source in Spark, use the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e.format\u003c/span\u003e\u003c/code\u003e option to provide the Snowflake connector class name that defines the data source.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003enet.snowflake.spark.snowflake\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003cp\u003eTo ensure a compile-time check of the class name, Snowflake highly recommends defining a variable for the class name. For example:\u003c/p\u003e\n\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-scala notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"kd\"\u003eval\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nc\"\u003eSNOWFLAKE_SOURCE_NAME\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"net.snowflake.spark.snowflake\"\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"0\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003cp\u003eAlso, for convenience, the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eUtils\u003c/span\u003e\u003c/code\u003e class provides the variable, which can be imported as follows:\u003c/p\u003e\n\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-scala notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nn\"\u003enet\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nn\"\u003esnowflake\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nn\"\u003espark\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nn\"\u003esnowflake\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003eUtils\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003eSNOWFLAKE_SOURCE_NAME\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"1\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003cdiv class=\"admonition note\"\u003e\n\u003cp class=\"admonition-title\"\u003eNote\u003c/p\u003e\n\u003cp\u003eAll examples in this topic use \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eSNOWFLAKE_SOURCE_NAME\u003c/span\u003e\u003c/code\u003e as the class definition.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/section\u003e\n\u003csection id=\"enabling-disabling-pushdown-in-a-session\"\u003e\n\u003ch3\u003eEnabling/Disabling Pushdown in a Session\u003ca class=\"headerlink\" href=\"#enabling-disabling-pushdown-in-a-session\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eVersion 2.1.0 (and higher) of the connector supports query pushdown, which can significantly improve performance by pushing query processing to Snowflake when Snowflake is the Spark data source.\u003c/p\u003e\n\u003cp\u003eBy default, pushdown is enabled.\u003c/p\u003e\n\u003cp\u003eTo disable pushdown within a Spark session for a given DataFrame:\u003c/p\u003e\n\u003col class=\"arabic\"\u003e\n\u003cli\u003e\u003cp\u003eAfter instantiating a \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eSparkSession\u003c/span\u003e\u003c/code\u003e object, call the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eSnowflakeConnectorUtils.disablePushdownSession\u003c/span\u003e\u003c/code\u003e static\nmethod, passing in the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eSparkSession\u003c/span\u003e\u003c/code\u003e object. For example:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-scala notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"nc\"\u003eSnowflakeConnectorUtils\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edisablePushdownSession\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003espark\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"2\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003cp\u003eWhere \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003espark\u003c/span\u003e\u003c/code\u003e is your \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eSparkSession\u003c/span\u003e\u003c/code\u003e object.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eCreate a DataFrame with the \u003ca class=\"reference internal\" href=\"#label-spark-options-autopushdown\"\u003e\u003cspan class=\"std std-ref\"\u003eautopushdown\u003c/span\u003e\u003c/a\u003e option set to \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoff\u003c/span\u003e\u003c/code\u003e. For example:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-scala notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"kd\"\u003eval\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edf\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esparkSession\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eread\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eformat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eSNOWFLAKE_SOURCE_NAME\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esfOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoption\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"query\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003equery\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoption\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"autopushdown\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"off\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eload\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"3\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003cp\u003eNote that you can also set the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eautopushdown\u003c/span\u003e\u003c/code\u003e option in a \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eMap\u003c/span\u003e\u003c/code\u003e that you pass to the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoptions\u003c/span\u003e\u003c/code\u003e method (e.g.\nin \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfOptions\u003c/span\u003e\u003c/code\u003e in the example above).\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eTo enable pushdown again after disabling it, call the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eSnowflakeConnectorUtils.enablePushdownSession\u003c/span\u003e\u003c/code\u003e static method\n(passing in the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eSparkSession\u003c/span\u003e\u003c/code\u003e object), and create a DataFrame with \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eautopushdown\u003c/span\u003e\u003c/code\u003e enabled.\u003c/p\u003e\n\u003c/section\u003e\n\u003csection id=\"moving-data-from-snowflake-to-spark\"\u003e\n\u003ch3\u003eMoving Data from Snowflake to Spark\u003ca class=\"headerlink\" href=\"#moving-data-from-snowflake-to-spark\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h3\u003e\n\u003cdiv class=\"admonition note\"\u003e\n\u003cp class=\"admonition-title\"\u003eNote\u003c/p\u003e\n\u003cp\u003eWhen using DataFrames, the Snowflake connector supports SELECT queries only.\u003c/p\u003e\n\u003c/div\u003e\n\u003cp\u003eTo read data from Snowflake into a Spark DataFrame:\u003c/p\u003e\n\u003col class=\"arabic simple\"\u003e\n\u003cli\u003e\u003cp\u003eUse the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eread()\u003c/span\u003e\u003c/code\u003e method of the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eSqlContext\u003c/span\u003e\u003c/code\u003e object to construct a \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eDataFrameReader\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eSpecify \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eSNOWFLAKE_SOURCE_NAME\u003c/span\u003e\u003c/code\u003e using the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eformat()\u003c/span\u003e\u003c/code\u003e method. For the definition, see \u003ca class=\"reference internal\" href=\"#label-spark-data-source\"\u003e\u003cspan class=\"std std-ref\"\u003eSpecifying the Data Source Class Name\u003c/span\u003e\u003c/a\u003e (in this topic).\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eSpecify the connector options using either the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoption()\u003c/span\u003e\u003c/code\u003e or \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoptions()\u003c/span\u003e\u003c/code\u003e method. For more information, see \u003ca class=\"reference internal\" href=\"#label-spark-options\"\u003e\u003cspan class=\"std std-ref\"\u003eSetting Configuration Options for the Connector\u003c/span\u003e\u003c/a\u003e (in this topic).\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eSpecify one of the following options for the table data to be read:\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003edbtable\u003c/span\u003e\u003c/code\u003e: The name of the table to be read. All columns and records are retrieved (i.e. it is equivalent to \u003ccode class=\"samp docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"pre\"\u003e*\u003c/span\u003e \u003cspan class=\"pre\"\u003eFROM\u003c/span\u003e \u003cem\u003e\u003cspan class=\"pre\"\u003edb_table\u003c/span\u003e\u003c/em\u003e\u003c/code\u003e).\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003equery\u003c/span\u003e\u003c/code\u003e: The exact query (SELECT statement) to run.\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003csection id=\"usage-notes\"\u003e\n\u003ch4\u003eUsage Notes\u003ca class=\"headerlink\" href=\"#usage-notes\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h4\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003eCurrently, the connector does not support other types of queries (e.g. SHOW or DESC, or DML statements) when using DataFrames.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eThere is an upper limit to the size of an individual row. For more details, see \u003ca class=\"reference internal\" href=\"query-size-limits\"\u003e\u003cspan class=\"doc\"\u003eLimits on Query Text Size\u003c/span\u003e\u003c/a\u003e.\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/section\u003e\n\u003csection id=\"performance-considerations\"\u003e\n\u003ch4\u003ePerformance Considerations\u003ca class=\"headerlink\" href=\"#performance-considerations\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h4\u003e\n\u003cp\u003eWhen transferring data between Snowflake and Spark, use the following methods to analyze/improve performance:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003eUse the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003enet.snowflake.spark.snowflake.Utils.getLastSelect()\u003c/span\u003e\u003c/code\u003e method to see the actual query issued when moving data from Snowflake to Spark.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eIf you use the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003efilter\u003c/span\u003e\u003c/code\u003e or \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ewhere\u003c/span\u003e\u003c/code\u003e functionality of the Spark DataFrame, check that the respective filters are present in the issued SQL query. The Snowflake connector tries to translate all the\nfilters requested by Spark to SQL.\u003c/p\u003e\n\u003cp\u003eHowever, there are forms of filters that the Spark infrastructure today does not pass to the Snowflake connector. As a result, in some situations, a large number of unnecessary records are requested from\nSnowflake.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eIf you need only a subset of columns, make sure the reflect the subset in the SQL query.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eIn general, if the SQL query issued does not match what you expect based on the DataFrame operations, use the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003equery\u003c/span\u003e\u003c/code\u003e option to provide the exact SQL syntax you want.\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/section\u003e\n\u003csection id=\"examples\"\u003e\n\u003ch4\u003eExamples\u003ca class=\"headerlink\" href=\"#examples\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h4\u003e\n\u003cp\u003eRead an entire table:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-scala notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"kd\"\u003eval\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edf\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nc\"\u003eDataFrame\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esqlContext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eread\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eformat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eSNOWFLAKE_SOURCE_NAME\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esfOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoption\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"dbtable\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"t1\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eload\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"4\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003cp\u003eRead the results of a query:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-scala notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"kd\"\u003eval\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edf\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nc\"\u003eDataFrame\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esqlContext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eread\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eformat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eSNOWFLAKE_SOURCE_NAME\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esfOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoption\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"query\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"SELECT DEPT, SUM(SALARY) AS SUM_SALARY FROM T1\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eload\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"5\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003csection id=\"moving-data-from-spark-to-snowflake\"\u003e\n\u003ch3\u003eMoving Data from Spark to Snowflake\u003ca class=\"headerlink\" href=\"#moving-data-from-spark-to-snowflake\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eThe steps for saving the contents of a DataFrame to a Snowflake table are similar to writing from Snowflake to Spark:\u003c/p\u003e\n\u003col class=\"arabic\"\u003e\n\u003cli\u003e\u003cp\u003eUse the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ewrite()\u003c/span\u003e\u003c/code\u003e method of the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eDataFrame\u003c/span\u003e\u003c/code\u003e to construct a \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eDataFrameWriter\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eSpecify \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eSNOWFLAKE_SOURCE_NAME\u003c/span\u003e\u003c/code\u003e using the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eformat()\u003c/span\u003e\u003c/code\u003e method. For the definition, see \u003ca class=\"reference internal\" href=\"#label-spark-data-source\"\u003e\u003cspan class=\"std std-ref\"\u003eSpecifying the Data Source Class Name\u003c/span\u003e\u003c/a\u003e (in this topic).\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eSpecify the connector options using either the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoption()\u003c/span\u003e\u003c/code\u003e or \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoptions()\u003c/span\u003e\u003c/code\u003e method. For more information, see \u003ca class=\"reference internal\" href=\"#label-spark-options\"\u003e\u003cspan class=\"std std-ref\"\u003eSetting Configuration Options for the Connector\u003c/span\u003e\u003c/a\u003e (in this topic).\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eUse the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003edbtable\u003c/span\u003e\u003c/code\u003e option to specify the table to which data is written.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eUse the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003emode()\u003c/span\u003e\u003c/code\u003e method to specify the save mode for the content.\u003c/p\u003e\n\u003cp\u003eFor more information, see \u003ca class=\"reference external\" href=\"https://spark.apache.org/docs/1.6.0/api/java/org/apache/spark/sql/SaveMode.html\"\u003eSaveMode\u003c/a\u003e (Spark documentation).\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003csection id=\"id1\"\u003e\n\u003ch4\u003eExamples\u003ca class=\"headerlink\" href=\"#id1\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-scala notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003edf\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ewrite\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eformat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eSNOWFLAKE_SOURCE_NAME\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esfOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoption\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"dbtable\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"t2\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eSaveMode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003eOverwrite\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esave\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"6\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003csection id=\"exporting-json-from-spark-to-snowflake\"\u003e\n\u003cspan id=\"label-spark-json\"\u003e\u003c/span\u003e\u003ch3\u003eExporting JSON from Spark to Snowflake\u003ca class=\"headerlink\" href=\"#exporting-json-from-spark-to-snowflake\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eSpark DataFrames can contain JSON objects, serialized as strings. The following code provides an example of converting a regular DataFrame to a DataFrame containing JSON data:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-scala notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"kd\"\u003eval\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003erdd\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emyDataFrame\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etoJSON\u003c/span\u003e\n\u003cspan class=\"kd\"\u003eval\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eschema\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nc\"\u003eStructType\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eStructField\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"JSON\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nc\"\u003eStringType\u003c/span\u003e\u003cspan class=\"p\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"kd\"\u003eval\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ejsonDataFrame\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esqlContext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecreateDataFrame\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003cspan class=\"w\"\u003e            \u003c/span\u003e\u003cspan class=\"n\"\u003erdd\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nc\"\u003eRow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e)),\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eschema\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"7\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003cp\u003eNote that the resulting \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ejsonDataFrame\u003c/span\u003e\u003c/code\u003e contains a single column of type \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eStringType\u003c/span\u003e\u003c/code\u003e. As a result, when this DataFrame is exported to Snowflake with the common \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eSaveMode.Overwrite\u003c/span\u003e\u003c/code\u003e mode, a new table in Snowflake is created with a single column of type \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eVARCHAR\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eTo load \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ejsonDataFrame\u003c/span\u003e\u003c/code\u003e into a \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eVARIANT\u003c/span\u003e\u003c/code\u003e column:\u003c/p\u003e\n\u003col class=\"arabic\"\u003e\n\u003cli\u003e\u003cp\u003eCreate a Snowflake table (connecting to Snowflake in Java using the Snowflake JDBC Driver). For explanations of the\nconnection parameters used in the example, see \u003ca class=\"reference internal\" href=\"../developer-guide/jdbc/jdbc-parameters\"\u003e\u003cspan class=\"doc\"\u003eJDBC Driver connection parameter reference\u003c/span\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-java notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nn\"\u003ejava.sql.Connection\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nn\"\u003ejava.sql.DriverManager\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nn\"\u003ejava.sql.ResultSet\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nn\"\u003ejava.sql.ResultSetMetaData\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nn\"\u003ejava.sql.SQLException\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nn\"\u003ejava.sql.Statement\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nn\"\u003ejava.util.Properties\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kd\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eSnowflakeJDBCExample\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kd\"\u003estatic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eString\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kd\"\u003ethrows\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eException\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eString\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ejdbcUrl\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"jdbc:snowflake://myorganization-myaccount.snowflakecomputing.com/\"\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eProperties\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eproperties\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eProperties\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eproperties\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eput\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"user\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"peter\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eproperties\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eput\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"password\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"test\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eproperties\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eput\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"account\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"myorganization-myaccount\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eproperties\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eput\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"warehouse\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"mywh\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eproperties\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eput\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"db\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"mydb\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eproperties\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eput\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"schema\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"public\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"c1\"\u003e// get connection\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eout\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Create JDBC connection\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eConnection\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003econnection\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eDriverManager\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetConnection\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ejdbcUrl\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eproperties\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eout\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Done creating JDBC connection\\n\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"c1\"\u003e// create statement\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eout\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Create JDBC statement\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eStatement\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003estatement\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003econnection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ecreateStatement\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eout\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Done creating JDBC statement\\n\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"c1\"\u003e// create a table\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eout\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Create my_variant_table table\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003estatement\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eexecuteUpdate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"create or replace table my_variant_table(json VARIANT)\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003estatement\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eclose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eout\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Done creating demo table\\n\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003econnection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eclose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eout\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Close connection\\n\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"8\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eInstead of using \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eSaveMode.Overwrite\u003c/span\u003e\u003c/code\u003e, use \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eSaveMode.Append\u003c/span\u003e\u003c/code\u003e, to reuse the existing table. When the string value representing JSON is loaded into Snowflake, because the target column is of type VARIANT, it is parsed as JSON. For example:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-scala notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003edf\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ewrite\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eformat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eSNOWFLAKE_SOURCE_NAME\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esfOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoption\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"dbtable\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"my_variant_table\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eSaveMode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003eAppend\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esave\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"9\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/section\u003e\n\u003csection id=\"executing-ddl-dml-sql-statements\"\u003e\n\u003ch3\u003eExecuting DDL/DML SQL Statements\u003ca class=\"headerlink\" href=\"#executing-ddl-dml-sql-statements\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eUse the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003erunQuery()\u003c/span\u003e\u003c/code\u003e method of the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eUtils\u003c/span\u003e\u003c/code\u003e object to execute DDL/DML SQL statements, in addition to queries, for example:\u003c/p\u003e\n\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-scala notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esfOptions\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nc\"\u003eMap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfURL\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;account_identifier\u0026gt;.snowflakecomputing.com\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfUser\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;user_name\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfPassword\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;password\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfDatabase\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;database\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfSchema\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;schema\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfWarehouse\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;warehouse\u0026gt;\"\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"nc\"\u003eUtils\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erunQuery\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esfOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"CREATE TABLE MY_TABLE(A INTEGER)\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"10\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003cp\u003ewhere \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfOptions\u003c/span\u003e\u003c/code\u003e is the parameters map used to read/write DataFrames.\u003c/p\u003e\n\u003cp\u003eThe \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003erunQuery\u003c/span\u003e\u003c/code\u003e method returns only TRUE or FALSE. It is intended for statements that do not return a result set,\nfor example DDL statements like \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eCREATE\u003c/span\u003e \u003cspan class=\"pre\"\u003eTABLE\u003c/span\u003e\u003c/code\u003e and DML statements like \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eINSERT\u003c/span\u003e\u003c/code\u003e, \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eUPDATE\u003c/span\u003e\u003c/code\u003e, and \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eDELETE\u003c/span\u003e\u003c/code\u003e.\nIt is not useful for statements that return a result set, such as \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eSELECT\u003c/span\u003e\u003c/code\u003e or \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eSHOW\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/section\u003e\n\u003csection id=\"working-with-timestamps-and-time-zones\"\u003e\n\u003cspan id=\"label-spark-timestamps\"\u003e\u003c/span\u003e\u003ch3\u003eWorking with Timestamps and Time Zones\u003ca class=\"headerlink\" href=\"#working-with-timestamps-and-time-zones\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eSpark provides only one type of timestamp, equivalent to the Scala/Java Timestamp type. It is almost identical in behavior to the TIMESTAMP_LTZ (local time zone) data type in Snowflake. As such, when transferring data between Spark and Snowflake, Snowflake recommends using the following approaches to preserve time correctly, relative to time zones:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003eUse only the TIMESTAMP_LTZ data type in Snowflake.\u003c/p\u003e\n\u003cdiv class=\"admonition note\"\u003e\n\u003cp class=\"admonition-title\"\u003eNote\u003c/p\u003e\n\u003cp\u003eThe default timestamp data type mapping is TIMESTAMP_NTZ (no time zone), so you \u003cspan class=\"emph\"\u003emust\u003c/span\u003e explicitly set the \u003ca class=\"reference internal\" href=\"../sql-reference/parameters.html#label-timestamp-type-mapping\"\u003e\u003cspan class=\"std std-ref\"\u003eTIMESTAMP_TYPE_MAPPING\u003c/span\u003e\u003c/a\u003e parameter to use TIMESTAMP_LTZ.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eSet the Spark time zone to \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eUTC\u003c/span\u003e\u003c/code\u003e and use this time zone in Snowflake (i.e. don’t set the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfTimezone\u003c/span\u003e\u003c/code\u003e option for the connector, and don’t explicitly set a time zone in Snowflake). In this scenario, TIMESTAMP_LTZ and TIMESTAMP_NTZ are effectively equivalent.\u003c/p\u003e\n\u003cp\u003eTo set the time zone, add the following line to your Spark code:\u003c/p\u003e\n\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-bash notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003ejava.util.TimeZone.setDefault\u003cspan class=\"o\"\u003e(\u003c/span\u003ejava.util.TimeZone.getTimeZone\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"UTC\"\u003c/span\u003e\u003cspan class=\"o\"\u003e))\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"11\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIf you don’t implement either of these approaches, undesired time modifications might occur. For example, consider the following scenario:\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003eThe time zone in Spark is set to \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eAmerica/New_York\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eThe time zone in Snowflake is set to \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eEurope/Warsaw\u003c/span\u003e\u003c/code\u003e, which can happen by either:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003eSetting \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfTimezone\u003c/span\u003e\u003c/code\u003e to \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eEurope/Warsaw\u003c/span\u003e\u003c/code\u003e for the connector.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eSetting \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfTimezone\u003c/span\u003e\u003c/code\u003e to \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esnowflake\u003c/span\u003e\u003c/code\u003e for the connector and setting the \u003ca class=\"reference internal\" href=\"../sql-reference/parameters.html#label-timezone\"\u003e\u003cspan class=\"std std-ref\"\u003eTIMEZONE\u003c/span\u003e\u003c/a\u003e session\nparameter in Snowflake to \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eEurope/Warsaw\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eBoth TIMESTAMP_NTZ and TIMESTAMP_LTZ are in use in Snowflake.\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIn this scenario:\u003c/p\u003e\n\u003col class=\"arabic simple\"\u003e\n\u003cli\u003e\u003cp\u003eIf a value representing \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e12:00:00\u003c/span\u003e\u003c/code\u003e in a TIMESTAMP_NTZ column in Snowflake is sent to Spark, this value doesn’t carry any time zone information. Spark treats the value as \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e12:00:00\u003c/span\u003e\u003c/code\u003e in New York.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eIf Spark sends this value \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e12:00:00\u003c/span\u003e\u003c/code\u003e (in New York) back to Snowflake to be loaded into a TIMESTAMP_LTZ column, it is automatically converted and loaded as \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e18:00:00\u003c/span\u003e\u003c/code\u003e (for the Warsaw time zone).\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eIf this value is then converted to TIMESTAMP_NTZ in Snowflake, the user sees \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e18:00:00\u003c/span\u003e\u003c/code\u003e, which is different from the original value, \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e12:00:00\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eTo summarize, Snowflake recommends strictly following \u003cspan class=\"emph\"\u003eat least\u003c/span\u003e one of these rules:\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003eUse the \u003cspan class=\"emph\"\u003esame\u003c/span\u003e time zone, ideally \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eUTC\u003c/span\u003e\u003c/code\u003e, for both Spark and Snowflake.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eUse \u003cspan class=\"emph\"\u003eonly\u003c/span\u003e the TIMESTAMP_LTZ data type for transferring data between Spark and Snowflake.\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/section\u003e\n\u003csection id=\"sample-scala-program\"\u003e\n\u003cspan id=\"label-spark-sample\"\u003e\u003c/span\u003e\u003ch3\u003eSample Scala Program\u003ca class=\"headerlink\" href=\"#sample-scala-program\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h3\u003e\n\u003cdiv class=\"admonition important\"\u003e\n\u003cp class=\"admonition-title\"\u003eImportant\u003c/p\u003e\n\u003cp\u003eThis sample program assumes you are using version 2.2.0 (or higher) of the connector, which uses a Snowflake internal stage for storing temporary data and, therefore, does not require an S3 location for\nstoring temporary data. If you are using an earlier version, you must have an existing S3 location and include values for \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etempdir\u003c/span\u003e\u003c/code\u003e, \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eawsAccessKey\u003c/span\u003e\u003c/code\u003e, \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eawsSecretKey\u003c/span\u003e\u003c/code\u003e for \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfOptions\u003c/span\u003e\u003c/code\u003e.\nFor more details, see \u003ca class=\"reference internal\" href=\"#label-s3-options\"\u003e\u003cspan class=\"std std-ref\"\u003eAWS Options for External Data Transfer\u003c/span\u003e\u003c/a\u003e (in this topic).\u003c/p\u003e\n\u003c/div\u003e\n\u003cp\u003eThe following Scala program provides a full use case for the Snowflake Connector for Spark. Before using the code, replace the following strings with the appropriate values, as described in\n\u003ca class=\"reference internal\" href=\"#label-spark-options\"\u003e\u003cspan class=\"std std-ref\"\u003eSetting Configuration Options for the Connector\u003c/span\u003e\u003c/a\u003e (in this topic):\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e\u0026lt;account_identifier\u0026gt;\u003c/span\u003e\u003c/code\u003e: Your \u003ca class=\"reference internal\" href=\"admin-account-identifier\"\u003e\u003cspan class=\"doc\"\u003eaccount identifier\u003c/span\u003e\u003c/a\u003e.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e\u0026lt;user_name\u0026gt;\u003c/span\u003e\u003c/code\u003e , \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e\u0026lt;password\u0026gt;\u003c/span\u003e\u003c/code\u003e: Login credentials for the Snowflake user.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e\u0026lt;database\u0026gt;\u003c/span\u003e\u003c/code\u003e , \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e\u0026lt;schema\u0026gt;\u003c/span\u003e\u003c/code\u003e , \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e\u0026lt;warehouse\u0026gt;\u003c/span\u003e\u003c/code\u003e: Defaults for the Snowflake session.\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe sample Scala program uses basic authentication (i.e. username and password). If you wish to authenticate with OAuth, see \u003ca class=\"reference internal\" href=\"#using-external-oauth\"\u003eUsing External OAuth\u003c/a\u003e (in this topic).\u003c/p\u003e\n\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-scala notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nn\"\u003eorg\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nn\"\u003eapache\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nn\"\u003espark\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nn\"\u003esql\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// Configure your Snowflake environment\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n\u003cspan class=\"kd\"\u003evar\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esfOptions\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nc\"\u003eMap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfURL\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;account_identifier\u0026gt;.snowflakecomputing.com\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfUser\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;user_name\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfPassword\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;password\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfDatabase\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;database\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfSchema\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;schema\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfWarehouse\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;warehouse\u0026gt;\"\u003c/span\u003e\n\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// Create a DataFrame from a Snowflake table\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n\u003cspan class=\"kd\"\u003eval\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edf\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nc\"\u003eDataFrame\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esqlContext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eread\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eformat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eSNOWFLAKE_SOURCE_NAME\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esfOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoption\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"dbtable\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"t1\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eload\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// DataFrames can also be populated via a SQL query\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n\u003cspan class=\"kd\"\u003eval\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edf\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nc\"\u003eDataFrame\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esqlContext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eread\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eformat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eSNOWFLAKE_SOURCE_NAME\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esfOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoption\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"query\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"select c1, count(*) from t1 group by c1\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eload\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// Join, augment, aggregate, etc. the data in Spark and then use the\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// Data Source API to write the data back to a table in Snowflake\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n\u003cspan class=\"n\"\u003edf\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ewrite\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eformat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eSNOWFLAKE_SOURCE_NAME\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esfOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoption\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"dbtable\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"t2\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eSaveMode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003eOverwrite\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esave\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"12\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003csection id=\"using-the-connector-with-python\"\u003e\n\u003ch2\u003eUsing the Connector with Python\u003ca class=\"headerlink\" href=\"#using-the-connector-with-python\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eUsing the connector with Python is very similar to the Scala usage.\u003c/p\u003e\n\u003cp\u003eWe recommend using the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ebin/pyspark\u003c/span\u003e\u003c/code\u003e script included in the Spark distribution.\u003c/p\u003e\n\u003csection id=\"configuring-the-pyspark-script\"\u003e\n\u003ch3\u003eConfiguring the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003epyspark\u003c/span\u003e\u003c/code\u003e Script\u003ca class=\"headerlink\" href=\"#configuring-the-pyspark-script\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eThe \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003epyspark\u003c/span\u003e\u003c/code\u003e script must be configured similarly to the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003espark-shell\u003c/span\u003e\u003c/code\u003e script, using the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e--packages\u003c/span\u003e\u003c/code\u003e or \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e--jars\u003c/span\u003e\u003c/code\u003e options. For example:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-bash notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003ebin/pyspark\u003cspan class=\"w\"\u003e \u003c/span\u003e--packages\u003cspan class=\"w\"\u003e \u003c/span\u003enet.snowflake:snowflake-jdbc:3.13.22,net.snowflake:spark-snowflake_2.12:2.11.0-spark_3.3\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"13\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003cp\u003eDon’t forget to include the Snowflake Spark Connector and JDBC Connector .jar\nfiles in your CLASSPATH environment variable.\u003c/p\u003e\n\u003cp\u003eFor more information about configuring the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003espark-shell\u003c/span\u003e\u003c/code\u003e script, see \u003ca class=\"reference internal\" href=\"spark-connector-install.html#label-spark-cluster-setup\"\u003e\u003cspan class=\"std std-ref\"\u003eStep 4: Configure the Local Spark Cluster or Amazon EMR-hosted Spark Environment\u003c/span\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003c/section\u003e\n\u003csection id=\"id2\"\u003e\n\u003ch3\u003eEnabling/Disabling Pushdown in a Session\u003ca class=\"headerlink\" href=\"#id2\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eVersion 2.1.0 (and higher) of the connector supports query pushdown, which can significantly improve performance by pushing query processing to Snowflake when Snowflake is the Spark data source.\u003c/p\u003e\n\u003cp\u003eBy default, pushdown is enabled.\u003c/p\u003e\n\u003cp\u003eTo disable pushdown within a Spark session for a given DataFrame:\u003c/p\u003e\n\u003col class=\"arabic\"\u003e\n\u003cli\u003e\u003cp\u003eAfter instantiating a \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eSparkSession\u003c/span\u003e\u003c/code\u003e object, call the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eSnowflakeConnectorUtils.disablePushdownSession\u003c/span\u003e\u003c/code\u003e static\nmethod, passing in the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eSparkSession\u003c/span\u003e\u003c/code\u003e object. For example:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-python notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003esc\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_jvm\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003enet\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esnowflake\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003espark\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esnowflake\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSnowflakeConnectorUtils\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edisablePushdownSession\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esc\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_jvm\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eorg\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eapache\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003espark\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esql\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSparkSession\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ebuilder\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003egetOrCreate\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"14\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eCreate a DataFrame with the \u003ca class=\"reference internal\" href=\"#label-spark-options-autopushdown\"\u003e\u003cspan class=\"std std-ref\"\u003eautopushdown\u003c/span\u003e\u003c/a\u003e option set to \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoff\u003c/span\u003e\u003c/code\u003e. For example:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-python notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003edf\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003espark\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eread\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eformat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSNOWFLAKE_SOURCE_NAME\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \\\n  \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e**\u003c/span\u003e\u003cspan class=\"n\"\u003esfOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \\\n  \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoption\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"query\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e  \u003cspan class=\"n\"\u003equery\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \\\n  \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoption\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"autopushdown\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"off\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \\\n  \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eload\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"15\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003cp\u003eNote that you can also set the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eautopushdown\u003c/span\u003e\u003c/code\u003e option in a \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eDictionary\u003c/span\u003e\u003c/code\u003e that you pass to the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoptions\u003c/span\u003e\u003c/code\u003e method\n(e.g.  in \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfOptions\u003c/span\u003e\u003c/code\u003e in the example above).\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eTo enable pushdown again after disabling it, call the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eSnowflakeConnectorUtils.enablePushdownSession\u003c/span\u003e\u003c/code\u003e static method\n(passing in the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eSparkSession\u003c/span\u003e\u003c/code\u003e object), and create a DataFrame with \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eautopushdown\u003c/span\u003e\u003c/code\u003e enabled.\u003c/p\u003e\n\u003c/section\u003e\n\u003csection id=\"sample-python-script\"\u003e\n\u003ch3\u003eSample Python Script\u003ca class=\"headerlink\" href=\"#sample-python-script\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h3\u003e\n\u003cdiv class=\"admonition important\"\u003e\n\u003cp class=\"admonition-title\"\u003eImportant\u003c/p\u003e\n\u003cp\u003eThis sample script assumes you are using version 2.2.0 (or higher) of the connector, which uses a Snowflake internal stage for storing temporary data and, therefore, does not require an S3 location for\nstoring this data. If you are using an earlier version, you must have an existing S3 location and include values for \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etempdir\u003c/span\u003e\u003c/code\u003e, \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eawsAccessKey\u003c/span\u003e\u003c/code\u003e, \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eawsSecretKey\u003c/span\u003e\u003c/code\u003e for \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfOptions\u003c/span\u003e\u003c/code\u003e. For more\ndetails, see \u003ca class=\"reference internal\" href=\"#label-s3-options\"\u003e\u003cspan class=\"std std-ref\"\u003eAWS Options for External Data Transfer\u003c/span\u003e\u003c/a\u003e (in this topic).\u003c/p\u003e\n\u003c/div\u003e\n\u003cp\u003eOnce the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003epyspark\u003c/span\u003e\u003c/code\u003e script has been configured, you can perform SQL queries and other operations. Here’s an example Python script that performs a simple SQL query. This script illustrates basic connector\nusage. Most of the Scala examples in this document can be adapted with minimal effort/changes for use with Python.\u003c/p\u003e\n\u003cp\u003eThe sample Python script uses basic authentication (i.e. username and password). If you wish to authenticate with OAuth, see \u003ca class=\"reference internal\" href=\"#using-external-oauth\"\u003eUsing External OAuth\u003c/a\u003e (in this topic).\u003c/p\u003e\n\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-python notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003epyspark\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003eSparkConf\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSparkContext\u003c/span\u003e\n\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003epyspark.sql\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003eSQLContext\u003c/span\u003e\n\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003epyspark.sql.types\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\n\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003epyspark\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003eSparkConf\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSparkContext\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003esc\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSparkContext\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"local\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"Simple App\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003espark\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSQLContext\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esc\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003espark_conf\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSparkConf\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esetMaster\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e'local'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esetAppName\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e'\u0026lt;APP_NAME\u0026gt;'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e# You might need to set these\u003c/span\u003e\n\u003cspan class=\"n\"\u003esc\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_jsc\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehadoopConfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"fs.s3n.awsAccessKeyId\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u0026lt;AWS_KEY\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003esc\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_jsc\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehadoopConfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"fs.s3n.awsSecretAccessKey\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u0026lt;AWS_SECRET\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e# Set options below\u003c/span\u003e\n\u003cspan class=\"n\"\u003esfOptions\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"s2\"\u003e\"sfURL\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u0026lt;account_identifier\u0026gt;.snowflakecomputing.com\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"s2\"\u003e\"sfUser\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u0026lt;user_name\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"s2\"\u003e\"sfPassword\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u0026lt;password\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"s2\"\u003e\"sfDatabase\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u0026lt;database\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"s2\"\u003e\"sfSchema\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u0026lt;schema\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"s2\"\u003e\"sfWarehouse\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u0026lt;warehouse\u0026gt;\"\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eSNOWFLAKE_SOURCE_NAME\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"net.snowflake.spark.snowflake\"\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003edf\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003espark\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eread\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eformat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSNOWFLAKE_SOURCE_NAME\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \\\n  \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e**\u003c/span\u003e\u003cspan class=\"n\"\u003esfOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \\\n  \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoption\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"query\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e  \u003cspan class=\"s2\"\u003e\"select 1 as my_num union all select 2 as my_num\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \\\n  \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eload\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003edf\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eshow\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"16\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003cdiv class=\"admonition tip\"\u003e\n\u003cp class=\"admonition-title\"\u003eTip\u003c/p\u003e\n\u003cp\u003eNote the usage of \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfOptions\u003c/span\u003e\u003c/code\u003e and \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eSNOWFLAKE_SOURCE_NAME\u003c/span\u003e\u003c/code\u003e. This simplifies the code and reduces the chance of errors.\u003c/p\u003e\n\u003cp\u003eFor details about the supported options for \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfOptions\u003c/span\u003e\u003c/code\u003e, see \u003ca class=\"reference internal\" href=\"#label-spark-options\"\u003e\u003cspan class=\"std std-ref\"\u003eSetting Configuration Options for the Connector\u003c/span\u003e\u003c/a\u003e (in this topic).\u003c/p\u003e\n\u003c/div\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003csection id=\"data-type-mappings\"\u003e\n\u003cspan id=\"label-spark-data-type-mappings\"\u003e\u003c/span\u003e\u003ch2\u003eData Type Mappings\u003ca class=\"headerlink\" href=\"#data-type-mappings\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eThe Spark Connector supports converting between many common data types.\u003c/p\u003e\n\u003csection id=\"from-spark-sql-to-snowflake\"\u003e\n\u003ch3\u003eFrom Spark SQL to Snowflake\u003ca class=\"headerlink\" href=\"#from-spark-sql-to-snowflake\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003ctable class=\"docutils align-default\"\u003e\n\u003ccolgroup\u003e\n\u003ccol style=\"width: 30.0%\"\u003e\n\u003ccol style=\"width: 70.0%\"\u003e\n\u003c/colgroup\u003e\n\u003cthead\u003e\n\u003ctr class=\"row-odd\"\u003e\u003cth class=\"head\"\u003e\u003cp\u003eSpark\u0026nbsp;Data\u0026nbsp;Type\u003c/p\u003e\u003c/th\u003e\n\u003cth class=\"head\"\u003e\u003cp\u003eSnowflake\u0026nbsp;Data\u0026nbsp;Type\u003c/p\u003e\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr class=\"row-even\"\u003e\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eArrayType\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003eVARIANT\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-odd\"\u003e\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eBinaryType\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003eNot supported\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-even\"\u003e\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eBooleanType\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003eBOOLEAN\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-odd\"\u003e\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eByteType\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003eINTEGER. Snowflake does not support the BYTE type.\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-even\"\u003e\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eDateType\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003eDATE\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-odd\"\u003e\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eDecimalType\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003eDECIMAL\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-even\"\u003e\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eDoubleType\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003eDOUBLE\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-odd\"\u003e\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eFloatType\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003eFLOAT\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-even\"\u003e\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eIntegerType\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003eINTEGER\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-odd\"\u003e\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eLongType\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003eINTEGER\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-even\"\u003e\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eMapType\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003eVARIANT\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-odd\"\u003e\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eShortType\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003eINTEGER\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-even\"\u003e\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eStringType\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003eIf length is specified, VARCHAR(N); otherwise, VARCHAR\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-odd\"\u003e\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eStructType\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003eVARIANT\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-even\"\u003e\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eTimestampType\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003eTIMESTAMP\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003c/section\u003e\n\u003csection id=\"from-snowflake-to-spark-sql\"\u003e\n\u003ch3\u003eFrom Snowflake to Spark SQL\u003ca class=\"headerlink\" href=\"#from-snowflake-to-spark-sql\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003ctable class=\"docutils align-default\"\u003e\n\u003ccolgroup\u003e\n\u003ccol style=\"width: 30.0%\"\u003e\n\u003ccol style=\"width: 70.0%\"\u003e\n\u003c/colgroup\u003e\n\u003cthead\u003e\n\u003ctr class=\"row-odd\"\u003e\u003cth class=\"head\"\u003e\u003cp\u003eSnowflake\u0026nbsp;Data\u0026nbsp;Type\u003c/p\u003e\u003c/th\u003e\n\u003cth class=\"head\"\u003e\u003cp\u003eSpark\u0026nbsp;Data\u0026nbsp;Type\u003c/p\u003e\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr class=\"row-even\"\u003e\u003ctd\u003e\u003cp\u003eARRAY\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eStringType\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-odd\"\u003e\u003ctd\u003e\u003cp\u003eBIGINT\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eDecimalType(38,\u003c/span\u003e \u003cspan class=\"pre\"\u003e0)\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-even\"\u003e\u003ctd\u003e\u003cp\u003eBINARY\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003eNot supported\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-odd\"\u003e\u003ctd\u003e\u003cp\u003eBLOB\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003eNot supported\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-even\"\u003e\u003ctd\u003e\u003cp\u003eBOOLEAN\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eBooleanType\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-odd\"\u003e\u003ctd\u003e\u003cp\u003eCHAR\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eStringType\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-even\"\u003e\u003ctd\u003e\u003cp\u003eCLOB\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eStringType\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-odd\"\u003e\u003ctd\u003e\u003cp\u003eDATE\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eDateType\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-even\"\u003e\u003ctd\u003e\u003cp\u003eDECIMAL\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eDecimalType\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-odd\"\u003e\u003ctd\u003e\u003cp\u003eDOUBLE\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eDoubleType\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-even\"\u003e\u003ctd\u003e\u003cp\u003eFLOAT\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eDoubleType\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-odd\"\u003e\u003ctd\u003e\u003cp\u003eINTEGER\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eDecimalType(38,\u003c/span\u003e \u003cspan class=\"pre\"\u003e0)\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-even\"\u003e\u003ctd\u003e\u003cp\u003eOBJECT\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eStringType\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-odd\"\u003e\u003ctd\u003e\u003cp\u003eTIMESTAMP\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eTimestampType\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-even\"\u003e\u003ctd\u003e\u003cp\u003eTIME\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eStringType\u003c/span\u003e\u003c/code\u003e (Spark Connector Version 2.4.14 or later)\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-odd\"\u003e\u003ctd\u003e\u003cp\u003eVARIANT\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eStringType\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003csection id=\"calling-the-dataframe-show-method\"\u003e\n\u003cspan id=\"label-spark-dataframe-show\"\u003e\u003c/span\u003e\u003ch2\u003eCalling the DataFrame.show Method\u003ca class=\"headerlink\" href=\"#calling-the-dataframe-show-method\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eIf you are calling the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eDataFrame.show\u003c/span\u003e\u003c/code\u003e method and passing in a number that is less than the number of rows in the\nDataFrame, construct a DataFrame that just contains the rows to show in a sorted order.\u003c/p\u003e\n\u003cp\u003eTo do this:\u003c/p\u003e\n\u003col class=\"arabic simple\"\u003e\n\u003cli\u003e\u003cp\u003eCall the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esort\u003c/span\u003e\u003c/code\u003e method first to return a DataFrame that contains sorted rows.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eCall the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003elimit\u003c/span\u003e\u003c/code\u003e method on that DataFrame to return a DataFrame that just contains the rows that you want to show.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eCall the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eshow\u003c/span\u003e\u003c/code\u003e method on the returned DataFrame.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eFor example, if you want to show 5 rows and want the results sorted by the column \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003emy_col\u003c/span\u003e\u003c/code\u003e:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-scala notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"kd\"\u003eval\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edfWithRowsToShow\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eoriginalDf\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esort\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"my_col\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003elimit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003edfWithRowsToShow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eshow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"17\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003cp\u003eOtherwise, if you call \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eshow\u003c/span\u003e\u003c/code\u003e to display a subset of rows in the DataFrame, different executions of the code might result in\ndifferent rows being shown.\u003c/p\u003e\n\u003c/section\u003e\n\u003csection id=\"setting-configuration-options-for-the-connector\"\u003e\n\u003cspan id=\"label-spark-options\"\u003e\u003c/span\u003e\u003ch2\u003eSetting Configuration Options for the Connector\u003ca class=\"headerlink\" href=\"#setting-configuration-options-for-the-connector\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eThe following sections list the options that you set to configure the behavior of the connector:\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003e\u003ca class=\"reference internal\" href=\"#label-spark-options-required-section\"\u003e\u003cspan class=\"std std-ref\"\u003eRequired Connection Options\u003c/span\u003e\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ca class=\"reference internal\" href=\"#label-spark-options-required-context-section\"\u003e\u003cspan class=\"std std-ref\"\u003eRequired Context Options\u003c/span\u003e\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ca class=\"reference internal\" href=\"#label-spark-options-additional-context-section\"\u003e\u003cspan class=\"std std-ref\"\u003eAdditional Context Options\u003c/span\u003e\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ca class=\"reference internal\" href=\"#label-spark-options-proxy-section\"\u003e\u003cspan class=\"std std-ref\"\u003eProxy Options\u003c/span\u003e\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ca class=\"reference internal\" href=\"#label-spark-options-additional-section\"\u003e\u003cspan class=\"std std-ref\"\u003eAdditional Options\u003c/span\u003e\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eTo set these options, call the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e.option(\u0026lt;key\u0026gt;,\u003c/span\u003e \u003cspan class=\"pre\"\u003e\u0026lt;value\u0026gt;)\u003c/span\u003e\u003c/code\u003e or \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e.options(\u0026lt;map\u0026gt;)\u003c/span\u003e\u003c/code\u003e method of the\n\u003ca class=\"reference external\" href=\"https://spark.apache.org/docs/1.6.0/api/java/org/apache/spark/sql/DataFrameReader.html\"\u003eSpark DataframeReader\u003c/a\u003e class.\u003c/p\u003e\n\u003cdiv class=\"admonition tip\"\u003e\n\u003cp class=\"admonition-title\"\u003eTip\u003c/p\u003e\n\u003cp\u003eTo facilitate using the options, Snowflake recommends specifying the options in a single \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eMap\u003c/span\u003e\u003c/code\u003e object and calling\n\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e.options(\u0026lt;map\u0026gt;)\u003c/span\u003e\u003c/code\u003e to set the options.\u003c/p\u003e\n\u003c/div\u003e\n\u003csection id=\"required-connection-options\"\u003e\n\u003cspan id=\"label-spark-options-required-section\"\u003e\u003c/span\u003e\u003ch3\u003eRequired Connection Options\u003ca class=\"headerlink\" href=\"#required-connection-options\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eThe following options are required for connecting to Snowflake:\u003c/p\u003e\n\u003cdl\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfUrl\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eSpecifies the \u003cem\u003ehostname\u003c/em\u003e for your account in the following format:\u003c/p\u003e\n\u003cp\u003e\u003ccode class=\"samp docutils literal notranslate\"\u003e\u003cem\u003e\u003cspan class=\"pre\"\u003eaccount_identifier\u003c/span\u003e\u003c/em\u003e\u003cspan class=\"pre\"\u003e.snowflakecomputing.com\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode class=\"samp docutils literal notranslate\"\u003e\u003cem\u003e\u003cspan class=\"pre\"\u003eaccount_identifier\u003c/span\u003e\u003c/em\u003e\u003c/code\u003e is your \u003ca class=\"reference internal\" href=\"admin-account-identifier\"\u003e\u003cspan class=\"doc\"\u003eaccount identifier\u003c/span\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfUser\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eLogin name for the Snowflake user.\u003c/p\u003e\n\u003c/dd\u003e\n\u003c/dl\u003e\n\u003cp\u003eYou must also use one of the following options to authenticate:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfPassword\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003ePassword for the Snowflake user.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003epem_private_key\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003ePrivate key (in PEM format) for key pair authentication. For instructions, see \u003ca class=\"reference internal\" href=\"key-pair-auth\"\u003e\u003cspan class=\"doc\"\u003eKey-pair authentication and key-pair rotation\u003c/span\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfAuthenticator\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eSpecifies using \u003ca class=\"reference internal\" href=\"oauth-ext-overview\"\u003e\u003cspan class=\"doc\"\u003eExternal OAuth\u003c/span\u003e\u003c/a\u003e to authenticate to Snowflake. Set the value to \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoauth\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eUsing External OAuth requires setting the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfToken\u003c/span\u003e\u003c/code\u003e parameter.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdl\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfToken\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003e(Required if using External OAuth) Set the value to your External OAuth access token.\u003c/p\u003e\n\u003cp\u003eThis connection parameter requires setting the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfAuthenticator\u003c/span\u003e\u003c/code\u003e parameter value to \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoauth\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eDefault is none.\u003c/p\u003e\n\u003c/dd\u003e\n\u003c/dl\u003e\n\u003c/section\u003e\n\u003csection id=\"required-context-options\"\u003e\n\u003cspan id=\"label-spark-options-required-context-section\"\u003e\u003c/span\u003e\u003ch3\u003eRequired Context Options\u003ca class=\"headerlink\" href=\"#required-context-options\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eThe following options are required for setting the database and schema context for the session:\u003c/p\u003e\n\u003cdl class=\"simple\"\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfDatabase\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eThe database to use for the session after connecting.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfSchema\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eThe schema to use for the session after connecting.\u003c/p\u003e\n\u003c/dd\u003e\n\u003c/dl\u003e\n\u003c/section\u003e\n\u003csection id=\"additional-context-options\"\u003e\n\u003cspan id=\"label-spark-options-additional-context-section\"\u003e\u003c/span\u003e\u003ch3\u003eAdditional Context Options\u003ca class=\"headerlink\" href=\"#additional-context-options\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eThe options listed in this section are not required.\u003c/p\u003e\n\u003cdl class=\"simple\"\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfAccount\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eAccount identifier (e.g. \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003emyorganization-myaccount\u003c/span\u003e\u003c/code\u003e). This option is no longer required because the account identifier is specified in \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfUrl\u003c/span\u003e\u003c/code\u003e. It is documented here only for backward compatibility.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfWarehouse\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eThe default virtual warehouse to use for the session after connecting.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfRole\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eThe default security role to use for the session after connecting.\u003c/p\u003e\n\u003c/dd\u003e\n\u003c/dl\u003e\n\u003c/section\u003e\n\u003csection id=\"proxy-options\"\u003e\n\u003cspan id=\"label-spark-options-proxy-section\"\u003e\u003c/span\u003e\u003ch3\u003eProxy Options\u003ca class=\"headerlink\" href=\"#proxy-options\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eThe options listed in this section are not required.\u003c/p\u003e\n\u003cdl\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003euse_proxy\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eSpecifies whether the connector should use a proxy:\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etrue\u003c/span\u003e\u003c/code\u003e specifies that the connector should use a proxy.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003efalse\u003c/span\u003e\u003c/code\u003e specifies that the connector should not use a proxy.\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe default value is \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003efalse\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eproxy_host\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003e(Required if \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003euse_proxy\u003c/span\u003e\u003c/code\u003e is \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etrue\u003c/span\u003e\u003c/code\u003e) Specifies the hostname of the proxy server to use.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eproxy_port\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003e(Required if \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003euse_proxy\u003c/span\u003e\u003c/code\u003e is \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etrue\u003c/span\u003e\u003c/code\u003e) Specifies the port number of the proxy server to use.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eproxy_protocol\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eSpecifies the protocol used to connect to the proxy server. You can specify one of the following values:\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ehttp\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ehttps\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe default value is \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ehttp\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eThis is only supported for Snowflake on AWS.\u003c/p\u003e\n\u003cp\u003eThis option was added in version 2.11.1 of the Spark Connector.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eproxy_user\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eSpecifies the user name for authenticating to the proxy server. Set this if the proxy server requires authentication.\u003c/p\u003e\n\u003cp\u003eThis is only supported for Snowflake on AWS.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eproxy_password\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eSpecifies the password of \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eproxy_user\u003c/span\u003e\u003c/code\u003e for authenticating to the proxy server. Set this if the proxy server requires\nauthentication.\u003c/p\u003e\n\u003cp\u003eThis is only supported for Snowflake on AWS.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003enon_proxy_hosts\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eSpecifies the list of hosts that the connector should connect to directly, bypassing the proxy server.\u003c/p\u003e\n\u003cp\u003eSeparate the hostnames with a URL-escaped pipe symbol (\u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e%7C\u003c/span\u003e\u003c/code\u003e). You can also use an asterisk (\u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e*\u003c/span\u003e\u003c/code\u003e) as a wildcard\u003c/p\u003e\n\u003cp\u003eThis is only supported for Snowflake on AWS.\u003c/p\u003e\n\u003c/dd\u003e\n\u003c/dl\u003e\n\u003c/section\u003e\n\u003csection id=\"additional-options\"\u003e\n\u003cspan id=\"label-spark-options-additional-section\"\u003e\u003c/span\u003e\u003ch3\u003eAdditional Options\u003ca class=\"headerlink\" href=\"#additional-options\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eThe options listed in this section are not required.\u003c/p\u003e\n\u003cdl\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfTimezone\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eThe time zone to be used by Snowflake when working with Spark. Note that the parameter only sets the time zone in Snowflake; the Spark environment remains unmodified. The supported values are:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003espark\u003c/span\u003e\u003c/code\u003e: Use the time zone from Spark (default).\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esnowflake\u003c/span\u003e\u003c/code\u003e: Use the current time zone for Snowflake.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esf_default\u003c/span\u003e\u003c/code\u003e: Use the default time zone for the Snowflake user who is connecting.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"samp docutils literal notranslate\"\u003e\u003cem\u003e\u003cspan class=\"pre\"\u003etime_zone\u003c/span\u003e\u003c/em\u003e\u003c/code\u003e: Use a specific time zone (e.g. \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eAmerica/New_York\u003c/span\u003e\u003c/code\u003e), if valid.\u003c/p\u003e\n\u003cp\u003eFor more information about the impact of setting this option, see \u003ca class=\"reference internal\" href=\"#label-spark-timestamps\"\u003e\u003cspan class=\"std std-ref\"\u003eWorking with Timestamps and Time Zones\u003c/span\u003e\u003c/a\u003e (in this topic).\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfCompress\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eIf set to \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eon\u003c/span\u003e\u003c/code\u003e (default), the data passed between Snowflake and Spark is compressed.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003es3MaxFileSize\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eThe size of the file used when moving data from Snowflake to Spark. The default is 10MB.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003epreactions\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eA semicolon-separated list of SQL commands that are executed before data is transferred between Spark and Snowflake.\u003c/p\u003e\n\u003cp\u003eIf a SQL command contains \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e%s\u003c/span\u003e\u003c/code\u003e, the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e%s\u003c/span\u003e\u003c/code\u003e is replaced with the table name referenced for the operation.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003epostactions\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eA semicolon-separated list of SQL commands that are executed after data is transferred between Spark and Snowflake.\u003c/p\u003e\n\u003cp\u003eIf a SQL command contains \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e%s\u003c/span\u003e\u003c/code\u003e, it is replaced with the table name referenced for the operation.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etruncate_columns\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eIf set to \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eon\u003c/span\u003e\u003c/code\u003e (default), a COPY command automatically truncates text strings that exceed the target column length. If set to \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoff\u003c/span\u003e\u003c/code\u003e, the command produces an error if a loaded string exceeds the target column length.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etruncate_table\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eThis parameter controls whether Snowflake retains the schema of a Snowflake\ntarget table when overwriting that table.\u003c/p\u003e\n\u003cp\u003eBy default, when a target table in Snowflake is overwritten, the schema of\nthat target table is also overwritten; the new schema is based on the schema\nof the source table (the Spark dataframe).\u003c/p\u003e\n\u003cp\u003eHowever, sometimes the schema of the source is not ideal. For example,\na user might want a Snowflake target table to be able to store FLOAT\nvalues in the future even though the data type of the initial source column\nis INTEGER. In that case, the Snowflake table’s schema should not be\noverwritten; the Snowflake table should merely be truncated and then\nreused with its current schema.\u003c/p\u003e\n\u003cp\u003eThe possible values of this parameter are:\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eon\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoff\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIf this parameter is \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eon\u003c/span\u003e\u003c/code\u003e, the original schema of the target table is kept.\nIf this parameter is \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoff\u003c/span\u003e\u003c/code\u003e, then the old schema of the table is ignored,\nand a new schema is generated based on the schema of the source.\u003c/p\u003e\n\u003cp\u003eThis parameter is optional.\u003c/p\u003e\n\u003cp\u003eThe default value of this parameter is \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoff\u003c/span\u003e\u003c/code\u003e (i.e. by default\nthe original table schema is overwritten).\u003c/p\u003e\n\u003cp\u003eFor details about mapping Spark data types to Snowflake data types (and\nvice versa), see: \u003ca class=\"reference internal\" href=\"#label-spark-data-type-mappings\"\u003e\u003cspan class=\"std std-ref\"\u003eData Type Mappings\u003c/span\u003e\u003c/a\u003e (in this topic).\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003econtinue_on_error\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eThis variable controls whether the COPY command aborts if the user enters\ninvalid data (for example, invalid JSON format for a variant data type column).\u003c/p\u003e\n\u003cp\u003eThe possible values are:\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eon\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoff\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe value \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eon\u003c/span\u003e\u003c/code\u003e means continue even if an error occurs. The value \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoff\u003c/span\u003e\u003c/code\u003e\nmeans abort if an error is hit.\u003c/p\u003e\n\u003cp\u003eThis parameter is optional.\u003c/p\u003e\n\u003cp\u003eThe default value of this parameter is \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoff\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eTurning this option on is not recommended. If any errors are reported\nwhile COPYing into Snowflake with the Spark connector, then this is likely\nto result in missing data.\u003c/p\u003e\n\u003cdiv class=\"admonition note\"\u003e\n\u003cp class=\"admonition-title\"\u003eNote\u003c/p\u003e\n\u003cp\u003eIf rows are rejected or missing, and those rows are not clearly faulty\nin the input source, please report it to Snowflake.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eusestagingtable\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eThis parameter controls whether data loading uses a staging table.\u003c/p\u003e\n\u003cp\u003eA staging table is a normal table (with a temporary name) that is created\nby the connector; if the data loading operation is successful, the original\ntarget table is dropped and the staging table is renamed to the original\ntarget table’s name. If the data loading operation fails, the staging table\nis dropped and the target table is left with the data that it had\nimmediately prior to the operation. Thus the staging table allows the original\ntarget table data to be retained if the operation fails. For safety, Snowflake\nstrongly recommends using a staging table in most circumstances.\u003c/p\u003e\n\u003cp\u003eIn order for the connector to create a staging table, the user executing the\nCOPY via the Spark connector must have sufficient privileges to\ncreate a table. Direct loading (i.e. loading without using a staging table)\nis useful if the user does not have permission to create a table.\u003c/p\u003e\n\u003cp\u003eThe possible values of this parameter are:\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eon\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoff\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIf the parameter is \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eon\u003c/span\u003e\u003c/code\u003e, a staging table is used. If this parameter\nis \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoff\u003c/span\u003e\u003c/code\u003e, then the data is loaded directly into the target table.\u003c/p\u003e\n\u003cp\u003eThis parameter is optional.\u003c/p\u003e\n\u003cp\u003eThe default value of this parameter is \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eon\u003c/span\u003e\u003c/code\u003e (i.e. use a staging table).\u003c/p\u003e\n\u003c/dd\u003e\n\u003c/dl\u003e\n\u003cdl id=\"label-spark-options-autopushdown\"\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eautopushdown\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eThis parameter controls whether automatic query pushdown is enabled.\u003c/p\u003e\n\u003cp\u003eIf pushdown is enabled, then when a query is run on Spark, if part of the\nquery can be “pushed down” to the Snowflake server, it is pushed down.\nThis improves performance of some queries.\u003c/p\u003e\n\u003cp\u003eThis parameter is optional.\u003c/p\u003e\n\u003cp\u003eThe default value is \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eon\u003c/span\u003e\u003c/code\u003e if the connector is plugged into a compatible\nversion of Spark. Otherwise, the default value is \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoff\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eIf the connector is plugged into a different version of Spark than the\nconnector is intended for (e.g. if version 3.2 of the connector is\nplugged into version 3.3 of Spark), then auto-pushdown is disabled\neven if this parameter is set to \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eon\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003epurge\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eIf this is set to \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eon\u003c/span\u003e\u003c/code\u003e, then the connector deletes temporary files created\nwhen transferring from Spark to Snowflake via external data transfer.\nIf this parameter is set to \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoff\u003c/span\u003e\u003c/code\u003e, then those files are not automatically\ndeleted by the connector.\u003c/p\u003e\n\u003cp\u003ePurging works only for transfers from Spark to Snowflake, not for transfers\nfrom Snowflake to Spark.\u003c/p\u003e\n\u003cp\u003eThe possible values are\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eon\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoff\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe default value is \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoff\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ecolumnmap\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eThis parameter is useful when writing data from Spark to Snowflake\nand the column names in the Snowflake table do not match the column names\nin the Spark table. You can create a map that indicates which Spark\nsource column corresponds to each Snowflake destination column.\u003c/p\u003e\n\u003cp\u003eThe parameter is a single string literal, in the form of:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e\"Map(col_2\u003c/span\u003e \u003cspan class=\"pre\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"pre\"\u003ecol_b,\u003c/span\u003e \u003cspan class=\"pre\"\u003ecol_3\u003c/span\u003e \u003cspan class=\"pre\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"pre\"\u003ecol_a)\"\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003cp\u003eFor example, consider the following scenario:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003eA Dataframe named \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003edf\u003c/span\u003e\u003c/code\u003e in Spark has three columns:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cp\u003e\u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ecol_1\u003c/span\u003e\u003c/code\u003e , \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ecol_2\u003c/span\u003e\u003c/code\u003e , \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ecol_3\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eA table named \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etb\u003c/span\u003e\u003c/code\u003e in Snowflake has two columns:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cp\u003e\u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ecol_a\u003c/span\u003e\u003c/code\u003e , \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ecol_b\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eYou wish to copy the following values:\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003eFrom \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003edf.col_2\u003c/span\u003e\u003c/code\u003e to \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etb.col_b\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eFrom \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003edf.col_3\u003c/span\u003e\u003c/code\u003e to \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etb.col_a\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe value of the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ecolumnmap\u003c/span\u003e\u003c/code\u003e parameter would be:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cp\u003e\u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eMap(col_2\u003c/span\u003e \u003cspan class=\"pre\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"pre\"\u003ecol_b,\u003c/span\u003e \u003cspan class=\"pre\"\u003ecol_3\u003c/span\u003e \u003cspan class=\"pre\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"pre\"\u003ecol_a)\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003cp\u003eYou can generate this value by executing the following Scala code:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eMap(\"col_2\"-\u0026gt;\"col_b\",\"col_3\"-\u0026gt;\"col_a\").toString()\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003cp\u003eThe default value of this parameter is null. In other words, by default,\ncolumn names in the source and destination tables should match.\u003c/p\u003e\n\u003cp\u003eThis parameter is used only when writing from Spark to Snowflake;\nit does not apply when writing from Snowflake to Spark.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ekeep_column_case\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eWhen writing a table from Spark to Snowflake, the Spark connector defaults\nto shifting the letters in column names to uppercase, unless the column\nnames are in double quotes.\u003c/p\u003e\n\u003cp\u003eWhen writing a table from Snowflake to Spark, the Spark connector defaults\nto adding double quotes around any column name that contains any characters\nexcept uppercase letters, underscores, and digits.\u003c/p\u003e\n\u003cp\u003eIf you set keep_column_case to \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eon\u003c/span\u003e\u003c/code\u003e, then the Spark connector will not\nmake these changes.\u003c/p\u003e\n\u003cp\u003eThe possible values are:\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eon\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoff\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe default value is \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoff\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ecolumn_mapping\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eThe connector must map columns from the Spark data frame to the Snowflake table. This can be done based on column\nnames (regardless of order), or based on column order (i.e. the first column in the data frame is mapped to the first\ncolumn in the table, regardless of column name).\u003c/p\u003e\n\u003cp\u003eBy default, the mapping is done based on order. You can override that by setting this parameter to \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ename\u003c/span\u003e\u003c/code\u003e,\nwhich tells the connector to map columns based on column names. (The name mapping is case-insensitive.)\u003c/p\u003e\n\u003cp\u003eThe possible values of this parameter are:\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eorder\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ename\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe default value is \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eorder\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ecolumn_mismatch_behavior\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eThis parameter applies only when the \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ecolumn_mapping\u003c/span\u003e\u003c/code\u003e parameter is set to \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ename\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eIf the column names in the Spark data frame and the Snowflake table do not match, then:\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003eIf \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ecolumn_mismatch_behavior\u003c/span\u003e\u003c/code\u003e is \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eerror\u003c/span\u003e\u003c/code\u003e, then the Spark Connector reports an error.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eIf \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ecolumn_mismatch_behavior\u003c/span\u003e\u003c/code\u003e is \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eignore\u003c/span\u003e\u003c/code\u003e, then the Spark Connector ignores the error.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003eThe driver discards any column in the Spark data frame that does not have a corresponding column in the\nSnowflake table.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eThe driver inserts NULLs into any column in the Snowflake table that does not have a corresponding column\nin the Spark data frame.\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003ePotential errors include:\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003eThe Spark data frame could contain columns that are identical except for case (uppercase/lowercase). Because\ncolumn name mapping is case-insensitive, it is not possible to determine the correct mapping from the data frame\nto the table.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eThe Snowflake table could contain columns that are identical except for case (uppercase/lowercase). Because\ncolumn name mapping is case-insensitive, it is not possible to determine the correct mapping from the data frame\nto the table.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eThe Spark data frame and the Snowflake table might have no column names in common. In theory, the Spark Connector\ncould insert NULLs into every column of every row, but this is usually pointless, so the connector throws an\nerror even if the \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ecolumn_mismatch_behavior\u003c/span\u003e\u003c/code\u003e is set to \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eignore\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe possible values of this parameter are:\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eerror\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eignore\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe default value is \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eerror\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etime_output_format\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eThis parameter allows the user to specify the format for \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eTIME\u003c/span\u003e\u003c/code\u003e data returned.\u003c/p\u003e\n\u003cp\u003eThe possible values of this parameter are the possible values for time formats specified at \u003ca class=\"reference internal\" href=\"../sql-reference/date-time-input-output.html#label-time-formats\"\u003e\u003cspan class=\"std std-ref\"\u003eTime Formats\u003c/span\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eThis parameter affects only output, not input.\u003c/p\u003e\n\u003c/dd\u003e\n\u003c/dl\u003e\n\u003cdl id=\"label-spark-options-timestamp-output-format\"\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etimestamp_ntz_output_format\u003c/span\u003e\u003c/code\u003e, \u003cspan class=\"newline\"\u003e.\u003c/span\u003e \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etimestamp_ltz_output_format\u003c/span\u003e\u003c/code\u003e, \u003cspan class=\"newline\"\u003e.\u003c/span\u003e \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etimestamp_tz_output_format\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eThese options specify the output format for timestamp values. The default values of these options are:\u003c/p\u003e\n\u003ctable class=\"docutils align-default\"\u003e\n\u003ccolgroup\u003e\n\u003ccol style=\"width: 50.0%\"\u003e\n\u003ccol style=\"width: 50.0%\"\u003e\n\u003c/colgroup\u003e\n\u003cthead\u003e\n\u003ctr class=\"row-odd\"\u003e\u003cth class=\"head\"\u003e\u003cp\u003eConfiguration Option\u003c/p\u003e\u003c/th\u003e\n\u003cth class=\"head\"\u003e\u003cp\u003eDefault Value\u003c/p\u003e\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr class=\"row-even\"\u003e\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etimestamp_ntz_output_format\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003e\u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e\"YYYY-MM-DD\u003c/span\u003e \u003cspan class=\"pre\"\u003eHH24:MI:SS.FF3\"\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-odd\"\u003e\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etimestamp_ltz_output_format\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003e\u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e\"TZHTZM\u003c/span\u003e \u003cspan class=\"pre\"\u003eYYYY-MM-DD\u003c/span\u003e \u003cspan class=\"pre\"\u003eHH24:MI:SS.FF3\"\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr class=\"row-even\"\u003e\u003ctd\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etimestamp_tz_output_format\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cp\u003e\u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e\"TZHTZM\u003c/span\u003e \u003cspan class=\"pre\"\u003eYYYY-MM-DD\u003c/span\u003e \u003cspan class=\"pre\"\u003eHH24:MI:SS.FF3\"\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eIf these options are set to \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e\"sf_current\"\u003c/span\u003e\u003c/code\u003e, the connector uses the formats specified for the session.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003epartition_size_in_mb\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eThis parameter is used when the query result set is very large and needs to be split into multiple DataFrame\npartitions. This parameter specifies the recommended uncompressed size for each DataFrame partition. To reduce the\nnumber of partitions, make this size larger.\u003c/p\u003e\n\u003cp\u003eThis size is used as a recommended size; the actual size of partitions could be smaller or larger.\u003c/p\u003e\n\u003cp\u003eThis option applies only when the \u003ca class=\"reference internal\" href=\"#label-use-copy-unload\"\u003e\u003cspan class=\"std std-ref\"\u003euse_copy_unload\u003c/span\u003e\u003c/a\u003e parameter is FALSE.\u003c/p\u003e\n\u003cp\u003eThis parameter is optional.\u003c/p\u003e\n\u003cp\u003eThe default value is \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e100\u003c/span\u003e\u003c/code\u003e (MB).\u003c/p\u003e\n\u003c/dd\u003e\n\u003c/dl\u003e\n\u003cdl id=\"label-use-copy-unload\"\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003euse_copy_unload\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eIf this is \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eFALSE\u003c/span\u003e\u003c/code\u003e, Snowflake uses the Arrow data format when SELECTing data. If this is set to \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eTRUE\u003c/span\u003e\u003c/code\u003e,\nthen Snowflake reverts to the old behavior of using the \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eCOPY\u003c/span\u003e \u003cspan class=\"pre\"\u003eUNLOAD\u003c/span\u003e\u003c/code\u003e command to transmit selected data.\u003c/p\u003e\n\u003cp\u003eThis parameter is optional.\u003c/p\u003e\n\u003cp\u003eThe default value is \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eFALSE\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etreat_decimal_as_long\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eIf \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eTRUE\u003c/span\u003e\u003c/code\u003e, configures the Spark Connector to return \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eLong\u003c/span\u003e\u003c/code\u003e values (rather than \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eBigDecimal\u003c/span\u003e\u003c/code\u003e values) for queries\nthat return the type \u003ccode class=\"samp docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eDecimal(\u003c/span\u003e\u003cem\u003e\u003cspan class=\"pre\"\u003eprecision\u003c/span\u003e\u003c/em\u003e\u003cspan class=\"pre\"\u003e,\u003c/span\u003e \u003cspan class=\"pre\"\u003e0)\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eThe default value is \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eFALSE\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eThis option was added in version 2.11.1 of the Spark Connector.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003es3_stage_vpce_dns_name\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eSpecifies the DNS name of your VPC Endpoint for access to internal stages.\u003c/p\u003e\n\u003cp\u003eThis option was added in version 2.11.1 of the Spark Connector.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esupport_share_connection\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eIf \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eFALSE\u003c/span\u003e\u003c/code\u003e, configures the Spark Connector to create a new JDBC connection for each job or action that uses the same Spark\nConnector options to access Snowflake.\u003c/p\u003e\n\u003cp\u003eThe default value is \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eTRUE\u003c/span\u003e\u003c/code\u003e, which means that the different jobs and actions share the same JDBC connection if they use the\nsame Spark Connector options to access Snowflake.\u003c/p\u003e\n\u003cp\u003eIf you need to enable or disable this setting programmatically, use the following global static functions:\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eSparkConnectorContext.disableSharedConnection()\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eSparkConnectorContext.enableSharingJDBCConnection()\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"admonition note\"\u003e\n\u003cp class=\"admonition-title\"\u003eNote\u003c/p\u003e\n\u003cp\u003eIn the following special cases, the Spark Connector does not use a shared JDBC connection:\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003eIf preactions or postactions are set, and those preactions or postactions are not CREATE TABLE, DROP TABLE, or MERGE INTO,\nthe Spark Connector does not use the shared connection.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eUtility functions in Utils such as \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eUtils.runQuery()\u003c/span\u003e\u003c/code\u003e and \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eUtils.getJDBCConnection()\u003c/span\u003e\u003c/code\u003e do not use the shared\nconnection.\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cp\u003eThis option was added in version 2.11.2 of the Spark Connector.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eforce_skip_pre_post_action_check_for_shared_session\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eIf \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eTRUE\u003c/span\u003e\u003c/code\u003e, configures the Spark Connector to disable the validation of preactions and postactions for session sharing.\u003c/p\u003e\n\u003cp\u003eThe default value is \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eFALSE\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"admonition important\"\u003e\n\u003cp class=\"admonition-title\"\u003eImportant\u003c/p\u003e\n\u003cp\u003eBefore setting this option, make sure that the queries in preactions and postactions don’t affect the session settings.\nOtherwise, you may encounter issues with results.\u003c/p\u003e\n\u003c/div\u003e\n\u003cp\u003eThis option was added in version 2.11.3 of the Spark Connector.\u003c/p\u003e\n\u003c/dd\u003e\n\u003c/dl\u003e\n\u003c/section\u003e\n\u003csection id=\"using-key-pair-authentication-key-pair-rotation\"\u003e\n\u003cspan id=\"label-spark-key-pair-authn-rotation\"\u003e\u003c/span\u003e\u003ch3\u003eUsing Key Pair Authentication \u0026amp; Key Pair Rotation\u003ca class=\"headerlink\" href=\"#using-key-pair-authentication-key-pair-rotation\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eThe Spark connector supports key pair authentication and key rotation.\u003c/p\u003e\n\u003col class=\"arabic simple\"\u003e\n\u003cli\u003e\u003cp\u003eTo start, complete the initial configuration for key pair authentication as shown in \u003ca class=\"reference internal\" href=\"key-pair-auth\"\u003e\u003cspan class=\"doc\"\u003eKey-pair authentication and key-pair rotation\u003c/span\u003e\u003c/a\u003e.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eSend an \u003cspan class=\"emph\"\u003eunencrypted\u003c/span\u003e copy of the private key using the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003epem_private_key\u003c/span\u003e\u003c/code\u003e connection option.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"admonition attention\"\u003e\n\u003cp class=\"admonition-title\"\u003eAttention\u003c/p\u003e\n\u003cp\u003eFor security reasons, rather than hard-coding the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003epem_private_key\u003c/span\u003e\u003c/code\u003e in your application, you should set the parameter dynamically after reading the key from a secure source. If the key is encrypted, then decrypt it and send the decrypted version.\u003c/p\u003e\n\u003c/div\u003e\n\u003cp\u003eIn the Python example, note that the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003epem_private_key\u003c/span\u003e\u003c/code\u003e file, \u003ccode class=\"file docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ersa_key.p8\u003c/span\u003e\u003c/code\u003e, is:\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003eBeing read directly from a password-protected file, using the environment variable \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ePRIVATE_KEY_PASSPHRASE\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eUsing the expression \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003epkb\u003c/span\u003e\u003c/code\u003e in the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfOptions\u003c/span\u003e\u003c/code\u003e string.\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eTo connect, you can save the Python example to a file (i.e. \u003ccode class=\"file docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e\u0026lt;file.py\u0026gt;\u003c/span\u003e\u003c/code\u003e) and then execute the following command:\u003c/p\u003e\n\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-bash notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003espark-submit\u003cspan class=\"w\"\u003e \u003c/span\u003e--packages\u003cspan class=\"w\"\u003e \u003c/span\u003enet.snowflake:snowflake-jdbc:3.13.22,net.snowflake:spark-snowflake_2.12:2.11.0-spark_3.3\u003cspan class=\"w\"\u003e \u003c/span\u003e\u0026lt;file.py\u0026gt;\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"18\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003ePython\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-python notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003epyspark.sql\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003eSQLContext\u003c/span\u003e\n\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003epyspark\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003eSparkConf\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSparkContext\u003c/span\u003e\n\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003ecryptography.hazmat.backends\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003edefault_backend\u003c/span\u003e\n\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003ecryptography.hazmat.primitives\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003eserialization\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ere\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003eos\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"nb\"\u003eopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u0026lt;path\u0026gt;/rsa_key.p8\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"rb\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003ekey_file\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ep_key\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eserialization\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eload_pem_private_key\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ekey_file\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eread\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e\n    \u003cspan class=\"n\"\u003epassword\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eos\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eenviron\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e'PRIVATE_KEY_PASSPHRASE'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eencode\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ebackend\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edefault_backend\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003epkb\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ep_key\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eprivate_bytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eencoding\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eserialization\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eEncoding\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePEM\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003eformat\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eserialization\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePrivateFormat\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePKCS8\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eencryption_algorithm\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eserialization\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNoEncryption\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003epkb\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epkb\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edecode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"UTF-8\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003epkb\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ere\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esub\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"-*(BEGIN|END) PRIVATE KEY-*\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"n\"\u003epkb\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003esc\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSparkContext\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"local\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"Simple App\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003espark\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSQLContext\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esc\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003espark_conf\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSparkConf\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esetMaster\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e'local'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esetAppName\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e'Simple App'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003esfOptions\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"s2\"\u003e\"sfURL\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u0026lt;account_identifier\u0026gt;.snowflakecomputing.com\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"s2\"\u003e\"sfUser\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u0026lt;user_name\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"s2\"\u003e\"pem_private_key\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003epkb\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"s2\"\u003e\"sfDatabase\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u0026lt;database\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"s2\"\u003e\"sfSchema\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"schema\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"s2\"\u003e\"sfWarehouse\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u0026lt;warehouse\u0026gt;\"\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eSNOWFLAKE_SOURCE_NAME\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"net.snowflake.spark.snowflake\"\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003edf\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003espark\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eread\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eformat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSNOWFLAKE_SOURCE_NAME\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \\\n    \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e**\u003c/span\u003e\u003cspan class=\"n\"\u003esfOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \\\n    \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoption\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"query\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"COLORS\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \\\n    \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eload\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003edf\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eshow\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"19\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c/section\u003e\n\u003csection id=\"using-external-oauth\"\u003e\n\u003cspan id=\"label-spark-ext-oauth\"\u003e\u003c/span\u003e\u003ch3\u003eUsing External OAuth\u003ca class=\"headerlink\" href=\"#using-external-oauth\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eStarting with Spark Connector version 2.7.0, you can use \u003ca class=\"reference internal\" href=\"oauth-ext-overview\"\u003e\u003cspan class=\"doc\"\u003eExternal OAuth\u003c/span\u003e\u003c/a\u003e to authenticate to Snowflake using either the sample Scala program or the sample Python script.\u003c/p\u003e\n\u003cp\u003eBefore using External OAuth and the Spark Connector to authenticate to Snowflake, configure an External OAuth security integration for one of the supported External OAuth authorization servers or an External OAuth \u003ca class=\"reference internal\" href=\"oauth-ext-custom\"\u003e\u003cspan class=\"doc\"\u003ecustom client\u003c/span\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eIn the Scala and Python examples, note the replacement of the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfPassword\u003c/span\u003e\u003c/code\u003e parameter with the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfAuthenticator\u003c/span\u003e\u003c/code\u003e and \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfToken\u003c/span\u003e\u003c/code\u003e parameters.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eScala:\u003c/strong\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-scala notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e// spark connector version\u003c/span\u003e\n\n\u003cspan class=\"kd\"\u003eval\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nc\"\u003eSNOWFLAKE_SOURCE_NAME\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"net.snowflake.spark.snowflake\"\u003c/span\u003e\n\u003cspan class=\"k\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nn\"\u003enet\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nn\"\u003esnowflake\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nn\"\u003espark\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nn\"\u003esnowflake2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003eUtils\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003eSNOWFLAKE_SOURCE_NAME\u003c/span\u003e\n\u003cspan class=\"k\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nn\"\u003eorg\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nn\"\u003eapache\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nn\"\u003espark\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nn\"\u003esql\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003eDataFrame\u003c/span\u003e\n\n\u003cspan class=\"kd\"\u003evar\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esfOptions\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nc\"\u003eMap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfURL\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;account_identifier\u0026gt;.snowflakecomputing.com\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfUser\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;username\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfAuthenticator\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"oauth\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfToken\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;external_oauth_access_token\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfDatabase\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;database\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfSchema\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;schema\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfWarehouse\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;warehouse\u0026gt;\"\u003c/span\u003e\n\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// Create a DataFrame from a Snowflake table\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n\u003cspan class=\"kd\"\u003eval\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edf\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nc\"\u003eDataFrame\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esqlContext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eread\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eformat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eSNOWFLAKE_SOURCE_NAME\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esfOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoption\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"dbtable\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"region\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eload\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// Join, augment, aggregate, etc. the data in Spark and then use the\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// Data Source API to write the data back to a table in Snowflake\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n\u003cspan class=\"n\"\u003edf\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ewrite\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eformat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eSNOWFLAKE_SOURCE_NAME\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esfOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoption\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"dbtable\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"t2\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eSaveMode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003eOverwrite\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esave\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"20\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003cp\u003e\u003cstrong\u003ePython:\u003c/strong\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-python notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003epyspark\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003eSparkConf\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSparkContext\u003c/span\u003e\n\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003epyspark.sql\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003eSQLContext\u003c/span\u003e\n\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003epyspark.sql.types\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003esc\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSparkContext\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"local\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"Simple App\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003espark\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSQLContext\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esc\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003espark_conf\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSparkConf\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esetMaster\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e'local'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esetAppName\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e'\u0026lt;APP_NAME\u0026gt;'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e# You might need to set these\u003c/span\u003e\n\u003cspan class=\"n\"\u003esc\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_jsc\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehadoopConfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"fs.s3n.awsAccessKeyId\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u0026lt;AWS_KEY\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003esc\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_jsc\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehadoopConfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"fs.s3n.awsSecretAccessKey\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u0026lt;AWS_SECRET\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e# Set options below\u003c/span\u003e\n\u003cspan class=\"n\"\u003esfOptions\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"s2\"\u003e\"sfURL\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u0026lt;account_identifier\u0026gt;.snowflakecomputing.com\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"s2\"\u003e\"sfUser\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u0026lt;user_name\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"s2\"\u003e\"sfAuthenticator\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"oauth\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"s2\"\u003e\"sfToken\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u0026lt;external_oauth_access_token\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"s2\"\u003e\"sfDatabase\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u0026lt;database\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"s2\"\u003e\"sfSchema\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u0026lt;schema\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"s2\"\u003e\"sfWarehouse\"\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u0026lt;warehouse\u0026gt;\"\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eSNOWFLAKE_SOURCE_NAME\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"net.snowflake.spark.snowflake\"\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003edf\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003espark\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eread\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eformat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSNOWFLAKE_SOURCE_NAME\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \\\n  \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e**\u003c/span\u003e\u003cspan class=\"n\"\u003esfOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \\\n  \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eoption\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"query\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e  \u003cspan class=\"s2\"\u003e\"select 1 as my_num union all select 2 as my_num\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \\\n  \u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eload\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003edf\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eshow\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"21\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003c/section\u003e\n\u003csection id=\"aws-options-for-external-data-transfer\"\u003e\n\u003cspan id=\"label-s3-options\"\u003e\u003c/span\u003e\u003ch3\u003eAWS Options for External Data Transfer\u003ca class=\"headerlink\" href=\"#aws-options-for-external-data-transfer\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eThese options are used to specify the Amazon S3 location where temporary data is stored and provide authentication details for accessing the location. They are required \u003cspan class=\"emph\"\u003eonly\u003c/span\u003e if you are doing an external data transfer. External data transfers are required if either of the following is true:\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003eYou are using version 2.1.x or lower of the Spark Connector (which\ndoes not support internal transfers), or\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eYour transfer is likely to take 36 hours or more (internal transfers\nuse temporary credentials that expire after 36 hours).\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdl\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etempDir\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eThe S3 location where intermediate data is stored (e.g. \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003es3n://xy12345-bucket/spark-snowflake-tmp/\u003c/span\u003e\u003c/code\u003e).\u003c/p\u003e\n\u003cp\u003eIf \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etempDir\u003c/span\u003e\u003c/code\u003e is specified, you must also specify either:\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eawsAccessKey\u003c/span\u003e\u003c/code\u003e , \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eawsSecretKey\u003c/span\u003e\u003c/code\u003e \u003cspan class=\"newline\"\u003e.\u003c/span\u003e or\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etemporary_aws_access_key_id\u003c/span\u003e\u003c/code\u003e , \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etemporary_aws_secret_access_key\u003c/span\u003e\u003c/code\u003e, \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etemporary_aws_session_token\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eawsAccessKey\u003c/span\u003e\u003c/code\u003e , \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eawsSecretKey\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eThese are standard AWS credentials that allow access to the location\nspecified in \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etempDir\u003c/span\u003e\u003c/code\u003e. Note that both of these options must be set\ntogether.\u003c/p\u003e\n\u003cp\u003eIf they are set, they can be retrieved from the existing \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eSparkContext\u003c/span\u003e\u003c/code\u003e object.\u003c/p\u003e\n\u003cp\u003eIf you specify these variables, you must also specify \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etempDir\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eThese credentials should also be set for the Hadoop cluster.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etemporary_aws_access_key_id\u003c/span\u003e\u003c/code\u003e , \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etemporary_aws_secret_access_key\u003c/span\u003e\u003c/code\u003e, \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etemporary_aws_session_token\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eThese are temporary AWS credentials that allow access to the location\nspecified in \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etempDir\u003c/span\u003e\u003c/code\u003e. Note that all three of these options must be\nset together.\u003c/p\u003e\n\u003cp\u003eAlso, if these options are set, they take precedence over the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eawsAccessKey\u003c/span\u003e\u003c/code\u003e and \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eawsSecretKey\u003c/span\u003e\u003c/code\u003e options.\u003c/p\u003e\n\u003cp\u003eIf you specify \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etemporary_aws_access_key_id\u003c/span\u003e\u003c/code\u003e , \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etemporary_aws_secret_access_key\u003c/span\u003e\u003c/code\u003e, and \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etemporary_aws_session_token\u003c/span\u003e\u003c/code\u003e , you must also specify \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etempDir\u003c/span\u003e\u003c/code\u003e. Otherwise, these parameters are ignored.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003echeck_bucket_configuration\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eIf set to \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eon\u003c/span\u003e\u003c/code\u003e (default), the connector checks if the bucket used for data transfer has a lifecycle policy configured (see \u003ca class=\"reference internal\" href=\"spark-connector-install.html#label-spark-s3-setup\"\u003e\u003cspan class=\"std std-ref\"\u003ePreparing an AWS External S3 Bucket\u003c/span\u003e\u003c/a\u003e for more information). If there is no lifecycle\npolicy present, a warning is logged.\u003c/p\u003e\n\u003cp\u003eDisabling this option (by setting to \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoff\u003c/span\u003e\u003c/code\u003e) skips this check. This can be useful if a user can access the bucket data operations, but not the bucket lifecycle policies. Disabling the option can also\nspeed up query execution times slightly.\u003c/p\u003e\n\u003c/dd\u003e\n\u003c/dl\u003e\n\u003cp\u003eFor details, see \u003ca class=\"reference internal\" href=\"#label-spark-auth\"\u003e\u003cspan class=\"std std-ref\"\u003eAuthenticating S3 for Data Exchange\u003c/span\u003e\u003c/a\u003e (in this topic).\u003c/p\u003e\n\u003c/section\u003e\n\u003csection id=\"azure-options-for-external-data-transfer\"\u003e\n\u003cspan id=\"label-azure-options\"\u003e\u003c/span\u003e\u003ch3\u003eAzure Options for External Data Transfer\u003ca class=\"headerlink\" href=\"#azure-options-for-external-data-transfer\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eThis section describes the parameters that apply to Azure Blob storage when\ndoing external data transfers. External data transfers are required if either\nof the following is true:\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003eYou are using version 2.1.x or lower of the Spark Connector (which\ndoes not support internal transfers), or\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eYour transfer is likely to take 36 hours or more (internal transfers\nuse temporary credentials that expire after 36 hours).\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eWhen using an external transfer with Azure Blob storage, you specify the location of the\nAzure container and the SAS (shared-access signature) for that container using\nthe parameters described below.\u003c/p\u003e\n\u003cdl\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etempDir\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eThe Azure Blob storage container where intermediate data is stored.\nThis is in the form of a URL, for example:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ewasb://\u0026lt;azure_container\u0026gt;@\u0026lt;azure_account\u0026gt;.\u0026lt;azure_endpoint\u0026gt;/\u003c/span\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etemporary_azure_sas_token\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003eSpecify the SAS token for Azure Blob storage.\u003c/p\u003e\n\u003c/dd\u003e\n\u003c/dl\u003e\n\u003cp\u003eFor details, see \u003ca class=\"reference internal\" href=\"#label-spark-azure-auth\"\u003e\u003cspan class=\"std std-ref\"\u003eAuthenticating Azure for Data Exchange\u003c/span\u003e\u003c/a\u003e (in this topic).\u003c/p\u003e\n\u003csection id=\"specifying-azure-information-for-temporary-storage-in-spark\"\u003e\n\u003ch4\u003eSpecifying Azure Information for Temporary Storage in Spark\u003ca class=\"headerlink\" href=\"#specifying-azure-information-for-temporary-storage-in-spark\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h4\u003e\n\u003cp\u003eWhen using Azure Blob storage to provide temporary storage to transfer data\nbetween Spark and Snowflake, you must provide Spark, as well as the Snowflake Spark Connector,\nwith the location and credentials for the temporary storage.\u003c/p\u003e\n\u003cp\u003eTo provide Spark with the temporary storage location, execute commands similar to the following\non your Spark cluster:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-scala notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003esc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehadoopConfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"fs.azure\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"org.apache.hadoop.fs.azure.NativeAzureFileSystem\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003esc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehadoopConfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"fs.AbstractFileSystem.wasb.impl\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"org.apache.hadoop.fs.azure.Wasb\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003esc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehadoopConfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"fs.azure.sas.\u0026lt;container\u0026gt;.\u0026lt;account\u0026gt;.\u0026lt;azure_endpoint\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eazure_sas\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"22\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003cp\u003eNote that the last command contains the following variables:\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e\u0026lt;container\u0026gt;\u003c/span\u003e\u003c/code\u003e and \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e\u0026lt;account\u0026gt;\u003c/span\u003e\u003c/code\u003e: These are the container and account name for your Azure deployment.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e\u0026lt;azure_endpoint\u0026gt;\u003c/span\u003e\u003c/code\u003e: This is the endpoint for your Azure deployment location. For example, if you are using an Azure US deployment, the endpoint is likely to be \u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eblob.core.windows.net\u003c/span\u003e\u003c/code\u003e.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode class=\"docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e\u0026lt;azure_sas\u0026gt;\u003c/span\u003e\u003c/code\u003e: This is the Shared Access Signature security token.\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eReplace each of these variables with the proper information for your Azure Blob Storage account.\u003c/p\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003csection id=\"passing-snowflake-session-parameters-as-options-for-the-connector\"\u003e\n\u003ch2\u003ePassing Snowflake Session Parameters as Options for the Connector\u003ca class=\"headerlink\" href=\"#passing-snowflake-session-parameters-as-options-for-the-connector\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eThe Snowflake Connector for Spark supports sending arbitrary session-level parameters to Snowflake (see \u003ca class=\"reference internal\" href=\"../sql-reference/parameters.html#label-session-parameters\"\u003e\u003cspan class=\"std std-ref\"\u003eSession Parameters\u003c/span\u003e\u003c/a\u003e for more info). This can be achieved by adding a\n\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e(\"\u0026lt;key\u0026gt;\"\u003c/span\u003e \u003cspan class=\"pre\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"pre\"\u003e\"\u0026lt;value\u0026gt;\")\u003c/span\u003e\u003c/code\u003e pair to the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoptions\u003c/span\u003e\u003c/code\u003e object, where \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e\u0026lt;key\u0026gt;\u003c/span\u003e\u003c/code\u003e is the session parameter name and \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e\u0026lt;value\u0026gt;\u003c/span\u003e\u003c/code\u003e is the value.\u003c/p\u003e\n\u003cdiv class=\"admonition note\"\u003e\n\u003cp class=\"admonition-title\"\u003eNote\u003c/p\u003e\n\u003cp\u003eThe \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e\u0026lt;value\u0026gt;\u003c/span\u003e\u003c/code\u003e should be a string enclosed in double quotes, even for parameters that accept numbers or Boolean values (e.g. \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e\"1\"\u003c/span\u003e\u003c/code\u003e or \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e\"true\"\u003c/span\u003e\u003c/code\u003e).\u003c/p\u003e\n\u003c/div\u003e\n\u003cp\u003eFor example, the following code sample passes the \u003ca class=\"reference internal\" href=\"../sql-reference/parameters.html#label-use-cached-result\"\u003e\u003cspan class=\"std std-ref\"\u003eUSE_CACHED_RESULT\u003c/span\u003e\u003c/a\u003e session parameter with a value of \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003e\"false\"\u003c/span\u003e\u003c/code\u003e, which disables using the results of previously-executed queries:\u003c/p\u003e\n\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-scala notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e// ... assuming sfOptions contains Snowflake connector options\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// Add to the options request to keep connection alive\u003c/span\u003e\n\u003cspan class=\"n\"\u003esfOptions\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e+=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"USE_CACHED_RESULT\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"false\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// ... now use sfOptions with the .options() method\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"23\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c/section\u003e\n\u003csection id=\"security-considerations\"\u003e\n\u003ch2\u003eSecurity Considerations\u003ca class=\"headerlink\" href=\"#security-considerations\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eCustomers should ensure that in a multi-node Spark system, communications between the nodes are secure. The Spark\nmaster sends Snowflake credentials to Spark workers so that those workers can access Snowflake stages. If\ncommunications between the Spark master and Spark workers are not secure, the credentials could be read by an\nunauthorized third party.\u003c/p\u003e\n\u003c/section\u003e\n\u003csection id=\"authenticating-s3-for-data-exchange\"\u003e\n\u003cspan id=\"label-spark-auth\"\u003e\u003c/span\u003e\u003ch2\u003eAuthenticating S3 for Data Exchange\u003ca class=\"headerlink\" href=\"#authenticating-s3-for-data-exchange\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eThis section describes how to authenticate when using S3 for data exchange.\u003c/p\u003e\n\u003cp\u003eThis task is required \u003cspan class=\"emph\"\u003eonly\u003c/span\u003e in either of the following circumstances:\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003eThe Snowflake Connector for Spark version is 2.1.x (or lower). Starting with v2.2.0, the connector uses a Snowflake internal temporary stage for data exchange. If you are not currently using version 2.2.0 (or higher) of the connector, Snowflake strongly recommends upgrading to the latest version.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eThe Snowflake Connector for Spark version is 2.2.0 (or higher), but your jobs regularly exceed 36 hours in length. This is the maximum duration for the AWS token used by the connector to access the internal stage for data exchange.\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIf you are using an older version of the connector, you need to prepare an S3 location that the connector can use to exchange data between Snowflake and Spark.\u003c/p\u003e\n\u003cp\u003eTo allow access to the S3 bucket/directory used to exchange data between Spark and Snowflake (as specified for \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etempDir\u003c/span\u003e\u003c/code\u003e), two authentication methods are supported:\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003ePermanent AWS credentials (also used to configure Hadoop/Spark authentication for accessing S3)\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eTemporary AWS credentials\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003csection id=\"using-permanent-aws-credentials\"\u003e\n\u003ch3\u003eUsing Permanent AWS Credentials\u003ca class=\"headerlink\" href=\"#using-permanent-aws-credentials\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eThis is the standard AWS authentication method. It requires a pair of \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eawsAccessKey\u003c/span\u003e\u003c/code\u003e and \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eawsSecretKey\u003c/span\u003e\u003c/code\u003e values.\u003c/p\u003e\n\u003cdiv class=\"admonition note\"\u003e\n\u003cp class=\"admonition-title\"\u003eNote\u003c/p\u003e\n\u003cp\u003eThese values should also be used to configure Hadoop/Spark for accessing S3. For more information, including examples, see \u003ca class=\"reference internal\" href=\"#label-spark-s3a-s3n\"\u003e\u003cspan class=\"std std-ref\"\u003eAuthenticating Hadoop/Spark Using S3A or S3N\u003c/span\u003e\u003c/a\u003e (in this topic).\u003c/p\u003e\n\u003c/div\u003e\n\u003cp\u003eFor example:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-scala notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003esc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehadoopConfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"fs.s3n.awsAccessKeyId\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;access_key\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003esc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehadoopConfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"fs.s3n.awsSecretAccessKey\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;secret_key\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// Then, configure your Snowflake environment\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n\u003cspan class=\"kd\"\u003evar\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esfOptions\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nc\"\u003eMap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfURL\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;account_identifier\u0026gt;.snowflakecomputing.com\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfUser\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;user_name\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfPassword\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;password\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfDatabase\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;database\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfSchema\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;schema\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfWarehouse\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;warehouse\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"awsAccessKey\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehadoopConfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"fs.s3n.awsAccessKeyId\"\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"awsSecretKey\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehadoopConfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"fs.s3n.awsSecretAccessKey\"\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"s\"\u003e\"tempdir\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"s3n://\u0026lt;temp-bucket-name\u0026gt;\"\u003c/span\u003e\n\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"24\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003cp\u003eFor details about the options supported by \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfOptions\u003c/span\u003e\u003c/code\u003e, see \u003ca class=\"reference internal\" href=\"#label-s3-options\"\u003e\u003cspan class=\"std std-ref\"\u003eAWS Options for External Data Transfer\u003c/span\u003e\u003c/a\u003e (in this topic).\u003c/p\u003e\n\u003csection id=\"authenticating-hadoop-spark-using-s3a-or-s3n\"\u003e\n\u003cspan id=\"label-spark-s3a-s3n\"\u003e\u003c/span\u003e\u003ch4\u003eAuthenticating Hadoop/Spark Using S3A or S3N\u003ca class=\"headerlink\" href=\"#authenticating-hadoop-spark-using-s3a-or-s3n\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h4\u003e\n\u003cp\u003eHadoop/Spark ecosystems support 2 URI schemes for \u003ca class=\"reference external\" href=\"https://wiki.apache.org/hadoop/AmazonS3/\"\u003eaccessing S3\u003c/a\u003e:\u003c/p\u003e\n\u003cdl\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003es3a://\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003e\u003cstrong\u003eNew, recommended method (for Hadoop 2.7 and higher)\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eTo use this method, modify the Scala examples in this topic to add the following Hadoop configuration options:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-scala notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"kd\"\u003eval\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ehadoopConf\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehadoopConfiguration\u003c/span\u003e\n\u003cspan class=\"n\"\u003ehadoopConf\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"fs.s3a.access.key\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eaccessKey\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003ehadoopConf\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"fs.s3a.secret.key\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003esecretKey\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"25\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003cp\u003eMake sure the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etempdir\u003c/span\u003e\u003c/code\u003e option uses \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003es3a://\u003c/span\u003e\u003c/code\u003e as well.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003es3n://\u003c/span\u003e\u003c/code\u003e\u003c/dt\u003e\u003cdd\u003e\u003cp\u003e\u003cstrong\u003eOlder method (for Hadoop 2.6 and lower)\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eIn some systems, it is necessary to specify it explicitly as shown in the following Scala example:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-scala notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"kd\"\u003eval\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ehadoopConf\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehadoopConfiguration\u003c/span\u003e\n\u003cspan class=\"n\"\u003ehadoopConf\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"fs.s3.impl\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"org.apache.hadoop.fs.s3native.NativeS3FileSystem\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003ehadoopConf\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"fs.s3.awsAccessKeyId\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eaccessKey\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003ehadoopConf\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"fs.s3.awsSecretAccessKey\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003esecretKey\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"26\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003c/dd\u003e\n\u003c/dl\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003csection id=\"using-temporary-aws-credentials\"\u003e\n\u003ch3\u003eUsing Temporary AWS Credentials\u003ca class=\"headerlink\" href=\"#using-temporary-aws-credentials\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eThis method uses the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etemporary_aws_access_key_id\u003c/span\u003e\u003c/code\u003e, \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etemporary_aws_secret_access_key\u003c/span\u003e\u003c/code\u003e, and \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etemporary_aws_session_token\u003c/span\u003e\u003c/code\u003e configuration options for the connector.\u003c/p\u003e\n\u003cp\u003eThis method allows additional security by providing Snowflake with only temporary access to the S3 bucket/directory used for data exchange.\u003c/p\u003e\n\u003cdiv class=\"admonition note\"\u003e\n\u003cp class=\"admonition-title\"\u003eNote\u003c/p\u003e\n\u003cp\u003eTemporary credentials can only be used to configure the S3 authentication for the connector; they cannot be used to configure Hadoop/Spark authentication.\u003c/p\u003e\n\u003cp\u003eAlso, if you provide temporary credentials, they take precedence over any permanent credentials that have been provided.\u003c/p\u003e\n\u003c/div\u003e\n\u003cp\u003eThe following Scala code sample provides an example of authenticating using temporary credentials:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-scala notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nn\"\u003ecom\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nn\"\u003eamazonaws\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nn\"\u003eservices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nn\"\u003esecuritytoken\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003eAWSSecurityTokenServiceClient\u003c/span\u003e\n\u003cspan class=\"k\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nn\"\u003ecom\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nn\"\u003eamazonaws\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nn\"\u003eservices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nn\"\u003esecuritytoken\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nn\"\u003emodel\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003eGetSessionTokenRequest\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nn\"\u003enet\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nn\"\u003esnowflake\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nn\"\u003espark\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nn\"\u003esnowflake\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003eParameters\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// ...\u003c/span\u003e\n\n\u003cspan class=\"kd\"\u003eval\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ests_client\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nc\"\u003eAWSSecurityTokenServiceClient\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"kd\"\u003eval\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esession_token_request\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nc\"\u003eGetSessionTokenRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// Set the token duration to 2 hours.\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003esession_token_request\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esetDurationSeconds\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e7200\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"kd\"\u003eval\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esession_token_result\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ests_client\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003egetSessionToken\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esession_token_request\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"kd\"\u003eval\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esession_creds\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esession_token_result\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003egetCredentials\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// Create a new set of Snowflake connector options, based on the existing\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// sfOptions definition, with additional temporary credential options that override\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// the credential options in sfOptions.\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// Note that constants from Parameters are used to guarantee correct\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// key names, but literal values, such as temporary_aws_access_key_id are, of course,\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// also allowed.\u003c/span\u003e\n\n\u003cspan class=\"kd\"\u003evar\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esfOptions2\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecollection\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emutable\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003eMap\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nc\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nc\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e]()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e++=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esfOptions\u003c/span\u003e\n\u003cspan class=\"n\"\u003esfOptions2\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e+=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eParameters\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003ePARAM_TEMP_KEY_ID\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esession_creds\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003egetAccessKeyId\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n\u003cspan class=\"n\"\u003esfOptions2\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e+=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eParameters\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003ePARAM_TEMP_KEY_SECRET\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esession_creds\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003egetSecretAccessKey\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n\u003cspan class=\"n\"\u003esfOptions2\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e+=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eParameters\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003ePARAM_TEMP_SESSION_TOKEN\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esession_creds\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003egetSessionToken\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"27\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003cp\u003e\u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfOptions2\u003c/span\u003e\u003c/code\u003e can now be used with the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003eoptions()\u003c/span\u003e\u003c/code\u003e DataFrame method.\u003c/p\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003csection id=\"authenticating-azure-for-data-exchange\"\u003e\n\u003cspan id=\"label-spark-azure-auth\"\u003e\u003c/span\u003e\u003ch2\u003eAuthenticating Azure for Data Exchange\u003ca class=\"headerlink\" href=\"#authenticating-azure-for-data-exchange\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eThis section describes how to authenticate when using Azure Blob storage for data exchange.\u003c/p\u003e\n\u003cp\u003eAuthenticating this way is required \u003cspan class=\"emph\"\u003eonly\u003c/span\u003e in either of the following circumstances:\u003c/p\u003e\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003eThe Snowflake Connector for Spark version is 2.1.x (or lower). Starting with\nv2.2.0, the connector uses a Snowflake internal temporary stage for data\nexchange. If you are not currently using version 2.2.0 (or higher) of the\nconnector, Snowflake strongly recommends upgrading to the latest version.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eThe Snowflake Connector for Spark version is 2.2.0 (or higher), but your\njobs regularly exceed 36 hours in length. This is the maximum duration for\nthe Azure token used by the connector to access the internal stage for\ndata exchange.\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eYou need to prepare an Azure Blob storage container that the connector can use to\nexchange data between Snowflake and Spark.\u003c/p\u003e\n\u003csection id=\"using-azure-credentials\"\u003e\n\u003ch3\u003eUsing Azure Credentials\u003ca class=\"headerlink\" href=\"#using-azure-credentials\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eThis is the standard Azure Blob storage authentication method. It requires a pair of\nvalues: \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etempDir\u003c/span\u003e\u003c/code\u003e (a URL) and \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etemporary_azure_sas_token\u003c/span\u003e\u003c/code\u003e values.\u003c/p\u003e\n\u003cdiv class=\"admonition note\"\u003e\n\u003cp class=\"admonition-title\"\u003eNote\u003c/p\u003e\n\u003cp\u003eThese values should also be used to configure Hadoop/Spark for accessing Azure Blob storage. For more information, including examples, see \u003ca class=\"reference internal\" href=\"#label-spark-azure\"\u003e\u003cspan class=\"std std-ref\"\u003eAuthenticating Hadoop/Spark Using Azure\u003c/span\u003e\u003c/a\u003e (in this topic).\u003c/p\u003e\n\u003c/div\u003e\n\u003cp\u003eFor example:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-scala notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003esc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehadoopConfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"fs.azure\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"org.apache.hadoop.fs.azure.NativeAzureFileSystem\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003esc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehadoopConfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"fs.AbstractFileSystem.wasb.impl\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"org.apache.hadoop.fs.azure.Wasb\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003esc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehadoopConfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"fs.azure.sas.\u0026lt;container\u0026gt;.\u0026lt;account\u0026gt;.\u0026lt;azure_endpoint\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eazure_sas\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// Then, configure your Snowflake environment\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n\u003cspan class=\"kd\"\u003eval\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esfOptions\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nc\"\u003eMap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfURL\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;account_identifier\u0026gt;.snowflakecomputing.com\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfUser\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;user_name\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfPassword\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;password\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfDatabase\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;database_name\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfSchema\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;schema_name\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfWarehouse\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;warehouse_name\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfCompress\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"on\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"s\"\u003e\"sfSSL\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"on\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"s\"\u003e\"tempdir\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"wasb://\u0026lt;azure_container\u0026gt;@\u0026lt;azure_account\u0026gt;.\u0026lt;Azure_endpoint\u0026gt;/\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"s\"\u003e\"temporary_azure_sas_token\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u0026lt;azure_sas\u0026gt;\"\u003c/span\u003e\n\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"28\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003cp\u003eFor details about the options supported by \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003esfOptions\u003c/span\u003e\u003c/code\u003e, see \u003ca class=\"reference internal\" href=\"#label-azure-options\"\u003e\u003cspan class=\"std std-ref\"\u003eAzure Options for External Data Transfer\u003c/span\u003e\u003c/a\u003e (in this topic).\u003c/p\u003e\n\u003csection id=\"authenticating-hadoop-spark-using-azure\"\u003e\n\u003cspan id=\"label-spark-azure\"\u003e\u003c/span\u003e\u003ch4\u003eAuthenticating Hadoop/Spark Using Azure\u003ca class=\"headerlink\" href=\"#authenticating-hadoop-spark-using-azure\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h4\u003e\n\u003cp\u003eTo use this method, modify the Scala examples in this topic to add the following Hadoop configuration options:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cdiv\u003e\u003cdiv class=\"relative group text-sm\"\u003e\u003cdiv class=\"highlight-scala notranslate\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan class=\"kd\"\u003eval\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ehadoopConf\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehadoopConfiguration\u003c/span\u003e\n\u003cspan class=\"n\"\u003esc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehadoopConfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"fs.azure\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"org.apache.hadoop.fs.azure.NativeAzureFileSystem\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003esc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehadoopConfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"fs.AbstractFileSystem.wasb.impl\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\"org.apache.hadoop.fs.azure.Wasb\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003esc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehadoopConfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"fs.azure.sas.\u0026lt;container\u0026gt;.\u0026lt;account\u0026gt;.\u0026lt;azure_endpoint\u0026gt;\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eazure_sas\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\u003cdiv data-codeblock-index=\"29\" class=\"copybutton\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 384 512\" class=\"copybutton-icon icon-copy\"\u003e\u003cpath d=\"M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 512 512\" class=\"copybutton-icon icon-copied hidden\"\u003e\u003cpath d=\"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003cspan\u003eCopy\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\u003c/blockquote\u003e\n\u003cp\u003eMake sure the \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003etempdir\u003c/span\u003e\u003c/code\u003e option uses \u003ccode class=\"code docutils literal notranslate\"\u003e\u003cspan class=\"pre\"\u003ewasb://\u003c/span\u003e\u003c/code\u003e as well.\u003c/p\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\u003csection id=\"authenticating-through-a-browser-is-not-supported\"\u003e\n\u003ch2\u003eAuthenticating Through a Browser is Not Supported\u003ca class=\"headerlink\" href=\"#authenticating-through-a-browser-is-not-supported\" title=\"Link to this heading\"\u003e¶\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eWhen using the Spark Connector, it is impractical to use any form of authentication that would open a browser\nwindow to ask the user for credentials. The window would not necessarily appear on the client machine. Therefore, the\nSpark Connector does not support any type of authentication, including MFA (Multi-Factor Authentication) or SSO\n(Single Sign-On), that would invoke a browser window.\u003c/p\u003e\n\u003c/section\u003e\n\u003c/section\u003e\n\n\n","headings":[{"label":"Verifying the Network Connection to Snowflake with SnowCD","depth":1,"href":"verifying-the-network-connection-to-snowflake-with-snowcd"},{"label":"Pushdown","depth":1,"href":"pushdown"},{"label":"Using the Connector in Scala","depth":1,"href":"using-the-connector-in-scala"},{"label":"Using the Connector with Python","depth":1,"href":"using-the-connector-with-python"},{"label":"Data Type Mappings","depth":1,"href":"data-type-mappings"},{"label":"Calling the DataFrame.show Method","depth":1,"href":"calling-the-dataframe-show-method"},{"label":"Setting Configuration Options for the Connector","depth":1,"href":"setting-configuration-options-for-the-connector"},{"label":"Passing Snowflake Session Parameters as Options for the Connector","depth":1,"href":"passing-snowflake-session-parameters-as-options-for-the-connector"},{"label":"Security Considerations","depth":1,"href":"security-considerations"},{"label":"Authenticating S3 for Data Exchange","depth":1,"href":"authenticating-s3-for-data-exchange"},{"label":"Authenticating Azure for Data Exchange","depth":1,"href":"authenticating-azure-for-data-exchange"},{"label":"Authenticating Through a Browser is Not Supported","depth":1,"href":"authenticating-through-a-browser-is-not-supported"}],"mastheads":[{"label":"Getting Started","href":"/en/user-guide-getting-started","active":false},{"label":"Guides","href":"/en/guides","active":false},{"label":"Developer","href":"/en/developer","active":true},{"label":"Reference","href":"/en/reference","active":false},{"label":"Releases","href":"/en/release-notes/new-features","active":false},{"label":"Tutorials","href":"/en/tutorials","active":false}],"title":"Using the Spark Connector | Snowflake Documentation","breadcrumbs":[{"label":"Developer","href":"/en/developer"},{"label":"Kafka and Spark Connectors","href":"/en/user-guide/connectors"},{"label":"Spark Connector","href":"/en/user-guide/spark-connector"},{"label":"Usage","href":"/en/user-guide/spark-connector-use"}],"relatedTopics":[],"notices":[],"relatedInfo":"\n\n\n\u003cul class=\"simple\"\u003e\n\u003cli\u003e\u003cp\u003e\u003ca class=\"reference external\" href=\"https://www.snowflake.com/snowflake-and-spark-part-1-why-spark/\"\u003eWhy Spark?\u003c/a\u003e (Snowflake Blog)\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ca class=\"reference external\" href=\"https://www.snowflake.com/snowflake-spark-part-2-pushing-query-processing/\"\u003ePushing Spark Query Processing to Snowflake\u003c/a\u003e (Snowflake Blog)\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","sqlExamples":[],"lang":"en","tree":{"depth":0,"label":"Developer","type":"masthead","href":"/en/developer","active":false,"parentRef":"/en/","children":[{"label":"Overview","type":"page","href":"/en/developer","active":false,"depth":0,"isInitiallyOpen":false,"parentRef":"/en/developer","children":[]},{"type":"category","depth":0,"label":"Snowpark Library"},{"label":"Snowpark API","type":"page","href":"/en/developer-guide/snowpark/index","active":false,"depth":0,"isInitiallyOpen":false,"parentRef":"/en/developer","children":[{"label":"Java","type":"page","href":"/en/developer-guide/snowpark/java/index","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/index","children":[{"label":"Setting Up a Development Environment","type":"page","href":"/en/developer-guide/snowpark/java/setup","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/java/index","children":[{"label":"Prerequisites","type":"page","href":"/en/developer-guide/snowpark/java/prerequisites","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/java/setup","children":[]},{"label":"IntelliJ IDEA","type":"page","href":"/en/developer-guide/snowpark/java/quickstart-intellij","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/java/setup","children":[]},{"label":"Other","type":"page","href":"/en/developer-guide/snowpark/java/setup-other-environments","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/java/setup","children":[]}]},{"label":"Creating a Session","type":"page","href":"/en/developer-guide/snowpark/java/creating-session","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/java/index","children":[]},{"label":"Using DataFrames","type":"page","href":"/en/developer-guide/snowpark/java/working-with-dataframes","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/java/index","children":[]},{"label":"Creating User Defined Functions","type":"page","href":"/en/developer-guide/snowpark/java/creating-udfs","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/java/index","children":[]},{"label":"Creating Stored Procedures","type":"page","href":"/en/developer-guide/snowpark/java/creating-sprocs","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/java/index","children":[]},{"label":"Calling Functions and Stored Procedures","type":"page","href":"/en/developer-guide/snowpark/java/calling-functions","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/java/index","children":[]},{"label":"Example","type":"page","href":"/en/developer-guide/snowpark/java/example","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/java/index","children":[]},{"label":"Troubleshooting","type":"page","href":"/en/developer-guide/snowpark/java/troubleshooting","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/java/index","children":[]},{"label":"Map of Java APIs to SQL Commands","type":"page","href":"/en/developer-guide/snowpark/java/sql-to-snowpark","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/java/index","children":[]},{"label":"Java API Reference","type":"external","href":"/developer-guide/snowpark/reference/java/index.html","depth":2}]},{"label":"Python","type":"page","href":"/en/developer-guide/snowpark/python/index","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/index","children":[{"label":"Setting Up a Development Environment","type":"page","href":"/en/developer-guide/snowpark/python/setup","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/python/index","children":[]},{"label":"Creating a Session","type":"page","href":"/en/developer-guide/snowpark/python/creating-session","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/python/index","children":[]},{"label":"Writing Snowpark Code in Python Worksheets","type":"page","href":"/en/developer-guide/snowpark/python/python-worksheets","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/python/index","children":[]},{"label":"Using DataFrames","type":"page","href":"/en/developer-guide/snowpark/python/working-with-dataframes","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/python/index","children":[]},{"label":"Creating User Defined Functions","type":"page","href":"/en/developer-guide/snowpark/python/creating-udfs","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/python/index","children":[]},{"label":"Creating User Defined Table Functions","type":"page","href":"/en/developer-guide/snowpark/python/creating-udtfs","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/python/index","children":[]},{"label":"Creating Stored Procedures for DataFrames","type":"page","href":"/en/developer-guide/snowpark/python/creating-sprocs","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/python/index","children":[]},{"label":"Calling Functions and Stored Procedures","type":"page","href":"/en/developer-guide/snowpark/python/calling-functions","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/python/index","children":[]},{"label":"Training Machine Learning Models with Snowpark Python","type":"page","href":"/en/developer-guide/snowpark/python/python-snowpark-training-ml","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/python/index","children":[]},{"label":"Writing Tests for Snowpark Python","type":"page","href":"/en/developer-guide/snowpark/python/testing-python-snowpark","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/python/index","children":[]},{"label":"Local Testing Framework","type":"page","href":"/en/developer-guide/snowpark/python/testing-locally","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/python/index","children":[]},{"label":"Tutorial: Testing Python Snowpark","type":"page","href":"/en/developer-guide/snowpark/python/tutorials/testing-tutorial","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/python/index","children":[]},{"label":"Troubleshooting","type":"page","href":"/en/developer-guide/snowpark/python/troubleshooting","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/python/index","children":[]},{"label":"Python API Reference","type":"page","href":"/en/developer-guide/snowpark/reference/python/latest/index","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/python/index","hideBreadcrumb":true,"children":[]}]},{"label":"Scala","type":"page","href":"/en/developer-guide/snowpark/scala/index","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/index","children":[{"label":"Setting Up a Development Environment","type":"page","href":"/en/developer-guide/snowpark/scala/setup","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/scala/index","children":[{"label":"Prerequisites","type":"page","href":"/en/developer-guide/snowpark/scala/prerequisites","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/scala/setup","children":[]},{"label":"Visual Studio Code","type":"page","href":"/en/developer-guide/snowpark/scala/quickstart-vscode","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/scala/setup","children":[]},{"label":"IntelliJ IDEA","type":"page","href":"/en/developer-guide/snowpark/scala/quickstart-intellij","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/scala/setup","children":[]},{"label":"SBT REPL","type":"page","href":"/en/developer-guide/snowpark/scala/quickstart-sbt","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/scala/setup","children":[]},{"label":"Scala REPL","type":"page","href":"/en/developer-guide/snowpark/scala/quickstart-scala-repl","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/scala/setup","children":[]},{"label":"Jupyter Notebook","type":"page","href":"/en/developer-guide/snowpark/scala/quickstart-jupyter","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/scala/setup","children":[]},{"label":"Other","type":"page","href":"/en/developer-guide/snowpark/scala/setup-other-environments","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/scala/setup","children":[]}]},{"label":"Creating a Session","type":"page","href":"/en/developer-guide/snowpark/scala/creating-session","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/scala/index","children":[]},{"label":"Using DataFrames","type":"page","href":"/en/developer-guide/snowpark/scala/working-with-dataframes","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/scala/index","children":[]},{"label":"Creating User-Defined Functions","type":"page","href":"/en/developer-guide/snowpark/scala/creating-udfs","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/scala/index","children":[]},{"label":"Creating Stored Procedures","type":"page","href":"/en/developer-guide/snowpark/scala/creating-sprocs","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/scala/index","children":[]},{"label":"Calling Functions and Stored Procedures","type":"page","href":"/en/developer-guide/snowpark/scala/calling-functions","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/scala/index","children":[]},{"label":"Example","type":"page","href":"/en/developer-guide/snowpark/scala/example","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/scala/index","children":[]},{"label":"Troubleshooting","type":"page","href":"/en/developer-guide/snowpark/scala/troubleshooting","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/scala/index","children":[]},{"label":"Map of Scala APIs to SQL Commands","type":"page","href":"/en/developer-guide/snowpark/scala/sql-to-snowpark","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark/scala/index","children":[]},{"label":"Scala API Reference","type":"external","href":"/developer-guide/snowpark/reference/scala/com/snowflake/snowpark/index.html","depth":2}]}]},{"label":"Snowpark ML","type":"page","href":"/en/developer-guide/snowpark-ml/index","active":false,"depth":0,"isInitiallyOpen":false,"parentRef":"/en/developer","children":[{"label":"Modeling","type":"page","href":"/en/developer-guide/snowpark-ml/snowpark-ml-modeling","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark-ml/index","children":[]},{"label":"Model Registry","type":"page","href":"/en/developer-guide/snowpark-ml/snowpark-ml-mlops-model-registry","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark-ml/index","children":[{"label":"Custom Models and Pipelines","type":"page","href":"/en/developer-guide/snowpark-ml/snowpark-ml-mlops-custom-models","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark-ml/snowpark-ml-mlops-model-registry","children":[]},{"label":"Migrating from Preview API","type":"page","href":"/en/developer-guide/snowpark-ml/snowpark-ml-mlops-model-registry-api-diff","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark-ml/snowpark-ml-mlops-model-registry","children":[]}]},{"label":"FileSystem and FileSet","type":"page","href":"/en/developer-guide/snowpark-ml/snowpark-ml-filesystem-fileset","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark-ml/index","children":[]},{"label":"Framework Connectors","type":"page","href":"/en/developer-guide/snowpark-ml/snowpark-ml-framework-connectors","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark-ml/index","children":[]},{"label":"Snowpark ML API Reference","type":"page","href":"/en/developer-guide/snowpark-ml/reference/latest/index","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark-ml/index","hideBreadcrumb":true,"children":[]}]},{"type":"category","depth":0,"label":"Snowpark Runtime"},{"label":"Snowpark Container Services","type":"page","href":"/en/developer-guide/snowpark-container-services/overview","active":false,"depth":0,"isInitiallyOpen":false,"parentRef":"/en/developer","children":[{"label":"Tutorials","type":"page","href":"/en/developer-guide/snowpark-container-services/overview-tutorials","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark-container-services/overview","children":[{"label":"Common Setup","type":"page","href":"/en/developer-guide/snowpark-container-services/tutorials/common-setup","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark-container-services/overview-tutorials","children":[]},{"label":"Tutorial 1: Create a Service","type":"page","href":"/en/developer-guide/snowpark-container-services/tutorials/tutorial-1","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark-container-services/overview-tutorials","children":[]},{"label":"Tutorial 2: Create a Job Service","type":"page","href":"/en/developer-guide/snowpark-container-services/tutorials/tutorial-2","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark-container-services/overview-tutorials","children":[]}]},{"label":"Service Specification Reference","type":"page","href":"/en/developer-guide/snowpark-container-services/specification-reference","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark-container-services/overview","children":[]},{"label":"Working with an Image Registry and Repository","type":"page","href":"/en/developer-guide/snowpark-container-services/working-with-registry-repository","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark-container-services/overview","children":[]},{"label":"Working with Compute Pools","type":"page","href":"/en/developer-guide/snowpark-container-services/working-with-compute-pool","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark-container-services/overview","children":[{"label":"Compute Pool Metrics","type":"page","href":"/en/developer-guide/snowpark-container-services/compute-pool-metrics-overview","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark-container-services/working-with-compute-pool","children":[]}]},{"label":"Working with Services","type":"page","href":"/en/developer-guide/snowpark-container-services/working-with-services","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark-container-services/overview","children":[]},{"label":"Additional Considerations for Services","type":"page","href":"/en/developer-guide/snowpark-container-services/additional-considerations-services-jobs","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark-container-services/overview","children":[]},{"label":"Snowpark Container Services Troubleshooting","type":"page","href":"/en/developer-guide/snowpark-container-services/troubleshooting","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark-container-services/overview","children":[]},{"label":"Snowpark Container Services Costs","type":"page","href":"/en/developer-guide/snowpark-container-services/accounts-orgs-usage-views","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark-container-services/overview","children":[]},{"label":"Advanced Tutorials","type":"page","href":"/en/developer-guide/snowpark-container-services/overview-advanced-tutorials","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark-container-services/overview","children":[{"label":"Tutorial 3: Service to Service Communications","type":"page","href":"/en/developer-guide/snowpark-container-services/tutorials/advanced/tutorial-3","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowpark-container-services/overview-advanced-tutorials","children":[]}]}]},{"label":"Functions and Procedures","type":"page","href":"/en/developer-guide/extensibility","active":false,"depth":0,"isInitiallyOpen":false,"parentRef":"/en/developer","children":[{"label":"Function or Procedure?","type":"page","href":"/en/developer-guide/stored-procedures-vs-udfs","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/extensibility","children":[]},{"label":"Guidelines","type":"page","href":"/en/developer-guide/udf-stored-procedure-guidelines","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/extensibility","children":[{"label":"Handler Inline or on a Stage?","type":"page","href":"/en/developer-guide/inline-or-staged","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf-stored-procedure-guidelines","children":[]},{"label":"Security Practices","type":"page","href":"/en/developer-guide/udf-stored-procedure-security-practices","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf-stored-procedure-guidelines","children":[]},{"label":"Java Runtime Support","type":"page","href":"/en/developer-guide/java-runtime-support-policy","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf-stored-procedure-guidelines","children":[]},{"label":"Python Runtime Support","type":"page","href":"/en/developer-guide/python-runtime-support-policy","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf-stored-procedure-guidelines","children":[]},{"label":"Secure UDFs and Procedures","type":"page","href":"/en/developer-guide/secure-udf-procedure","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf-stored-procedure-guidelines","children":[]},{"label":"Pushdown Optimization and Data Visibility","type":"page","href":"/en/developer-guide/pushdown-optimization","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf-stored-procedure-guidelines","children":[]},{"label":"Designing for Snowflake Constraints","type":"page","href":"/en/developer-guide/udf-stored-procedure-constraints","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf-stored-procedure-guidelines","children":[]},{"label":"Naming and Overloading","type":"page","href":"/en/developer-guide/udf-stored-procedure-naming-conventions","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf-stored-procedure-guidelines","children":[]},{"label":"Arguments","type":"page","href":"/en/developer-guide/udf-stored-procedure-arguments","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf-stored-procedure-guidelines","children":[]},{"label":"Data Type Mappings","type":"page","href":"/en/developer-guide/udf-stored-procedure-data-type-mapping","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf-stored-procedure-guidelines","children":[]},{"label":"Uploading Dependencies","type":"page","href":"/en/developer-guide/upload-dependencies","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf-stored-procedure-guidelines","children":[]}]},{"label":"Stored Procedures","type":"page","href":"/en/developer-guide/stored-procedure/stored-procedures-overview","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/extensibility","children":[{"label":"Usage","type":"page","href":"/en/developer-guide/stored-procedure/stored-procedures-usage","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/stored-procedure/stored-procedures-overview","children":[]},{"label":"Caller and Owner Rights","type":"page","href":"/en/developer-guide/stored-procedure/stored-procedures-rights","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/stored-procedure/stored-procedures-overview","children":[]},{"label":"Creating","type":"page","href":"/en/developer-guide/stored-procedure/stored-procedures-creating-sql","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/stored-procedure/stored-procedures-overview","children":[]},{"label":"Calling","type":"page","href":"/en/developer-guide/stored-procedure/stored-procedures-calling","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/stored-procedure/stored-procedures-overview","children":[]},{"label":"Passing in References","type":"page","href":"/en/developer-guide/stored-procedure/stored-procedures-calling-references","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/stored-procedure/stored-procedures-overview","children":[]},{"type":"category","depth":2,"label":"Handler Writing"},{"label":"Java","type":"page","href":"/en/developer-guide/stored-procedure/stored-procedures-java","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/stored-procedure/stored-procedures-overview","children":[]},{"label":"Javascript","type":"page","href":"/en/developer-guide/stored-procedure/stored-procedures-javascript","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/stored-procedure/stored-procedures-overview","children":[{"label":"API","type":"page","href":"/en/developer-guide/stored-procedure/stored-procedures-api","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/stored-procedure/stored-procedures-javascript","children":[]}]},{"label":"Python","type":"page","href":"/en/developer-guide/stored-procedure/stored-procedures-python","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/stored-procedure/stored-procedures-overview","children":[]},{"label":"Scala","type":"page","href":"/en/developer-guide/stored-procedure/stored-procedures-scala","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/stored-procedure/stored-procedures-overview","children":[]},{"label":"Snowflake Scripting","type":"page","href":"/en/developer-guide/stored-procedure/stored-procedures-snowflake-scripting","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/stored-procedure/stored-procedures-overview","children":[]}]},{"label":"User-Defined Functions","type":"page","href":"/en/developer-guide/udf/udf-overview","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/extensibility","children":[{"label":"Privileges","type":"page","href":"/en/developer-guide/udf/udf-access-control","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/udf-overview","children":[]},{"label":"Creating","type":"page","href":"/en/developer-guide/udf/udf-creating-sql","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/udf-overview","children":[]},{"label":"Calling","type":"page","href":"/en/developer-guide/udf/udf-calling-sql","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/udf-overview","children":[]},{"label":"Viewing in Snowsight","type":"page","href":"/en/user-guide/ui-snowsight-data-databases-function","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/udf-overview","children":[]},{"type":"category","depth":2,"label":"Handler Writing"},{"label":"Java","type":"page","href":"/en/developer-guide/udf/java/udf-java-introduction","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/udf-overview","children":[{"label":"Limitations","type":"page","href":"/en/developer-guide/udf/java/udf-java-limitations","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/java/udf-java-introduction","children":[]},{"label":"Designing","type":"page","href":"/en/developer-guide/udf/java/udf-java-designing","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/java/udf-java-introduction","children":[]},{"label":"Creating","type":"page","href":"/en/developer-guide/udf/java/udf-java-creating","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/java/udf-java-introduction","children":[]},{"label":"Table Functions","type":"page","href":"/en/developer-guide/udf/java/udf-java-tabular-functions","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/java/udf-java-introduction","children":[]},{"label":"Examples","type":"page","href":"/en/developer-guide/udf/java/udf-java-cookbook","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/java/udf-java-introduction","children":[]},{"label":"Troubleshooting","type":"page","href":"/en/developer-guide/udf/java/udf-java-troubleshooting","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/java/udf-java-introduction","children":[]}]},{"label":"Javascript","type":"page","href":"/en/developer-guide/udf/javascript/udf-javascript-introduction","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/udf-overview","children":[{"label":"Limitations","type":"page","href":"/en/developer-guide/udf/javascript/udf-javascript-limitations","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/javascript/udf-javascript-introduction","children":[]},{"label":"Scalar Functions","type":"page","href":"/en/developer-guide/udf/javascript/udf-javascript-scalar-functions","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/javascript/udf-javascript-introduction","children":[]},{"label":"Table Functions","type":"page","href":"/en/developer-guide/udf/javascript/udf-javascript-tabular-functions","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/javascript/udf-javascript-introduction","children":[]},{"label":"Troubleshooting","type":"page","href":"/en/developer-guide/udf/javascript/udf-javascript-troubleshooting","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/javascript/udf-javascript-introduction","children":[]}]},{"label":"Python","type":"page","href":"/en/developer-guide/udf/python/udf-python-introduction","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/udf-overview","children":[{"label":"Limitations","type":"page","href":"/en/developer-guide/udf/python/udf-python-limitations","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/python/udf-python-introduction","children":[]},{"label":"Designing","type":"page","href":"/en/developer-guide/udf/python/udf-python-designing","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/python/udf-python-introduction","children":[]},{"label":"Creating","type":"page","href":"/en/developer-guide/udf/python/udf-python-creating","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/python/udf-python-introduction","children":[]},{"label":"Table Functions","type":"page","href":"/en/developer-guide/udf/python/udf-python-tabular-functions","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/python/udf-python-introduction","children":[]},{"label":"Vectorized UDFs","type":"page","href":"/en/developer-guide/udf/python/udf-python-batch","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/python/udf-python-introduction","children":[]},{"label":"Vectorized UDTFs","type":"page","href":"/en/developer-guide/udf/python/udf-python-tabular-vectorized","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/python/udf-python-introduction","children":[]},{"label":"Using Third-Party Packages","type":"page","href":"/en/developer-guide/udf/python/udf-python-packages","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/python/udf-python-introduction","children":[]},{"label":"Packages Policies","type":"page","href":"/en/developer-guide/udf/python/packages-policy","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/python/udf-python-introduction","children":[]},{"label":"Examples","type":"page","href":"/en/developer-guide/udf/python/udf-python-examples","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/python/udf-python-introduction","children":[]},{"label":"Troubleshooting","type":"page","href":"/en/developer-guide/udf/python/udf-python-troubleshooting","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/python/udf-python-introduction","children":[]}]},{"label":"Scala","type":"page","href":"/en/developer-guide/udf/scala/udf-scala-introduction","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/udf-overview","children":[{"label":"Limitations","type":"page","href":"/en/developer-guide/udf/scala/udf-scala-limitations","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/scala/udf-scala-introduction","children":[]},{"label":"General Coding","type":"page","href":"/en/developer-guide/udf/scala/udf-scala-general","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/scala/udf-scala-introduction","children":[]},{"label":"Scalar Functions","type":"page","href":"/en/developer-guide/udf/scala/udf-scala-scalar","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/scala/udf-scala-introduction","children":[]},{"label":"Optimizing","type":"page","href":"/en/developer-guide/udf/scala/udf-scala-optimizing","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/scala/udf-scala-introduction","children":[]},{"label":"Project and Packaging","type":"page","href":"/en/developer-guide/udf/scala/udf-scala-packaging","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/scala/udf-scala-introduction","children":[]},{"label":"Examples","type":"page","href":"/en/developer-guide/udf/scala/udf-scala-examples","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/scala/udf-scala-introduction","children":[]},{"label":"Troubleshooting","type":"page","href":"/en/developer-guide/udf/scala/udf-scala-troubleshooting","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/scala/udf-scala-introduction","children":[]}]},{"label":"SQL","type":"page","href":"/en/developer-guide/udf/sql/udf-sql-introduction","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/udf-overview","children":[{"label":"Limitations","type":"page","href":"/en/developer-guide/udf/sql/udf-sql-limitations","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/sql/udf-sql-introduction","children":[]},{"label":"Scalar Functions","type":"page","href":"/en/developer-guide/udf/sql/udf-sql-scalar-functions","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/sql/udf-sql-introduction","children":[]},{"label":"Table Functions","type":"page","href":"/en/developer-guide/udf/sql/udf-sql-tabular-functions","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/sql/udf-sql-introduction","children":[]},{"label":"Troubleshooting","type":"page","href":"/en/developer-guide/udf/sql/udf-sql-troubleshooting","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf/sql/udf-sql-introduction","children":[]}]}]},{"label":"Logging and Tracing","type":"page","href":"/en/developer-guide/logging-tracing/logging-tracing-overview","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/extensibility","children":[{"label":"Get Started Tutorial","type":"page","href":"/en/developer-guide/logging-tracing/tutorials/logging-tracing-getting-started","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]},{"label":"Event Table Set Up","type":"page","href":"/en/developer-guide/logging-tracing/event-table-setting-up","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]},{"label":"Event Table Operations","type":"page","href":"/en/developer-guide/logging-tracing/event-table-operations","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]},{"label":"Event Table Columns","type":"page","href":"/en/developer-guide/logging-tracing/event-table-columns","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]},{"label":"Unhandled Exception Messages","type":"page","href":"/en/developer-guide/logging-tracing/unhandled-exception-messages","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]},{"label":"Telemetry Package Dependencies","type":"page","href":"/en/developer-guide/logging-tracing/telemetry-package-dependencies","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]},{"label":"Packaging","type":"page","href":"/en/developer-guide/logging-tracing/telemetry-build-maven","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]},{"label":"Limitations","type":"page","href":"/en/developer-guide/logging-tracing/logging-tracing-limitations","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]},{"label":"Troubleshooting","type":"page","href":"/en/developer-guide/logging-tracing/logging-tracing-troubleshooting","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]},{"label":"Costs","type":"page","href":"/en/developer-guide/logging-tracing/logging-tracing-billing","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]},{"type":"category","depth":2,"label":"Logging"},{"label":"Introduction","type":"page","href":"/en/developer-guide/logging-tracing/logging","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]},{"label":"Log Level","type":"page","href":"/en/developer-guide/logging-tracing/logging-log-level","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]},{"label":"Java","type":"page","href":"/en/developer-guide/logging-tracing/logging-java","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]},{"label":"JavaScript","type":"page","href":"/en/developer-guide/logging-tracing/logging-javascript","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]},{"label":"Python","type":"page","href":"/en/developer-guide/logging-tracing/logging-python","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]},{"label":"Scala","type":"page","href":"/en/developer-guide/logging-tracing/logging-scala","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]},{"label":"Snowflake Scripting","type":"page","href":"/en/developer-guide/logging-tracing/logging-snowflake-scripting","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]},{"label":"Accessing Message Data","type":"page","href":"/en/developer-guide/logging-tracing/logging-accessing-messages","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]},{"type":"category","depth":2,"label":"Tracing"},{"label":"Introduction","type":"page","href":"/en/developer-guide/logging-tracing/tracing","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]},{"label":"Trace Events","type":"page","href":"/en/developer-guide/logging-tracing/tracing-how-events-work","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]},{"label":"Trace Level","type":"page","href":"/en/developer-guide/logging-tracing/tracing-trace-level","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]},{"label":"Java","type":"page","href":"/en/developer-guide/logging-tracing/tracing-java","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]},{"label":"JavaScript","type":"page","href":"/en/developer-guide/logging-tracing/tracing-javascript","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]},{"label":"Python","type":"page","href":"/en/developer-guide/logging-tracing/tracing-python","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]},{"label":"Scala","type":"page","href":"/en/developer-guide/logging-tracing/tracing-scala","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]},{"label":"Snowflake Scripting","type":"page","href":"/en/developer-guide/logging-tracing/tracing-snowflake-scripting","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]},{"label":"Accessing Trace Data","type":"page","href":"/en/developer-guide/logging-tracing/tracing-accessing-events","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/logging-tracing/logging-tracing-overview","children":[]}]},{"label":"External Network Access","type":"page","href":"/en/developer-guide/external-network-access/external-network-access-overview","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/extensibility","children":[{"label":"Creating and Using Access","type":"page","href":"/en/developer-guide/external-network-access/creating-using-external-network-access","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/external-network-access/external-network-access-overview","children":[]},{"label":"Best Practices","type":"page","href":"/en/developer-guide/external-network-access/external-network-access-best-practices","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/external-network-access/external-network-access-overview","children":[]},{"label":"Examples","type":"page","href":"/en/developer-guide/external-network-access/external-network-access-examples","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/external-network-access/external-network-access-overview","children":[]},{"label":"Secret API Reference","type":"page","href":"/en/developer-guide/external-network-access/secret-api-reference","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/external-network-access/external-network-access-overview","children":[]},{"label":"Limitations","type":"page","href":"/en/developer-guide/external-network-access/external-network-access-limitations","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/external-network-access/external-network-access-overview","children":[]},{"label":"Troubleshooting","type":"page","href":"/en/developer-guide/external-network-access/external-network-access-troubleshooting","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/external-network-access/external-network-access-overview","children":[]},{"label":"Costs","type":"page","href":"/en/developer-guide/external-network-access/external-network-access-billing","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/external-network-access/external-network-access-overview","children":[]}]},{"label":"Packaging Handler Code","type":"page","href":"/en/developer-guide/udf-stored-procedure-building","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/extensibility","children":[{"label":"sbt","type":"page","href":"/en/developer-guide/udf-stored-procedure-build-sbt","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf-stored-procedure-building","children":[]},{"label":"Maven","type":"page","href":"/en/developer-guide/udf-stored-procedure-build-maven","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/udf-stored-procedure-building","children":[]}]}]},{"type":"category","depth":0,"label":"Snowflake APIs"},{"label":"Snowflake Python API","type":"page","href":"/en/developer-guide/snowflake-python-api/snowflake-python-overview","active":false,"depth":0,"isInitiallyOpen":false,"parentRef":"/en/developer","children":[{"label":"Installing","type":"page","href":"/en/developer-guide/snowflake-python-api/snowflake-python-installing","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-python-api/snowflake-python-overview","children":[]},{"label":"Connecting to Snowflake","type":"page","href":"/en/developer-guide/snowflake-python-api/snowflake-python-connecting-snowflake","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-python-api/snowflake-python-overview","children":[]},{"label":"Managing Tasks and Task Graphs","type":"page","href":"/en/developer-guide/snowflake-python-api/snowflake-python-managing-tasks","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-python-api/snowflake-python-overview","children":[]},{"label":"Managing Databases, Schemas, and Tables","type":"page","href":"/en/developer-guide/snowflake-python-api/snowflake-python-managing-databases","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-python-api/snowflake-python-overview","children":[]},{"label":"Managing Virtual Warehouses","type":"page","href":"/en/developer-guide/snowflake-python-api/snowflake-python-managing-warehouses","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-python-api/snowflake-python-overview","children":[]},{"label":"Managing Snowpark Container Services","type":"page","href":"/en/developer-guide/snowflake-python-api/snowflake-python-managing-containers","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-python-api/snowflake-python-overview","children":[]},{"label":"Snowflake Python API Reference","type":"page","href":"/en/developer-guide/snowflake-python-api/reference/latest/index","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-python-api/snowflake-python-overview","hideBreadcrumb":true,"children":[]}]},{"label":"SQL REST API","type":"page","href":"/en/developer-guide/sql-api/index","active":false,"depth":0,"isInitiallyOpen":false,"parentRef":"/en/developer","children":[{"label":"Introduction","type":"page","href":"/en/developer-guide/sql-api/intro","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/sql-api/index","children":[]},{"label":"Endpoints","type":"page","href":"/en/developer-guide/sql-api/about-endpoints","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/sql-api/index","children":[]},{"label":"Authentication","type":"page","href":"/en/developer-guide/sql-api/authenticating","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/sql-api/index","children":[]},{"label":"Submitting requests","type":"page","href":"/en/developer-guide/sql-api/submitting-requests","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/sql-api/index","children":[]},{"label":"Handling responses","type":"page","href":"/en/developer-guide/sql-api/handling-responses","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/sql-api/index","children":[]},{"label":"Multiple statements","type":"page","href":"/en/developer-guide/sql-api/submitting-multiple-statements","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/sql-api/index","children":[]},{"label":"Stored procedures","type":"page","href":"/en/developer-guide/sql-api/using-stored-procedures","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/sql-api/index","children":[]},{"label":"Transactions","type":"page","href":"/en/developer-guide/sql-api/using-transactions","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/sql-api/index","children":[]},{"label":"Handling errors","type":"page","href":"/en/developer-guide/sql-api/handling-errors","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/sql-api/index","children":[]},{"label":"Query canceling","type":"page","href":"/en/developer-guide/sql-api/cancelling-requests","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/sql-api/index","children":[]},{"label":"SQL API reference","type":"page","href":"/en/developer-guide/sql-api/reference","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/sql-api/index","children":[]},{"label":"Deprecated functionality","type":"page","href":"/en/developer-guide/sql-api/sql-api-old","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/sql-api/index","children":[]}]},{"type":"category","depth":0,"label":"Apps"},{"label":"Streamlit in Snowflake","type":"page","href":"/en/developer-guide/streamlit/about-streamlit","active":false,"depth":0,"isInitiallyOpen":false,"parentRef":"/en/developer","children":[{"label":"Limitations and Unsupported Features","type":"page","href":"/en/developer-guide/streamlit/limitations","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/streamlit/about-streamlit","children":[]},{"label":"Create a Streamlit App by Using SQL","type":"page","href":"/en/developer-guide/streamlit/create-streamlit-sql","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/streamlit/about-streamlit","children":[]},{"label":"Create a Streamlit App by Using Snowsight","type":"page","href":"/en/developer-guide/streamlit/create-streamlit-ui","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/streamlit/about-streamlit","children":[]},{"label":"Understanding Owner's Rights","type":"page","href":"/en/developer-guide/streamlit/owners-rights","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/streamlit/about-streamlit","children":[]},{"label":"Example - Accessing Snowflake Data","type":"page","href":"/en/developer-guide/streamlit/example-access-snowflake","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/streamlit/about-streamlit","children":[]},{"label":"Example - Single-page Streamlit App","type":"page","href":"/en/developer-guide/streamlit/example-single-page","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/streamlit/about-streamlit","children":[]},{"label":"Example - Multi-page Streamlit App","type":"page","href":"/en/developer-guide/streamlit/example-multi-page","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/streamlit/about-streamlit","children":[]}]},{"label":"Snowflake Native App Framework","type":"page","href":"/en/developer-guide/native-apps/native-apps-about","active":false,"depth":0,"isInitiallyOpen":false,"parentRef":"/en/developer","children":[{"label":"Tutorial: Develop an app","type":"page","href":"/en/developer-guide/native-apps/tutorials/getting-started-tutorial","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/native-apps/native-apps-about","children":[]},{"label":"Snowflake Native App workflow","type":"page","href":"/en/developer-guide/native-apps/native-apps-workflow","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/native-apps/native-apps-about","children":[]},{"label":"Protect provider intellectual property","type":"page","href":"/en/developer-guide/native-apps/redacted-content","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/native-apps/native-apps-about","children":[]},{"type":"category","depth":1,"label":"Develop an application package"},{"label":"Create a setup script","type":"page","href":"/en/developer-guide/native-apps/creating-setup-script","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/native-apps/native-apps-about","children":[]},{"label":"Create a manifest file","type":"page","href":"/en/developer-guide/native-apps/creating-manifest","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/native-apps/native-apps-about","children":[]},{"label":"Create an application package","type":"page","href":"/en/developer-guide/native-apps/creating-app-package","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/native-apps/native-apps-about","children":[]},{"label":"Add application logic","type":"page","href":"/en/developer-guide/native-apps/adding-application-logic","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/native-apps/native-apps-about","children":[]},{"label":"Update an app","type":"page","href":"/en/developer-guide/native-apps/versioning","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/native-apps/native-apps-about","children":[]},{"label":"Share data content","type":"page","href":"/en/developer-guide/native-apps/preparing-data-content","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/native-apps/native-apps-about","children":[]},{"label":"Add frontend experience with Streamlit","type":"page","href":"/en/developer-guide/native-apps/adding-streamlit","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/native-apps/native-apps-about","children":[]},{"label":"Set up logging and event sharing","type":"page","href":"/en/developer-guide/native-apps/setting-up-logging-and-events","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/native-apps/native-apps-about","children":[]},{"label":"Add billable events to an app","type":"page","href":"/en/developer-guide/native-apps/adding-custom-event-billing","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/native-apps/native-apps-about","children":[]},{"label":"Request access to a consumer account","type":"page","href":"/en/developer-guide/native-apps/requesting-about","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/native-apps/native-apps-about","children":[{"label":"Request global privileges","type":"page","href":"/en/developer-guide/native-apps/requesting-privs","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/native-apps/requesting-about","children":[]},{"label":"Request references and object-level privileges","type":"page","href":"/en/developer-guide/native-apps/requesting-refs","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/native-apps/requesting-about","children":[]},{"label":"Create a user interface to request privileges and references","type":"page","href":"/en/developer-guide/native-apps/requesting-ui","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/native-apps/requesting-about","children":[]}]},{"type":"category","depth":1,"label":"Install and test"},{"label":"Install and test an app","type":"page","href":"/en/developer-guide/native-apps/installing-testing-application","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/native-apps/native-apps-about","children":[]},{"label":"Run the automated security scan","type":"page","href":"/en/developer-guide/native-apps/running-security-scan","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/native-apps/native-apps-about","children":[]},{"type":"category","depth":1,"label":"Publish an app"},{"label":"Guidelines for Submitting an App","type":"page","href":"/en/developer-guide/native-apps/publish-guidelines","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/native-apps/native-apps-about","children":[]},{"label":"Share an app with consumers","type":"page","href":"https://other-docs.snowflake.com/en/native-apps/provider-publishing-app-package","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/native-apps/native-apps-about","children":[]},{"type":"category","depth":1,"label":"Use an app as a consumer"},{"label":"Work with an app as a consumer","type":"page","href":"https://other-docs.snowflake.com/en/native-apps/consumer-about","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/native-apps/native-apps-about","children":[]},{"label":"Install an app","type":"page","href":"https://other-docs.snowflake.com/en/native-apps/consumer-installing","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/native-apps/native-apps-about","children":[]},{"label":"Grant access to an app","type":"page","href":"https://other-docs.snowflake.com/en/native-apps/consumer-granting-privs","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/native-apps/native-apps-about","children":[]},{"label":"Enable logging and event sharing","type":"page","href":"https://other-docs.snowflake.com/en/native-apps/consumer-enable-logging","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/native-apps/native-apps-about","children":[]},{"label":"Manage apps","type":"page","href":"https://other-docs.snowflake.com/en/native-apps/consumer-managing-applications","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/native-apps/native-apps-about","children":[]},{"type":"category","depth":1,"label":"Snowflake Native SDK for Connectors"},{"label":"About the Snowflake Native SDK for Connectors","type":"page","href":"/en/developer-guide/native-apps/connector-sdk/about-connector-sdk","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/native-apps/native-apps-about","children":[]}]},{"type":"category","depth":0,"label":"External System Integration"},{"label":"External Functions","type":"page","href":"/en/sql-reference/external-functions","active":false,"depth":0,"isInitiallyOpen":false,"parentRef":"/en/developer","children":[{"label":"Introduction to External Functions","type":"page","href":"/en/sql-reference/external-functions-introduction","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions","children":[]},{"label":"Data Formats","type":"page","href":"/en/sql-reference/external-functions-data-format","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions","children":[]},{"label":"Request and Response Translators","type":"page","href":"/en/sql-reference/external-functions-translators","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions","children":[]},{"label":"Performance","type":"page","href":"/en/sql-reference/external-functions-implementation","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions","children":[]},{"label":"Best Practices","type":"page","href":"/en/sql-reference/external-functions-best-practices","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions","children":[]},{"label":"AWS","type":"page","href":"/en/sql-reference/external-functions-creating-aws","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions","children":[{"label":"Planning","type":"page","href":"/en/sql-reference/external-functions-creating-aws-planning","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-aws","children":[]},{"label":"Creating Using AWS Management Console","type":"page","href":"/en/sql-reference/external-functions-creating-aws-ui","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-aws","children":[{"label":"Step 1: Create the Remote Service","type":"page","href":"/en/sql-reference/external-functions-creating-aws-ui-remote-service","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-aws-ui","children":[]},{"label":"Step 2: Create the Proxy Service","type":"page","href":"/en/sql-reference/external-functions-creating-aws-ui-proxy-service","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-aws-ui","children":[]},{"label":"Step 3: Create the API Integration","type":"page","href":"/en/sql-reference/external-functions-creating-aws-common-api-integration","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-aws-ui","children":[]},{"label":"Step 4: Link the API Integration","type":"page","href":"/en/sql-reference/external-functions-creating-aws-common-api-integration-proxy-link","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-aws-ui","children":[]},{"label":"Step 5: Create the External Function","type":"page","href":"/en/sql-reference/external-functions-creating-aws-common-ext-function","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-aws-ui","children":[]}]},{"label":"Creating Using AWS CloudFormation Template","type":"page","href":"/en/sql-reference/external-functions-creating-aws-template","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-aws","children":[{"label":"Step 1: Create the Remote Service","type":"page","href":"/en/sql-reference/external-functions-creating-aws-template-services","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-aws-template","children":[]},{"label":"Step 2: Get Gateway URL and Role ARN","type":"page","href":"/en/sql-reference/external-functions-creating-aws-template-gateway-url","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-aws-template","children":[]},{"label":"Step 3: Create the API Integration","type":"page","href":"/en/sql-reference/external-functions-creating-aws-common-api-integration","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-aws-template","children":[]},{"label":"Step 4: Link the API Integration","type":"page","href":"/en/sql-reference/external-functions-creating-aws-common-api-integration-proxy-link","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-aws-template","children":[]},{"label":"Step 5: Create the External Function","type":"page","href":"/en/sql-reference/external-functions-creating-aws-common-ext-function","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-aws-template","children":[]}]},{"label":"Calling","type":"page","href":"/en/sql-reference/external-functions-creating-aws-call","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-aws","children":[]},{"label":"Troubleshooting","type":"page","href":"/en/sql-reference/external-functions-creating-aws-troubleshooting","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-aws","children":[]}]},{"label":"Google Cloud","type":"page","href":"/en/sql-reference/external-functions-creating-gcp","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions","children":[{"label":"Planning","type":"page","href":"/en/sql-reference/external-functions-creating-gcp-planning","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-gcp","children":[]},{"label":"Creating using Google Cloud Console","type":"page","href":"/en/sql-reference/external-functions-creating-gcp-ui","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-gcp","children":[{"label":"Step 1: Create the Remote Service","type":"page","href":"/en/sql-reference/external-functions-creating-gcp-ui-remote-service","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-gcp-ui","children":[]},{"label":"Step 2: Create the Proxy Service","type":"page","href":"/en/sql-reference/external-functions-creating-gcp-ui-proxy-service","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-gcp-ui","children":[]},{"label":"Step 3: Create the API Integration","type":"page","href":"/en/sql-reference/external-functions-creating-gcp-common-api-integration","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-gcp-ui","children":[]},{"label":"Step 4: Create the External Function","type":"page","href":"/en/sql-reference/external-functions-creating-gcp-common-ext-function","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-gcp-ui","children":[]},{"label":"Step 5: Create the Security Policy","type":"page","href":"/en/sql-reference/external-functions-creating-gcp-ui-security-policy","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-gcp-ui","children":[]}]},{"label":"Calling","type":"page","href":"/en/sql-reference/external-functions-creating-gcp-call","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-gcp","children":[]},{"label":"Troubleshooting","type":"page","href":"/en/sql-reference/external-functions-creating-gcp-troubleshooting","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-gcp","children":[]}]},{"label":"Azure","type":"page","href":"/en/sql-reference/external-functions-creating-azure","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions","children":[{"label":"Planning","type":"page","href":"/en/sql-reference/external-functions-creating-azure-planning","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-azure","children":[]},{"label":"Creating using Azure Portal","type":"page","href":"/en/sql-reference/external-functions-creating-azure-ui","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-azure","children":[{"label":"Step 1: Create the Remote Service","type":"page","href":"/en/sql-reference/external-functions-creating-azure-ui-remote-service","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-azure-ui","children":[]},{"label":"Step 2: Create the Proxy Service","type":"page","href":"/en/sql-reference/external-functions-creating-azure-ui-proxy-service","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-azure-ui","children":[]},{"label":"Step 3: Create the API Integration","type":"page","href":"/en/sql-reference/external-functions-creating-azure-common-api-integration","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-azure-ui","children":[]},{"label":"Step 4: Link the API Integration","type":"page","href":"/en/sql-reference/external-functions-creating-azure-common-api-integration-proxy-link","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-azure-ui","children":[]},{"label":"Step 5: Create the External Function","type":"page","href":"/en/sql-reference/external-functions-creating-azure-common-ext-function","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-azure-ui","children":[]},{"label":"Step 6: Create the Security Policy","type":"page","href":"/en/sql-reference/external-functions-creating-azure-ui-security-policy","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-azure-ui","children":[]}]},{"label":"Creating using ARM Template","type":"page","href":"/en/sql-reference/external-functions-creating-azure-template","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-azure","children":[{"label":"Step 1: Create the Azure Application","type":"page","href":"/en/sql-reference/external-functions-creating-azure-template-apps","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-azure-template","children":[]},{"label":"Step 2: Create the Remote Service","type":"page","href":"/en/sql-reference/external-functions-creating-azure-template-services","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-azure-template","children":[]},{"label":"Step 3: Create the API Integration","type":"page","href":"/en/sql-reference/external-functions-creating-azure-common-api-integration","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-azure-template","children":[]},{"label":"Step 4: Link the API Integration","type":"page","href":"/en/sql-reference/external-functions-creating-azure-common-api-integration-proxy-link","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-azure-template","children":[]},{"label":"Step 5: Create the External Function","type":"page","href":"/en/sql-reference/external-functions-creating-azure-common-ext-function","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-azure-template","children":[]},{"label":"Step 6: Update the Security Policy","type":"page","href":"/en/sql-reference/external-functions-creating-azure-template-security-policy","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-azure-template","children":[]}]},{"label":"Calling","type":"page","href":"/en/sql-reference/external-functions-creating-azure-call","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-azure","children":[]},{"label":"Troubleshooting","type":"page","href":"/en/sql-reference/external-functions-creating-azure-troubleshooting","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions-creating-azure","children":[]}]},{"label":"Security","type":"page","href":"/en/sql-reference/external-functions-security","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/sql-reference/external-functions","children":[]}]},{"label":"Kafka and Spark Connectors","type":"page","href":"/en/user-guide/connectors","active":false,"depth":0,"isInitiallyOpen":true,"parentRef":"/en/developer","children":[{"label":"Kafka Connector","type":"page","href":"/en/user-guide/kafka-connector","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/user-guide/connectors","children":[{"label":"Overview","type":"page","href":"/en/user-guide/kafka-connector-overview","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/user-guide/kafka-connector","children":[]},{"label":"Install","type":"page","href":"/en/user-guide/kafka-connector-install","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/user-guide/kafka-connector","children":[]},{"label":"Manage","type":"page","href":"/en/user-guide/kafka-connector-manage","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/user-guide/kafka-connector","children":[]},{"label":"Monitor","type":"page","href":"/en/user-guide/kafka-connector-monitor","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/user-guide/kafka-connector","children":[]},{"label":"Protobuf","type":"page","href":"/en/user-guide/kafka-connector-protobuf","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/user-guide/kafka-connector","children":[]},{"label":"Troubleshooting","type":"page","href":"/en/user-guide/kafka-connector-ts","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/user-guide/kafka-connector","children":[]}]},{"label":"Spark Connector","type":"page","href":"/en/user-guide/spark-connector","active":false,"depth":1,"isInitiallyOpen":true,"parentRef":"/en/user-guide/connectors","children":[{"label":"Overview","type":"page","href":"/en/user-guide/spark-connector-overview","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/user-guide/spark-connector","children":[]},{"label":"Install","type":"page","href":"/en/user-guide/spark-connector-install","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/user-guide/spark-connector","children":[]},{"label":"Configure","type":"page","href":"/en/user-guide/spark-connector-databricks","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/user-guide/spark-connector","children":[]},{"label":"Qubole","type":"page","href":"/en/user-guide/spark-connector-qubole","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/user-guide/spark-connector","children":[]},{"label":"Usage","type":"page","href":"/en/user-guide/spark-connector-use","active":true,"depth":2,"isInitiallyOpen":true,"parentRef":"/en/user-guide/spark-connector","children":[]}]}]},{"type":"category","depth":0,"label":"Snowflake Scripting"},{"label":"Snowflake Scripting Developer Guide","type":"page","href":"/en/developer-guide/snowflake-scripting/index","active":false,"depth":0,"isInitiallyOpen":false,"parentRef":"/en/developer","children":[{"label":"Blocks","type":"page","href":"/en/developer-guide/snowflake-scripting/blocks","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-scripting/index","children":[]},{"label":"Variables","type":"page","href":"/en/developer-guide/snowflake-scripting/variables","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-scripting/index","children":[]},{"label":"Returning a value","type":"page","href":"/en/developer-guide/snowflake-scripting/return","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-scripting/index","children":[]},{"label":"Conditional logic","type":"page","href":"/en/developer-guide/snowflake-scripting/branch","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-scripting/index","children":[]},{"label":"Loops","type":"page","href":"/en/developer-guide/snowflake-scripting/loops","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-scripting/index","children":[]},{"label":"Cursors","type":"page","href":"/en/developer-guide/snowflake-scripting/cursors","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-scripting/index","children":[]},{"label":"RESULTSETs","type":"page","href":"/en/developer-guide/snowflake-scripting/resultsets","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-scripting/index","children":[]},{"label":"Exceptions","type":"page","href":"/en/developer-guide/snowflake-scripting/exceptions","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-scripting/index","children":[]},{"label":"Affected rows","type":"page","href":"/en/developer-guide/snowflake-scripting/dml-status","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-scripting/index","children":[]},{"label":"Getting a query ID","type":"page","href":"/en/developer-guide/snowflake-scripting/query-id","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-scripting/index","children":[]},{"label":"Examples for common use cases","type":"page","href":"/en/developer-guide/snowflake-scripting/use-cases","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-scripting/index","children":[]},{"label":"Using Snowflake Scripting in SnowSQL or the Classic Console","type":"page","href":"/en/developer-guide/snowflake-scripting/running-examples","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-scripting/index","children":[]}]},{"type":"category","depth":0,"label":"Tools"},{"label":"Snowflake CLI","type":"page","href":"/en/developer-guide/snowflake-cli-v2/index","active":false,"depth":0,"isInitiallyOpen":false,"parentRef":"/en/developer","children":[{"label":"Introduction","type":"page","href":"/en/developer-guide/snowflake-cli-v2/introduction/introduction","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/index","children":[]},{"label":"Installing Snowflake CLI","type":"page","href":"/en/developer-guide/snowflake-cli-v2/installation/installation","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/index","children":[]},{"label":"Connecting to Snowflake","type":"page","href":"/en/developer-guide/snowflake-cli-v2/connecting/connect","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/index","children":[{"label":"Specify Snowflake credentials","type":"page","href":"/en/developer-guide/snowflake-cli-v2/connecting/specify-credentials","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/connecting/connect","children":[]},{"label":"Manage connections","type":"page","href":"/en/developer-guide/snowflake-cli-v2/connecting/manage-connections","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/connecting/connect","children":[]},{"label":"Configure logging","type":"page","href":"/en/developer-guide/snowflake-cli-v2/connecting/configure-logging","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/connecting/connect","children":[]}]},{"label":"Project definition files","type":"page","href":"/en/developer-guide/snowflake-cli-v2/project-definitions/about","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/index","children":[]},{"label":"Working with Snowflake objects","type":"page","href":"/en/developer-guide/snowflake-cli-v2/objects/overview","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/index","children":[{"label":"Manage Snowflake objects","type":"page","href":"/en/developer-guide/snowflake-cli-v2/objects/manage-objects","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/objects/overview","children":[]},{"label":"Manage Snowflake stages","type":"page","href":"/en/developer-guide/snowflake-cli-v2/objects/manage-stages","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/objects/overview","children":[]}]},{"label":"Managing Container Services","type":"page","href":"/en/developer-guide/snowflake-cli-v2/services/overview","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/index","children":[{"label":"Work with image registries and repositories","type":"page","href":"/en/developer-guide/snowflake-cli-v2/services/manage-images","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/services/overview","children":[]},{"label":"Manage compute pools","type":"page","href":"/en/developer-guide/snowflake-cli-v2/services/manage-compute-pools","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/services/overview","children":[]},{"label":"Manage services","type":"page","href":"/en/developer-guide/snowflake-cli-v2/services/manage-services","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/services/overview","children":[]}]},{"label":"Using Snowpark APIs","type":"page","href":"/en/developer-guide/snowflake-cli-v2/snowpark/overview","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/index","children":[{"label":"Initialize a project","type":"page","href":"/en/developer-guide/snowflake-cli-v2/snowpark/initialize","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/snowpark/overview","children":[]},{"label":"Create a project definition","type":"page","href":"/en/developer-guide/snowflake-cli-v2/snowpark/create","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/snowpark/overview","children":[]},{"label":"Build artificats","type":"page","href":"/en/developer-guide/snowflake-cli-v2/snowpark/build","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/snowpark/overview","children":[]},{"label":"Deploy Snowflake objects","type":"page","href":"/en/developer-guide/snowflake-cli-v2/snowpark/deploy","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/snowpark/overview","children":[]},{"label":"Execute functions and procedures","type":"page","href":"/en/developer-guide/snowflake-cli-v2/snowpark/execute","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/snowpark/overview","children":[]},{"label":"Reuse Snowpark packages","type":"page","href":"/en/developer-guide/snowflake-cli-v2/snowpark/reuse","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/snowpark/overview","children":[]},{"label":"Manage functions and procedures","type":"page","href":"/en/developer-guide/snowflake-cli-v2/snowpark/manage","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/snowpark/overview","children":[]}]},{"label":"Working with Streamlit in Snowflake","type":"page","href":"/en/developer-guide/snowflake-cli-v2/streamlit-apps/overview","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/index","children":[{"label":"Create a Streamlit app locally","type":"page","href":"/en/developer-guide/snowflake-cli-v2/streamlit-apps/manage-apps/initialize-app","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/streamlit-apps/overview","children":[]},{"label":"Deploy a Streamlit app","type":"page","href":"/en/developer-guide/snowflake-cli-v2/streamlit-apps/manage-apps/deploy-app","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/streamlit-apps/overview","children":[]},{"label":"Retrieve a Streamlit app URL","type":"page","href":"/en/developer-guide/snowflake-cli-v2/streamlit-apps/manage-apps/get-url","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/streamlit-apps/overview","children":[]},{"label":"Share a Streamlit app","type":"page","href":"/en/developer-guide/snowflake-cli-v2/streamlit-apps/manage-apps/share-app","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/streamlit-apps/overview","children":[]},{"label":"Manage Streamlit apps","type":"page","href":"/en/developer-guide/snowflake-cli-v2/streamlit-apps/manage-apps/manage-app","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/streamlit-apps/overview","children":[]}]},{"label":"Using Snowflake Native Apps","type":"page","href":"/en/developer-guide/snowflake-cli-v2/native-apps/overview","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/index","children":[{"label":"About projects","type":"page","href":"/en/developer-guide/snowflake-cli-v2/native-apps/about-projects","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/native-apps/overview","children":[]},{"label":"About project definitions","type":"page","href":"/en/developer-guide/snowflake-cli-v2/native-apps/project-definitions","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/native-apps/overview","children":[]},{"label":"Create templates","type":"page","href":"/en/developer-guide/snowflake-cli-v2/native-apps/create-templates","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/native-apps/overview","children":[]},{"label":"Create and manage objects","type":"page","href":"/en/developer-guide/snowflake-cli-v2/native-apps/create-manage-apps","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/native-apps/overview","children":[{"label":"Create a project","type":"page","href":"/en/developer-guide/snowflake-cli-v2/native-apps/initiate-app","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/native-apps/create-manage-apps","children":[]},{"label":"Create and install a package","type":"page","href":"/en/developer-guide/snowflake-cli-v2/native-apps/create-package","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/native-apps/create-manage-apps","children":[]},{"label":"Create a versioned package","type":"page","href":"/en/developer-guide/snowflake-cli-v2/native-apps/create-app-package-version","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/native-apps/create-manage-apps","children":[]},{"label":"List package versions","type":"page","href":"/en/developer-guide/snowflake-cli-v2/native-apps/list-app-package-version","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/native-apps/create-manage-apps","children":[]},{"label":"Open an app","type":"page","href":"/en/developer-guide/snowflake-cli-v2/native-apps/open-app","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/native-apps/create-manage-apps","children":[]},{"label":"Drop a package version","type":"page","href":"/en/developer-guide/snowflake-cli-v2/native-apps/drop-app-package-version","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/native-apps/create-manage-apps","children":[]},{"label":"Drop an object","type":"page","href":"/en/developer-guide/snowflake-cli-v2/native-apps/drop-objects","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/native-apps/create-manage-apps","children":[]}]}]},{"label":"Executing SQL","type":"page","href":"/en/developer-guide/snowflake-cli-v2/sql/execute-sql","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/index","children":[]},{"label":"Command reference","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/overview","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/index","children":[{"label":"Connection commands","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/connection-commands/overview","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/overview","children":[{"label":"connection add","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/connection-commands/add-connection","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/connection-commands/overview","children":[]},{"label":"connection list","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/connection-commands/list-connections","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/connection-commands/overview","children":[]},{"label":"connection set-default","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/connection-commands/set-default-connection","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/connection-commands/overview","children":[]},{"label":"connection test","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/connection-commands/test-connection","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/connection-commands/overview","children":[]}]},{"label":"Snowflake Native App commands","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/native-apps-commands/overview","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/overview","children":[{"label":"app init","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/native-apps-commands/init-app","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/native-apps-commands/overview","children":[]},{"label":"app open","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/native-apps-commands/open-app","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/native-apps-commands/overview","children":[]},{"label":"app run","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/native-apps-commands/run-app","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/native-apps-commands/overview","children":[]},{"label":"app teardown","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/native-apps-commands/teardown-app","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/native-apps-commands/overview","children":[]},{"label":"app version commands","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/native-apps-commands/version/overview","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/native-apps-commands/overview","children":[{"label":"app version create","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/native-apps-commands/version/app-version-create","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/native-apps-commands/version/overview","children":[]},{"label":"app version drop","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/native-apps-commands/version/app-version-drop","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/native-apps-commands/version/overview","children":[]},{"label":"app version list","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/native-apps-commands/version/app-version-list","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/native-apps-commands/version/overview","children":[]}]}]},{"label":"Snowflake object commands","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/object-commands/overview","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/overview","children":[{"label":"object describe","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/object-commands/describe","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/object-commands/overview","children":[]},{"label":"object drop","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/object-commands/drop","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/object-commands/overview","children":[]},{"label":"object list","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/object-commands/list","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/object-commands/overview","children":[]},{"label":"object stage commands","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/object-commands/stage/overview","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/object-commands/overview","children":[{"label":"object stage copy","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/object-commands/stage/copy","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/object-commands/stage/overview","children":[]},{"label":"object stage create","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/object-commands/stage/create","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/object-commands/stage/overview","children":[]},{"label":"object stage list","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/object-commands/stage/list","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/object-commands/stage/overview","children":[]},{"label":"object stage remove","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/object-commands/stage/remove","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/object-commands/stage/overview","children":[]}]}]},{"label":"Snowpark commands","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/snowpark-commands/overview","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/overview","children":[{"label":"snowpark build","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/snowpark-commands/build","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/snowpark-commands/overview","children":[]},{"label":"snowpark deploy","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/snowpark-commands/deploy","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/snowpark-commands/overview","children":[]},{"label":"snowpark execute","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/snowpark-commands/execute","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/snowpark-commands/overview","children":[]},{"label":"snowpark init","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/snowpark-commands/init","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/snowpark-commands/overview","children":[]},{"label":"snowpark package commands","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/snowpark-commands/package-commands/overview","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/snowpark-commands/overview","children":[{"label":"snowpark package create","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/snowpark-commands/package-commands/create","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/snowpark-commands/package-commands/overview","children":[]},{"label":"snowpark package lookup","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/snowpark-commands/package-commands/lookup","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/snowpark-commands/package-commands/overview","children":[]},{"label":"snowpark package upload","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/snowpark-commands/package-commands/upload","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/snowpark-commands/package-commands/overview","children":[]}]}]},{"label":"Snowpark Container Services (spcs) commands","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/overview","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/overview","children":[{"label":"spcs compute-pool commands","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/compute-pool-commands/overview","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/overview","children":[{"label":"spcs compute-pool create","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/compute-pool-commands/create","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/compute-pool-commands/overview","children":[]},{"label":"spcs compute-pool resume","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/compute-pool-commands/resume","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/compute-pool-commands/overview","children":[]},{"label":"spcs compute-pool set","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/compute-pool-commands/set","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/compute-pool-commands/overview","children":[]},{"label":"spcs compute-pool stop-all","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/compute-pool-commands/stop-all","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/compute-pool-commands/overview","children":[]},{"label":"spcs compute-pool suspend","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/compute-pool-commands/suspend","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/compute-pool-commands/overview","children":[]},{"label":"spcs compute-pool unset","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/compute-pool-commands/unset","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/compute-pool-commands/overview","children":[]}]},{"label":"spcs image-registry commands","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/image-registry-commands/overview","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/overview","children":[{"label":"spcs image-registry login","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/image-registry-commands/login","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/image-registry-commands/overview","children":[]},{"label":"spcs image-registry token","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/image-registry-commands/token","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/image-registry-commands/overview","children":[]},{"label":"spcs image-registry url","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/image-registry-commands/url","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/image-registry-commands/overview","children":[]}]},{"label":"spcs image-repository commands","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/image-repository-commands/overview","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/overview","children":[{"label":"spcs image-repository create","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/image-repository-commands/create","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/image-repository-commands/overview","children":[]},{"label":"spcs image-repository list-tags","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/image-repository-commands/list-tags","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/image-repository-commands/overview","children":[]},{"label":"spcs image-repository list-images","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/image-repository-commands/list-images","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/image-repository-commands/overview","children":[]},{"label":"spcs image-repository url","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/image-repository-commands/url","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/image-repository-commands/overview","children":[]}]},{"label":"spcs service commands","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/service-commands/overview","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/overview","children":[{"label":"spcs service create","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/service-commands/create","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/service-commands/overview","children":[]},{"label":"spcs service list-endpoints","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/service-commands/list-endpoints","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/service-commands/overview","children":[]},{"label":"spcs service logs","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/service-commands/logs","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/service-commands/overview","children":[]},{"label":"spcs service resume","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/service-commands/resume","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/service-commands/overview","children":[]},{"label":"spcs service set","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/service-commands/set","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/service-commands/overview","children":[]},{"label":"spcs service status","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/service-commands/status","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/service-commands/overview","children":[]},{"label":"spcs service suspend","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/service-commands/suspend","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/service-commands/overview","children":[]},{"label":"spcs service unset","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/service-commands/unset","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/service-commands/overview","children":[]},{"label":"spcs service upgrade","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/service-commands/upgrade","active":false,"depth":4,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/spcs-commands/service-commands/overview","children":[]}]}]},{"label":"SQL commands","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/sql-commands/overview","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/overview","children":[{"label":"sql","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/sql-commands/sql","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/sql-commands/overview","children":[]}]},{"label":"Streamlit commands","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/streamlit-commands/overview","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/overview","children":[{"label":"streamlit deploy","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/streamlit-commands/streamlit-deploy","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/streamlit-commands/overview","children":[]},{"label":"streamlit get-url","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/streamlit-commands/streamlit-get-url","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/streamlit-commands/overview","children":[]},{"label":"streamlit init","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/streamlit-commands/streamlit-init","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/streamlit-commands/overview","children":[]},{"label":"streamlit share","type":"page","href":"/en/developer-guide/snowflake-cli-v2/command-reference/streamlit-commands/streamlit-share","active":false,"depth":3,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/snowflake-cli-v2/command-reference/streamlit-commands/overview","children":[]}]}]}]},{"label":"Git","type":"page","href":"/en/developer-guide/git/git-overview","active":false,"depth":0,"isInitiallyOpen":false,"parentRef":"/en/developer","children":[{"label":"Setting up","type":"page","href":"/en/developer-guide/git/git-setting-up","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/git/git-overview","children":[]},{"label":"Operations in Snowflake","type":"page","href":"/en/developer-guide/git/git-operations","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/git/git-overview","children":[]},{"label":"Examples","type":"page","href":"/en/developer-guide/git/git-examples","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/git/git-overview","children":[]},{"label":"Limitations","type":"page","href":"/en/developer-guide/git/git-limitations","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/git/git-overview","children":[]}]},{"type":"category","depth":0,"label":"Drivers"},{"label":"Overview","type":"page","href":"/en/developer-guide/drivers","active":false,"depth":0,"isInitiallyOpen":false,"parentRef":"/en/developer","children":[{"label":"Go","type":"page","href":"/en/developer-guide/golang/go-driver","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/drivers","children":[]},{"label":"JDBC","type":"page","href":"/en/developer-guide/jdbc/jdbc","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/drivers","children":[{"label":"Requirements","type":"page","href":"/en/developer-guide/jdbc/java-install","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/jdbc/jdbc","children":[]},{"label":"Download","type":"page","href":"/en/developer-guide/jdbc/jdbc-download","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/jdbc/jdbc","children":[]},{"label":"Configure","type":"page","href":"/en/developer-guide/jdbc/jdbc-configure","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/jdbc/jdbc","children":[]},{"label":"Using","type":"page","href":"/en/developer-guide/jdbc/jdbc-using","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/jdbc/jdbc","children":[]},{"label":"Diagnostic service","type":"page","href":"/en/developer-guide/jdbc/jdbc-diagnostic-service","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/jdbc/jdbc","children":[]},{"label":"Parameter reference","type":"page","href":"/en/developer-guide/jdbc/jdbc-parameters","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/jdbc/jdbc","children":[]},{"label":"API support","type":"page","href":"/en/developer-guide/jdbc/jdbc-api","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/jdbc/jdbc","children":[]}]},{"label":".NET","type":"page","href":"/en/developer-guide/dotnet/dotnet-driver","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/drivers","children":[]},{"label":"Node.js","type":"page","href":"/en/developer-guide/node-js/nodejs-driver","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/drivers","children":[{"label":"Install","type":"page","href":"/en/developer-guide/node-js/nodejs-driver-install","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/node-js/nodejs-driver","children":[]},{"label":"Connect","type":"page","href":"/en/developer-guide/node-js/nodejs-driver-connect","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/node-js/nodejs-driver","children":[]},{"label":"Authenticate","type":"page","href":"/en/developer-guide/node-js/nodejs-driver-authenticate","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/node-js/nodejs-driver","children":[]},{"label":"Execute SQL","type":"page","href":"/en/developer-guide/node-js/nodejs-driver-execute","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/node-js/nodejs-driver","children":[]},{"label":"Consume results","type":"page","href":"/en/developer-guide/node-js/nodejs-driver-consume","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/node-js/nodejs-driver","children":[]},{"label":"Configure logging","type":"page","href":"/en/developer-guide/node-js/nodejs-driver-logs","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/node-js/nodejs-driver","children":[]},{"label":"Options reference","type":"page","href":"/en/developer-guide/node-js/nodejs-driver-options","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/node-js/nodejs-driver","children":[]}]},{"label":"ODBC","type":"page","href":"/en/developer-guide/odbc/odbc","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/drivers","children":[{"label":"Download","type":"page","href":"/en/developer-guide/odbc/odbc-download","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/odbc/odbc","children":[]},{"label":"Installing for Windows","type":"page","href":"/en/developer-guide/odbc/odbc-windows","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/odbc/odbc","children":[]},{"label":"Installing for Mac","type":"page","href":"/en/developer-guide/odbc/odbc-mac","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/odbc/odbc","children":[]},{"label":"Installing for Linux","type":"page","href":"/en/developer-guide/odbc/odbc-linux","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/odbc/odbc","children":[]},{"label":"Configuration","type":"page","href":"/en/developer-guide/odbc/odbc-parameters","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/odbc/odbc","children":[]},{"label":"API support","type":"page","href":"/en/developer-guide/odbc/odbc-api","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/odbc/odbc","children":[]},{"label":"Using","type":"page","href":"/en/developer-guide/odbc/odbc-using","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/odbc/odbc","children":[]},{"label":"Diagnostic service","type":"page","href":"/en/developer-guide/odbc/odbc-diagnostic-service","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/odbc/odbc","children":[]}]},{"label":"PHP","type":"page","href":"/en/developer-guide/php-pdo/php-pdo-driver","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/drivers","children":[]},{"label":"Python","type":"page","href":"/en/developer-guide/python-connector/python-connector","active":false,"depth":1,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/drivers","children":[{"label":"Installing","type":"page","href":"/en/developer-guide/python-connector/python-connector-install","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/python-connector/python-connector","children":[]},{"label":"Connecting","type":"page","href":"/en/developer-guide/python-connector/python-connector-connect","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/python-connector/python-connector","children":[]},{"label":"Using","type":"page","href":"/en/developer-guide/python-connector/python-connector-example","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/python-connector/python-connector","children":[]},{"label":"pandas DataFrames","type":"page","href":"/en/developer-guide/python-connector/python-connector-pandas","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/python-connector/python-connector","children":[]},{"label":"Distributing workloads","type":"page","href":"/en/developer-guide/python-connector/python-connector-distributed-fetch","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/python-connector/python-connector","children":[]},{"label":"Usage with SQLAlchemy","type":"page","href":"/en/developer-guide/python-connector/sqlalchemy","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/python-connector/python-connector","children":[]},{"label":"API","type":"page","href":"/en/developer-guide/python-connector/python-connector-api","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/python-connector/python-connector","children":[]},{"label":"Dependency management policy","type":"page","href":"/en/developer-guide/python-connector/python-connector-dependencies","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/developer-guide/python-connector/python-connector","children":[]}]}]},{"type":"category","depth":0,"label":"Reference"},{"label":"API Reference","type":"alias","href":"/en/api-reference","active":false,"depth":0,"isInitiallyOpen":false,"parentRef":"/en/developer","children":[]}]},"categories":[],"activeNodeParent":{"label":"Spark Connector","type":"page","href":"/en/user-guide/spark-connector","active":false,"depth":1,"isInitiallyOpen":true,"parentRef":"/en/user-guide/connectors","children":[{"label":"Overview","type":"page","href":"/en/user-guide/spark-connector-overview","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/user-guide/spark-connector","children":[]},{"label":"Install","type":"page","href":"/en/user-guide/spark-connector-install","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/user-guide/spark-connector","children":[]},{"label":"Configure","type":"page","href":"/en/user-guide/spark-connector-databricks","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/user-guide/spark-connector","children":[]},{"label":"Qubole","type":"page","href":"/en/user-guide/spark-connector-qubole","active":false,"depth":2,"isInitiallyOpen":false,"parentRef":"/en/user-guide/spark-connector","children":[]},{"label":"Usage","type":"page","href":"/en/user-guide/spark-connector-use","active":true,"depth":2,"isInitiallyOpen":true,"parentRef":"/en/user-guide/spark-connector","children":[]}]},"snowsightDomain":"https://app.snowflake.com","_nextI18Next":{"initialI18nStore":{"en":{"common":{}}},"initialLocale":"en","ns":["common"],"userConfig":{"i18n":{"defaultLocale":"en","locales":["en","fr","de","ja","ko","pt"]},"default":{"i18n":{"defaultLocale":"en","locales":["en","fr","de","ja","ko","pt"]}}}}},"__N_SSP":true},"page":"/[...path]","query":{"path":["user-guide","spark-connector-use"]},"buildId":"ICZ5MtOK9ZoGg60IkLaJy","isFallback":false,"dynamicIds":[4304],"gssp":true,"customServer":true,"locale":"en","locales":["en","fr","de","ja","ko","pt"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>